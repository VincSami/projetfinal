(window["webpackJsonp@livechat/chat-widget"]=window["webpackJsonp@livechat/chat-widget"]||[]).push([[0],{1:function(e,t,n){"use strict";function r(e,t){return e+t}var a={}.hasOwnProperty;function i(e,t){return a.call(t,e)}function o(){return(o=Object.assign||function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.forEach((function(t){for(var n in t)i(n,t)&&(e[n]=t[n])})),e}).apply(void 0,arguments)}function c(e,t){var n;return(n=[]).concat.apply(n,t.map(e))}var s=Array.isArray;function u(e){return"object"===typeof e&&null!==e&&!s(e)}function l(e,t){return Object.keys(t).reduce((function(n,r){return n[r]=e(t[r]),n}),{})}function d(e){return s(e)?e.map(d):u(e)?l(d,e):e}var p=function(e){for(var t=e,n=!1,r=!1,a=!1,i=0;i<t.length;i++){var o=t[i];n&&/[a-zA-Z]/.test(o)&&o.toUpperCase()===o?(t=t.slice(0,i)+"-"+t.slice(i),n=!1,a=r,r=!0,i++):r&&a&&/[a-zA-Z]/.test(o)&&o.toLowerCase()===o?(t=t.slice(0,i-1)+"-"+t.slice(i-1),a=r,r=!1,n=!0):(n=o.toLowerCase()===o,a=r,r=o.toUpperCase()===o)}return t};function f(e){var t=e.trim();return 0===t.length?"":1===t.length?t.toLowerCase():/^[a-z\d]+$/.test(t)?t:(t!==t.toLowerCase()&&(t=p(t)),t=t.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(function(e,t){return t.toUpperCase()})))}function m(e){return s(e)?e.filter((function(e){return null!==e&&void 0!==e})):Object.keys(e).reduce((function(t,n){var r=e[n];return null!==r&&void 0!==r&&(t[n]=r),t}),{})}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function v(e,t){var n;return function(){clearTimeout(n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];n=setTimeout.apply(void 0,[t,e].concat(a))}}function g(e){return null===e||void 0===e}function b(e){return function(t){return g(t)?e:t}}function y(e,t){return t.slice(0,-e)}function j(e){return s(e)?e:[e]}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(e(r))return r}}function x(e,t){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}function _(e,t){return O((function(n){return e(t[n])}),Object.keys(t))}function C(e,t){for(var n=t.length-1;n>=0;n--)if(e(t[n]))return t[n]}function w(e,t,n){for(var r=t;r>=0;r--)if(e(n[r]))return r;return-1}function E(e,t){return w(e,t.length-1,t)}function I(e,t){for(var n=[];e--;)n.push(t);return n}function S(e){return e}function k(e,t){return Object.keys(t).forEach((function(n){e(t[n],n)}))}var T=function(e){return e.reduce((function(e,t){var n=t[0],r=t[1];return e[n]=r,e}),{})};function A(){return Math.random().toString(36).substring(2)}function P(e){var t=A();return i(t,e)?P(e):t}function N(e,t){for(var n="string"===typeof e?e.split("."):e,r=0,a=t;a&&r<n.length;)a=a[n[r++]];return a}function M(e,t,n){var r=N(t,n);return void 0!==r&&null!==r?r:e}function z(e,t){return Object.keys(t).reduce((function(n,r){var a=e(r);return n[a]=n[a]||{},n[a][r]=t[r],n}),{})}function R(e,t){return-1!==t.indexOf(e)}function D(e){return 0===(s(e)?e:Object.keys(e)).length}var L=function(e){return u(e)&&"function"===typeof e.then};function B(e,t){return t.reduce((function(t,n){return t[n[e]]=n,t}),{})}function q(e){return e.length>0?e[e.length-1]:null}function U(e,t){return Object.keys(t).reduce((function(n,r){return n[e(r)]=t[r],n}),{})}function F(e,t){return Object.keys(t).reduce((function(n,r){return n[r]=e(t[r],r),n}),{})}function V(e,t){if(D(t))return e;var n={};return k((function(r,a){i(a,t)?u(e[a])&&u(t[a])?n[a]=V(e[a],t[a]):n[a]=t[a]:n[a]=e[a]}),e),k((function(e,r){i(r,n)||(n[r]=t[r])}),t),n}function G(e){if(0===e.length)return{};var t=e[0];return e.slice(1).reduce((function(e,t){return V(e,t)}),t)}function H(e){return function(e,t){var n={};return function(){var r=e.apply(void 0,arguments);if(i(r,n))return n[r];var a=t.apply(void 0,arguments);return n[r]=a,a}}(S,e)}function W(e){var t,n,r=!1;return function(){return r&&(arguments.length<=0?void 0:arguments[0])===n?t:(r=!0,n=arguments.length<=0?void 0:arguments[0],t=e.apply(void 0,arguments))}}function Y(){}function J(e){return Object.keys(e).map((function(t){return e[t]}))}function K(e,t){var n="function"===typeof e?e:function(t){return N(e,t)};return(s(t)?[].concat(t):J(t)).sort((function(e,t){return n(e)-n(t)}))}function Q(e,t){return Object.keys(t).reduce((function(n,r){return e(t[r],r)||(n[r]=t[r]),n}),{})}function Z(e,t){return Q((function(t,n){return-1!==e.indexOf(n)}),t)}function X(e,t){return Object.keys(t).reduce((function(n,r){return e(t[r])||(n[r]=t[r]),n}),{})}function $(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(void 0,arguments))}}function ee(e,t){return[e,t]}function te(e,t){return Object.keys(t).reduce((function(n,r){return n[e(t[r])?0:1][r]=t[r],n}),[{},{}])}function ne(e,t){return e.reduce((function(e,n){return e[n]=t[n],e}),{})}function re(e,t){return Object.keys(t).reduce((function(n,r){return e(t[r])&&(n[r]=t[r]),n}),{})}function ae(e,t){return Object.keys(t).reduce((function(n,r){return e(t[r],r)&&(n[r]=t[r]),n}),{})}function ie(e,t){return e.reduce((function(e,n){return i(n,t)&&(e[n]=t[n]),e}),{})}function oe(e){for(var t=[],n=0;n<=e;)t.push(n++);return t}function ce(e,t){return t.filter((function(t){return!e(t)}))}function se(e,t){var n=[].concat(t);return n.splice(e,1),n}var ue=n(4);function le(e,t,n){var r,a=e.split?e.split("."):e,o=a[0],c=t;if(a.length>1){var s=null!=n&&i(o,n)?n[o]:{};c=le(a.slice(1),t,s)}return Object(ue.a)({},n,((r={})[o]=c,r))}function de(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function pe(e,t){if(de(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++)if(!i(n[a],t)||!de(e[n[a]],t[n[a]]))return!1;return!0}function fe(e,t){return[t.slice(0,e),t.slice(e,t.length)]}function me(e,t,n){for(var r=!1,a=n.length;a>0;a--){var i=e(n[a-1],t);if(r=i[0],t=i[1],r)return fe(a-1,n)}return[[],n]}function he(e){return e.reduce(r,0)}function ve(e,t,n){var r=w((function(t){return!e(t)}),t,n);return r===t?[]:n.slice(r+1,t+1)}function ge(e,t){return ve(e,t.length-1,t)}function be(e,t){var n,r=Date.now()-2*e,a=function(){r=Date.now(),t.apply(void 0,arguments)};return function(){for(var t=Date.now(),i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];t-r>=e?a.apply(void 0,o):(clearTimeout(n),n=setTimeout.apply(void 0,[a,r-t+e].concat(o)))}}var ye=function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))};function je(e,t){var n,r=Date.now()-2*e,a=function(){return r=Date.now(),t.apply(void 0,arguments)};return function(){var t=Date.now();t-r>=e&&(r=Date.now()),clearTimeout(n);for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];n=setTimeout.apply(void 0,[a,r-t+e].concat(o))}}function Oe(e,t){var n=0;return function(){var r=Date.now();r-n>=e&&(n=Date.now(),t.apply(void 0,arguments))}}var xe=/^\s+/;function _e(e){return e.replace(xe,"")}var Ce=/\s+$/;function we(e){return e.replace(Ce,"")}function Ee(e,t){var n=[];return t.filter((function(t){var r=e(t);return-1===n.indexOf(r)&&(n.push(r),!0)}))}function Ie(e,t,n){return[].concat(n.slice(0,e),[t],n.slice(e+1,n.length))}function Se(e,t,n){return t.map((function(t,r){return e(t,n[r])}))}function ke(e,t){return Se(ee,e,t)}n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"i",(function(){return j})),n.d(t,"k",(function(){return O})),n.d(t,"l",(function(){return x})),n.d(t,"m",(function(){return _})),n.d(t,"n",(function(){return C})),n.d(t,"o",(function(){return E})),n.d(t,"j",(function(){return I})),n.d(t,"p",(function(){return c})),n.d(t,"q",(function(){return k})),n.d(t,"r",(function(){return T})),n.d(t,"s",(function(){return A})),n.d(t,"t",(function(){return P})),n.d(t,"u",(function(){return N})),n.d(t,"v",(function(){return M})),n.d(t,"w",(function(){return z})),n.d(t,"x",(function(){return i})),n.d(t,"y",(function(){return S})),n.d(t,"z",(function(){return R})),n.d(t,"A",(function(){return s})),n.d(t,"B",(function(){return D})),n.d(t,"C",(function(){return g})),n.d(t,"D",(function(){return u})),n.d(t,"E",(function(){return L})),n.d(t,"F",(function(){return B})),n.d(t,"G",(function(){return q})),n.d(t,"I",(function(){return U})),n.d(t,"J",(function(){return l})),n.d(t,"K",(function(){return F})),n.d(t,"N",(function(){return V})),n.d(t,"O",(function(){return G})),n.d(t,"L",(function(){return H})),n.d(t,"M",(function(){return W})),n.d(t,"P",(function(){return Y})),n.d(t,"Q",(function(){return K})),n.d(t,"R",(function(){return Z})),n.d(t,"S",(function(){return X})),n.d(t,"T",(function(){return Q})),n.d(t,"U",(function(){return $})),n.d(t,"V",(function(){return te})),n.d(t,"W",(function(){return ne})),n.d(t,"X",(function(){return re})),n.d(t,"Y",(function(){return ae})),n.d(t,"Z",(function(){return ie})),n.d(t,"ab",(function(){return oe})),n.d(t,"bb",(function(){return ce})),n.d(t,"cb",(function(){return se})),n.d(t,"db",(function(){return le})),n.d(t,"eb",(function(){return pe})),n.d(t,"fb",(function(){return fe})),n.d(t,"gb",(function(){return me})),n.d(t,"hb",(function(){return he})),n.d(t,"ib",(function(){return ge})),n.d(t,"jb",(function(){return ve})),n.d(t,"kb",(function(){return be})),n.d(t,"lb",(function(){return ye})),n.d(t,"mb",(function(){return je})),n.d(t,"H",(function(){return Oe})),n.d(t,"ob",(function(){return _e})),n.d(t,"nb",(function(){return we})),n.d(t,"pb",(function(){return Ee})),n.d(t,"qb",(function(){return Ie})),n.d(t,"rb",(function(){return J})),n.d(t,"sb",(function(){return ke})),n.d(t,"tb",(function(){return Se}))},11:function(e,t,n){"use strict";var r=n(1),a=function(e){return Object(r.lb)(e).map((function(e){return e.map(encodeURIComponent).join("=")})).join("&")},i=function(e){var t=e.split("&").map((function(e){return e.split("=").map(decodeURIComponent)}));return Object(r.r)(t)},o=/(?:[^:]+:\/\/)?([^/\s]+)/;function c(e){var t=e.match(o);return t&&t[1]}var s=/[^:]+:\/\/[^(/|?)\s]+/,u=function(e){var t=e.match(s);return t&&t[0]},l=/.*?\?([^#]+)/,d=function(e){var t=e.match(l);return t?"?"+t[1]:""},p=function(e){return e.replace(/^\?/,"")},f=function(e){var t=p(d(e));return i(t||e)},m=function(e,t){return f(t)[e]},h=/^(?:https?:)?\/\/[^/]+\/([^?#]+)/,v=function(e){var t=e.match(h);return"/"+(t&&t[1]||"")},g=/^((http(s)?:)?\/\/)/,b=function(e){return e.replace(g,"")},y=/^((http(s)?:)?\/\/)/,j=function(e){var t=e.match(y);return t?t[2]:null};n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"e",(function(){return v})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return b})),n.d(t,"k",(function(){return p})),n.d(t,"f",(function(){return j}))},209:function(e,t,n){e.exports=n.p+"static/media/new_message.c597c3a2.mp3"},210:function(e,t,n){e.exports=n.p+"static/media/new_message.a37211a6.ogg"},219:function(e,t,n){e.exports=n.p+"static/media/moment_default_icon.ac8a7636.svg"},220:function(e,t,n){"use strict";var r=n(20),a=n.n(r),i=n(44),o=n(1),c=n(25),s=n(31),u=n.n(s),l=n(42),d=n.n(l),p=n(115),f=n(38),m=n(43),h=n.n(m),v=n(66),g=n(77),b="handshake",y="response",j=n(60),O=n(58),x=n(56),_=n(153),C=n(41),w=n(32),E=function(e){return!!e.data&&e.data["@@livechat/postmessenger"]},I=Object(o.U)((function(){return Object(f.a)(a()((function(e){return e.data.origin=e.origin,e.data}))(u()(E)(Object(w.a)(window,"message"))))}));function S(e){return function(t){return Object(C.a)(a()(e)(t))}}var k=0,T=function(e,t,n){return Object(O.a)((function(){var r=k++;return n.request=r,t(n),h()(1)(S((function(e){if(!e.data.error)return Object(x.a)((function(){return e.data.result}));var t=e.data.result,n=t.real,r=t.error;if(!n)return Object(_.a)(r);var a=new Error(r.message);return Object(o.x)("code",r)&&(a.code=r.code),Object(_.a)(a)}))(u()((function(e){return e.type===y&&e.request===r}))(e)))}))},A=function(e,t,n,r,a){return void 0===a&&(a=null),Object(j.a)({},e,{call:function(e){for(var a=arguments.length,o=new Array(a>1?a-1:0),c=1;c<a;c++)o[c-1]=arguments[c];return Object(i.a)(T(t,r,n("call",{method:e,args:o})))},emit:function(e,t){r(n("emit",{event:e,arg:t}))},data:a})},P=n(76),N=n.n(P);function M(){var e=N()();return[e,function(){var t=new Error("Destroyed.");t.code="DESTROYED",e(2,t)}]}var z=function(e,t,n,r){var a;return(a={})["@@livechat/postmessenger"]=!0,a.owner=e,a.instance=t,a.type=n,a.data=r,a},R=n(80),D=function(e,t,n,r){return function(a){switch(a.type){case"call":return void Object(R.a)((function(){var t=a.data,n=t.method,i=t.args;return r[n].apply(e,i)})).then((function(e){a.type=y,a.data={error:!1,result:e},n(a)}),(function(e){var t;a.type=y,e instanceof Error?(t={real:!0,error:{message:e.message}},Object(o.x)("code",e)&&(t.error.code=e.code)):t={real:!1,error:e},a.data={error:!0,result:t},n(a)}));case"emit":var i=a.data,c=i.event,s=i.arg;return void t(c,s);default:return}}},L=function(e){return Object(o.V)((function(e){return"function"===typeof e}),e)},B=Object(o.s)(),q=0,U=function(e){var t=document.createElement("a");return t.href=e,t.origin?"null"===t.origin?"*":t.origin:(t.protocol.length>4?t.protocol:window.location.protocol)+"//"+(t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host)};function F(e,t){var n=e.frame,r=e.strictOrigin,a=void 0===r||r;void 0===t&&(t={});var i=L(t),o=i[0],s=i[1],l=M(),m=l[0],y=l[1],j=q++,O=n.contentWindow,x=a?U(n.src):"*",_=Object(c.a)(),C=function(e,t){return z(B,j,e,t)},w=function(e){O.postMessage(e,x)},E=Object(f.a)(u()((function(e){return e.owner===B&&e.instance===j}))(Object(v.a)(m)(I()))),k=A(_,E,C,w),P=Object(f.a)(h()(1)(Object(p.a)(5)(Object(g.a)(500)(Object(v.a)(m)(T(E,w,C(b,s))))))),N=D(k,_.emit,w,o);return d()(N)(S((function(){return E}))(P)),{api:k,destroy:y,handshake$:P}}var V=n(116),G=n(28),H=function(e,t){var n=document.createElement("iframe");return e.appendChild(n),n.src=t,n};var W=n(74),Y=n.n(W),J=function(e){if(e.frame)return e.frame;var t=e.container,n=e.url;return H(t,n)};function K(e,t){var n,r=e.onConnected,o=Object(V.a)(e,["onConnected"]),c=!o.frame,s=J(o),u=M(),l=u[0],f=u[1],m=function(){c&&Object(G.f)(s),n?n.destroy():f()};return d()((function(e){e.destroy=m,e.frame=s,r(e)}))(Object(v.a)(l)(Object(p.a)()(S((function(){return Y()((function(e,r){var c=function(e,t){var n=F(e,t),r=n.api,o=n.destroy,c=n.handshake$;return{destroy:o,promise:Object(i.a)(a()((function(e){return r.data=e,r.destroy=o,r}))(c))}}(Object(j.a)({},o,{frame:s}),t);return c.promise.then(e,r),n=c,c.destroy}))}))(Object(w.a)(s,"load"))))),{destroy:m,frame:s}}n.d(t,"a",(function(){return K}))},25:function(e,t,n){"use strict";var r=n(4),a=n(205).a;t.a=function(){var e=Object.create(null),t=a(e);return Object(r.a)({},t,{off:function(n,r){n?t.off(n,r):Object.keys(e).forEach((function(t){delete e[t]}))},once:function(e,n){t.on(e,(function r(a,i){t.off(e,r),n(a,i)}))}})}},28:function(e,t,n){"use strict";var r=n(1),a=function(e,t){Object(r.q)((function(e,n){"style"!==n?t.setAttribute(n,e):function(e,t){Object(r.q)((function(e,n){t.style[n]=e}),e)}(e,t)}),e)},i=!!document.documentElement.currentStyle,o=function(e,t){var n=window.getComputedStyle(t),a="border-box"===n.boxSizing,o=Object(r.W)(e,n);if(i&&a&&Object(r.x)("width",o)&&null!==o.width){var c=[o.width,n.paddingLeft,n.paddingRight,n.borderLeftWidth,n.borderRightWidth];o.width=Object(r.hb)(c.map(parseFloat))+"px"}if(i&&a&&Object(r.x)("height",o)&&null!==o.height){var s=[o.height,n.paddingTop,n.paddingBottom,n.borderTopWidth,n.borderBottomWidth];o.height=Object(r.hb)(s.map(parseFloat))+"px"}return o};function c(){return new Promise((function(e){!function t(){document.body?e(document.body):setTimeout(t,100)}()}))}function s(e,t){return void 0===t&&(t=0),Math.abs(e.scrollTop+e.clientHeight-e.scrollHeight)<=t}function u(e,t){return void 0===t&&(t=0),e.scrollTop<=t}function l(e){var t=e.parentNode;t&&t.removeChild(e)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return l}))},315:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"CONNECTED",(function(){return T})),n.d(r,"DISCONNECTED",(function(){return A})),n.d(r,"NOT_INITIALIZED",(function(){return P})),n.d(r,"RECONNECTING",(function(){return N}));var a={};n.r(a),n.d(a,"getView",(function(){return ne})),n.d(a,"getDefaultView",(function(){return re})),n.d(a,"getCurrentView",(function(){return ae})),n.d(a,"getConnectionState",(function(){return ie})),n.d(a,"getEvent",(function(){return se})),n.d(a,"getEventByServerId",(function(){return ue})),n.d(a,"hasEvent",(function(){return le})),n.d(a,"hasEventByServerId",(function(){return de})),n.d(a,"getIndexedEvents",(function(){return pe})),n.d(a,"getEvents",(function(){return fe})),n.d(a,"getChat",(function(){return me})),n.d(a,"getChatByServerId",(function(){return he})),n.d(a,"hasChat",(function(){return ve})),n.d(a,"getChats",(function(){return ge})),n.d(a,"getUsers",(function(){return be})),n.d(a,"getSessionUser",(function(){return ye})),n.d(a,"getUser",(function(){return je})),n.d(a,"getUserByServerId",(function(){return Oe})),n.d(a,"hasUser",(function(){return xe})),n.d(a,"getTimeline",(function(){return _e})),n.d(a,"getChatList",(function(){return Ce})),n.d(a,"getSessionUserId",(function(){return we})),n.d(a,"getLastDeliveredEvent",(function(){return Ee})),n.d(a,"getLastSeenEvent",(function(){return Ie})),n.d(a,"getLastEvent",(function(){return Se})),n.d(a,"getUnseenCount",(function(){return Pe})),n.d(a,"getLastSeenAgentEvent",(function(){return Ne})),n.d(a,"getParticipants",(function(){return Me})),n.d(a,"localize",(function(){return ze})),n.d(a,"getApplicationState",(function(){return Re}));var i={};n.r(i),n.d(i,"addView",(function(){return Be})),n.d(i,"setCurrentView",(function(){return qe})),n.d(i,"updateView",(function(){return Ue})),n.d(i,"setDefaultView",(function(){return Fe})),n.d(i,"addChat",(function(){return Ve})),n.d(i,"addEvent",(function(){return Ge})),n.d(i,"removeEvent",(function(){return He})),n.d(i,"addHistoryEvents",(function(){return We})),n.d(i,"addParticipant",(function(){return Ye})),n.d(i,"addUser",(function(){return Je})),n.d(i,"flushChat",(function(){return Ke})),n.d(i,"recalculateTimeline",(function(){return Qe})),n.d(i,"removeParticipant",(function(){return Ze})),n.d(i,"sendEvent",(function(){return Xe})),n.d(i,"setApplicationState",(function(){return $e})),n.d(i,"updateFeature",(function(){return et})),n.d(i,"setConnectionState",(function(){return tt})),n.d(i,"setChatServerId",(function(){return nt})),n.d(i,"setEventData",(function(){return rt})),n.d(i,"setEventServerId",(function(){return at})),n.d(i,"setLocalization",(function(){return it})),n.d(i,"setUserServerId",(function(){return ot})),n.d(i,"setUserProperties",(function(){return st})),n.d(i,"requestSetUserProperties",(function(){return ut})),n.d(i,"updateChat",(function(){return dt})),n.d(i,"requestUpdateChat",(function(){return pt})),n.d(i,"updateEvent",(function(){return mt})),n.d(i,"requestUpdateEvent",(function(){return ht})),n.d(i,"updateUser",(function(){return gt})),n.d(i,"requestUpdateUser",(function(){return bt}));var o={};n.r(o),n.d(o,"chatStarted",(function(){return Wi})),n.d(o,"newMessage",(function(){return Yi})),n.d(o,"chatEnded",(function(){return Ji})),n.d(o,"newAgent",(function(){return Ki})),n.d(o,"visitorDataSet",(function(){return Qi})),n.d(o,"visitorDataSetError",(function(){return Zi})),n.d(o,"newFile",(function(){return Xi})),n.d(o,"visitorQueued",(function(){return $i})),n.d(o,"typingIndicator",(function(){return eo})),n.d(o,"rateChat",(function(){return to})),n.d(o,"setVisitorData",(function(){return no})),n.d(o,"sendFile",(function(){return ro})),n.d(o,"requestFileToken",(function(){return ao})),n.d(o,"fileTokenReceived",(function(){return io})),n.d(o,"newInvitation",(function(){return oo})),n.d(o,"messageSeen",(function(){return co})),n.d(o,"protocolUpgraded",(function(){return so})),n.d(o,"integrationData",(function(){return uo}));var c={};n.r(c),n.d(c,"INIT",(function(){return Mv})),n.d(c,"INVITATION",(function(){return zv})),n.d(c,"CHAT_STARTED",(function(){return Rv}));var s={};n.r(s),n.d(s,"heading",(function(){return Iw})),n.d(s,"subheading",(function(){return Sw})),n.d(s,"input",(function(){return kw})),n.d(s,"placeholder",(function(){return Tw})),n.d(s,"caption",(function(){return Aw})),n.d(s,"basic",(function(){return Pw})),n.d(s,"basicContrast",(function(){return Nw})),n.d(s,"errorCaption",(function(){return Mw}));var u=function(){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_js_loaded")};u();var l,d,p,f=n(152),m=n.n(f),h=function(){for(var e;l;){e=l.fn,l=l.next;try{e()}catch(t){throw l?p():d=void 0,t}}d=void 0},v=window.MutationObserver||window.WebKitMutationObserver;if(v){var g=document.createTextNode(""),b=!0;new v(h).observe(g,{characterData:!0}),p=function(){g.data=b=!b}}else p=function(){setTimeout(h,0)};var y=function(e){var t={fn:e,next:void 0};d&&(d.next=t),l||(l=t,p()),d=t};/native code/.test(window.Promise)||(window.Promise=m.a,window.Promise._immediateFn=y),"function"!==typeof window.Promise.prototype.finally&&(window.Promise.prototype.finally=m.a.prototype.finally);n(224),n(242),n(244),n(249),n(254),n(256);var j=n(103),O=n.n(j),x=n(1);Object.assign=O.a,"function"!==typeof Array.prototype.find&&(Array.prototype.find=function(e){return Object(x.k)(e,this)});var _,C=n(5),w=n(9),E=n(59),I=n(11);!function(e){e[e.Emergency=0]="Emergency",e[e.Alert=1]="Alert",e[e.Critical=2]="Critical",e[e.Error=3]="Error",e[e.Warning=4]="Warning",e[e.Notice=5]="Notice",e[e.Informational=6]="Informational",e[e.Debug=7]="Debug"}(_||(_={}));var S=function(e){var t=e.type,n=e.license,r=Object(w.a)(e,["type","license"]),a={licence_id:n.toString(),event_id:t,message:JSON.stringify(r)},i="https://queue.livechatinc.com/logs";var o=Object(E.a)(i,{method:"POST",mode:"no-cors",headers:{Accept:"*/*","Content-Type":"application/x-www-form-urlencoded"},body:Object(I.a)(a)});return o.catch(x.P),o},k=n(68),T="connected",A="disconnected",P="not_initialized",N="reconnecting",M=n(4),z=n(33),R=n(25);function D(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}var L=function(e,t){var n=function n(){var r=t.apply(void 0,arguments);return"function"===typeof r?n:{type:e,payload:r}};return n.getActionName=function(){return e},n.toString=function(){return e},n},B=function(e,t){var n=function(n){var r=Object.create(n);r.action=function(t,r){var a={type:e,payload:t};r&&(a.meta=r),n.dispatch(a)};for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return t.apply(void 0,[r].concat(i))};return n.toString=function(){return e},n},q=function(e,t){var n="REQUEST_"+e,r=B(e,t),a=function(e){for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];var c,s=Object.create(e);if(s.action=function(t){var a=D(),o=a.promise,s=a.resolve,u=a.reject;e.dispatch({type:n,payload:Object(M.a)({},t,{resolve:s,reject:u})}),(c=o).then((function(){r.apply(void 0,[e].concat(i))}),x.P)},t.apply(void 0,[s].concat(i)),"undefined"===typeof c)throw new Error("You forgot to call `action` handler in "+n+" creator.");return c};return a.toString=function(){return n},{actionMethod:r,requestActionMethod:a}},U=function(e,t){if("object"!==typeof e||null===e||Array.isArray(e))throw new Error("bindActionMethods expects a plain object with actionMethods as values.");return Object(x.J)((function(e){return function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.apply(void 0,[t].concat(r))}}(e,t)}),e)},F=function(e,t){return t[void 0]&&console.warn(["Reducer contains an 'undefined' action type.","Have you misspelled a constant?"].join("\n")),function(n,r){return void 0===n&&(n=e),Object(x.x)(r.type,t)?t[r.type](n,r.payload):n}};var V=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},G=function(e){var t;return(t={})["SET_PROPERTY_"+e.toUpperCase()]=function(t,n){var r;return Object(M.a)({},t,((r={})[e]=n.data,r))},t["REMOVE_PROPERTY_"+e.toUpperCase()]=function(t){return Object(M.a)({},Object(x.R)([e],t))},t},H=function(e){var t;return(t={})["getProperty"+V(e)]=function(t){return t[e]},t},W=function(e){var t;return(t={})["setProperty"+V(e)]=L("SET_PROPERTY_"+e.toUpperCase(),(function(e,t){return void 0===t&&(t={}),{data:e,meta:t}})),t["removeProperty"+V(e)]=L("REMOVE_PROPERTY_"+e.toUpperCase(),(function(){return{propName:e}})),t},Y=function(e,t){if("object"!==typeof e||null===e||Array.isArray(e))throw new Error("bindSelectors expects a plain object with selectors as values.");return Object(x.J)((function(e){return function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.apply(void 0,[t()].concat(r))}}(e,t)}),e)},J=function(){var e=[],t=function(t){return function(n){return function(r){var a=n(r);return e.forEach((function(e){e(r,t)})),a}}};return t.add=function(t){e.push(t)},t},K=n(10),Q=function(e){var t=e.id,n=e.serverId,r=void 0===n?null:n,a=e.active,i=void 0===a||a,o=e.participants,c=void 0===o?[]:o,s=e.properties,u=void 0===s?{}:s;if("string"!==typeof t)throw new Error("Chat ID has to be a string.");if(null!==r&&t!==r)throw new Error('If serverId is given ("'+r+'") it should match id ("'+t+'").');return{id:t,serverId:r,active:i,participants:c,properties:u}},Z=function(e){var t=e.id,n=e.type,r=e.author,a=e.timestamp,i=e.own,o=e.serverId,c=void 0===o?null:o,s=e.thread,u=void 0===s?null:s,l=e.serverTimestamp,d=void 0===l?null:l,p=e.delivered,f=void 0===p||p,m=e.seen,h=void 0!==m&&m,v=e.failed,g=void 0!==v&&v,b=e.properties,y=void 0===b?{}:b;if("string"!==typeof t)throw new Error("Event ID has to be a string.");if("string"!==typeof n)throw new Error("Event has to have string `type` property.");if(null!==c&&t!==c)throw new Error('If serverId is given ("'+c+'") it should match id ("'+t+'").');return{id:t,serverId:c,type:n,thread:u,author:r,own:i,timestamp:a,serverTimestamp:d,delivered:f,seen:h,failed:g,properties:y}},X=function(e){var t=e.id,n=e.serverId,r=void 0===n?t:n,a=e.type,i=void 0===a?null:a,o=e.name,c=void 0===o?null:o,s=e.email,u=void 0===s?null:s,l=e.avatar,d=void 0===l?null:l,p=e.properties,f=void 0===p?{}:p;if("string"!==typeof t)throw new Error("User ID has to be a string.");return{id:t,serverId:r,type:i,name:c,email:u,avatar:d,properties:f}},$=n(62),ee=n(114),te=function(e,t){return t},ne=function(e,t){var n=t.replace(/\//gi,".");return Object(x.u)(n,e.views)},re=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object(x.u)(n+"._default",e.views)},ae=function(e){return e.views.current},ie=function(e){return e.session.connectionState},oe=function(e){return e.entities.chats.byIds},ce=function(e,t){return oe(e)[t]},se=function(e,t,n){return ce(e,t).events.byIds[n]},ue=function(e,t,n){return se(e,t,ce(e,t).events.serverIdsMapping[n])},le=function(e,t,n){return!!se(e,t,n)},de=function(e,t,n){return!!ue(e,t,n)},pe=function(e,t){return ce(e,t).events.byIds},fe=Object($.a)([function(e,t){return ce(e,t).events.orderedIds},pe],(function(e,t){return e.map((function(e){return t[e]}))}))(te),me=Object($.a)([ce,fe],(function(e,t){return Object(M.a)({},e,{events:t})}))(te),he=function(e,t){return me(e,e.entities.chats.serverIdsMapping[t])},ve=function(e,t){return!!ce(e,t)},ge=function(e){return Object(x.J)((function(t){var n=t.id;return me(e,n)}),oe(e))},be=function(e){return e.entities.users.byIds},ye=function(e){return be(e)[function(e){return e.session.id}(e)]},je=function(e,t){return be(e)[t]},Oe=function(e,t){return je(e,e.entities.users.serverIdsMapping[t])},xe=function(e,t){return!!je(e,t)},_e=function(e,t){return e.views.Chat[t].timeline},Ce=function(e){return e.views.ChatList},we=function(e){return ye(e).id},Ee=Object($.a)([fe,we],(function(e,t){return Object(x.n)((function(e){var n=e.delivered,r=e.author;return n&&r===t}),e)}))(te),Ie=Object($.a)([fe,we],(function(e,t){return Object(x.n)((function(e){var n=e.seen,r=e.author;return n&&r===t}),e)}))(te),Se=function(e,t){return Object(x.G)(fe(e,t))},ke={boosters:!0,form:!0,system_message:!0},Te=Object(ee.createSelector)([fe,function(e){return ye(e).id}],(function(e,t){return Object(x.o)((function(e){var n=e.author===t&&"message"===e.type,r=!!e.properties&&"file"===e.properties.serverType,a=!0===e.seen&&!ke[e.type]&&e.serverId;return n&&!r||a}),e)})),Ae=function(e,t){return e.author!==t&&!e.seen&&!ke[e.type]},Pe=function(e,t){var n=Te(e,t),r=ye(e).id;return fe(e,t).slice(n+1).filter((function(e){return Ae(e,r)})).length},Ne=function(e,t){var n=Te(e,t);if(-1===n)return null;var r=ye(e).id,a=fe(e,t).slice(n+1);return Object(x.k)((function(e){return Ae(e,r)}),a)},Me=Object($.a)([function(e,t){return ce(e,t).participants},be],(function(e,t){return e.map((function(e){return t[e]}))}))(te),ze=function(e,t,n){var r=e.localization[t];return n?Object.keys(n).reduce((function(e,t){return e.replace(new RegExp("%"+t+"%","g"),n[t])}),r):r},Re=function(e,t){return void 0===t?e.application:e.application[t]},De=["delivered","seen","failed","properties"],Le=function(e,t){return e.forEach((function(e){if(Object(x.x)(e,t))throw new Error("Updating `"+e+"` property is not possible.")}))},Be=B("ADD_VIEW",(function(e,t,n){var r=e.action,a=e.getState;if(void 0===n&&(n={}),ne(a(),t))throw new Error('There is already the "'+t+'" view. It has to be unique.');return r({name:t,data:n}),ne(a(),t)})),qe=B("SET_CURRENT_VIEW",(function(e,t){var n=e.action,r=e.getState;if(!ne(r(),t))throw new Error('Given view "'+t+"\" doesn't exist.");return n({name:t}),ae(r())})),Ue=B("UPDATE_VIEW",(function(e,t,n){var r=e.action,a=e.getState;if(!ne(a(),t))throw new Error('There is no "'+t+'" view. You should add it first.');return r({name:t,data:n}),ne(a(),t)})),Fe=B("SET_DEFAULT_VIEW",(function(e,t,n){var r=e.action,a=e.getState;return r({name:n,path:t}),ne(a(),t+"/"+n)})),Ve=B("ADD_CHAT",(function(e,t){var n=e.action,r=e.getState,a=void 0===t?{}:t,i=a.events,o=void 0===i?[]:i,c=Object(K.a)(a,["events"]);if(ve(r(),c.id))throw new Error('There is already a chat with "'+c.id+'" ID. It has to be unique.');var s=Object(x.k)((function(e){return!xe(r(),e)}),o.map((function(e){return e.author})).concat(c.participants||[]));if(s)throw new Error('Given user ("'+s+"\") doesn't exist. You should add it first.");var u=c.id||Object(x.t)(ge(r()));return n({id:u,chat:Q(Object(M.a)({},c,{id:u})),events:o.map(Z)}),me(r(),u)})),Ge=B("ADD_EVENT",(function(e,t,n){var r=e.action,a=e.getState,i=n.id,o=n.serverId,c=a();if(i&&o&&i!==o)throw new Error('Specified ID ("'+i+'") differs from specified serverId ("'+o+'"). You either should use only ID or both should be the same.');if(!ve(c,t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(le(c,t,i))throw new Error('There is already an event with "'+i+'" ID in this chat ("'+t+'"). It has to be unique.');if(!xe(c,n.author))throw new Error('Specified author ("'+n.author+"\") doesn't exist. You should add it first.");return r({id:i,chat:t,event:Z(Object(M.a)({timestamp:Date.now()},n,{own:n.author===we(c)}))}),se(a(),t,i)})),He=B("REMOVE_EVENT",(function(e,t,n){var r=e.action,a=(0,e.getState)();if(!ve(a,t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!le(a,t,n))throw new Error('There is no event with "'+n+'" ID in this chat ("'+t+'").');r({id:n,chat:t})})),We=B("ADD_HISTORY_EVENTS",(function(e,t,n){var r=e.action,a=(0,e.getState)();if(!ve(a,t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');n.forEach((function(e){if(le(a,t,e.id))throw new Error('There is already an event with "'+e.id+'" ID in this chat ("'+t+'"). It has to be unique.');if(!xe(a,e.author))throw new Error('Specified author ("'+e.author+"\") doesn't exist. You should add it first.")}));var i=we(a);r({chat:t,events:n.map((function(e){return Z(Object(M.a)({},e,{serverId:e.id,own:e.author===i}))}))})})),Ye=B("ADD_PARTICIPANT",(function(e,t,n){var r=e.action,a=e.getState;if(!ve(a(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!xe(a(),n))throw new Error('Given user ("'+n+"\") doesn't exist. You should add it first.");return r({chat:t,user:n}),Me(a(),t)})),Je=B("ADD_USER",(function(e,t){var n=e.action,r=e.getState,a=t.id;if(xe(r(),a))throw new Error('There is already a user with "'+a+'" ID. It has to be unique.');return n({id:a,user:X(t)}),je(r(),a)})),Ke=B("FLUSH_CHAT",(function(e,t){var n=e.action,r=e.getState;if(!ve(r(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');return n({id:t}),me(r(),t)})),Qe=B("RECALCULATE_TIMELINE",(function(e,t){var n=e.action,r=e.getState;if(!ve(r(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');return n({id:t}),_e(r(),t)})),Ze=B("REMOVE_PARTICIPANT",(function(e,t,n){var r=e.action,a=e.getState;if(!ve(a(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!xe(a(),n))throw new Error('Given user ("'+n+"\") doesn't exist. You should add it first.");return r({chat:t,user:n}),Me(a(),t)})),Xe=B("SEND_EVENT",(function(e,t,n,r){var a=e.action,i=e.getState;if(!ve(i(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(le(i(),t,n.id))throw new Error('There is already an event with "'+n.id+'" ID in this chat ("'+t+'"). It has to be unique.');var o=n.id||Object(x.t)(pe(i(),t));return a({id:o,chat:t,event:Z(Object(M.a)({},n,{author:ye(i()).id,own:!0,id:o,timestamp:Date.now(),delivered:!1}))},r),se(i(),t,o)})),$e=B("SET_APPLICATION_STATE",(function(e,t){var n=e.action,r=e.getApplicationState;if(!t||Object(x.B)(t))throw new Error("Given data object is empty.");return n(t),r()})),et=B("UPDATE_FEATURE",(function(e,t,n){var r=e.action,a=e.getApplicationState;if(!n||!t||Object(x.B)(n))throw new Error("Given data object is empty.");return r({feature:t,data:n}),a()})),tt=B("SET_CONNECTION_STATE",(function(e,t){var n=e.action,r=e.getState;return n({connectionState:t}),ie(r())})),nt=B("SET_CHAT_SERVER_ID",(function(e,t,n){var r=e.action,a=e.getState;if(!ve(a(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(null!==me(a(),t).serverId)throw new Error('Chat with "'+t+'" ID has already serverId.');return r({id:t,serverId:n}),me(a(),t)})),rt=B("SET_EVENT_DATA",(function(e,t,n,r){var a=e.action,i=e.getState;if(!ve(i(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!le(i(),t,n))throw new Error('There is no "'+n+'" event in "'+t+'" chat. You should add it first.');return Le(["id","type","own"],r),a({chat:t,id:n,data:Object(M.a)({},Object(x.Z)(De.concat("author","serverId","timestamp"),r),{own:r.author===we(i())})}),se(i(),t,n)})),at=B("SET_EVENT_SERVER_ID",(function(e,t,n,r){var a=e.action,i=e.getState;if(!ve(i(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!le(i(),t,n))throw new Error('There is no "'+n+'" event in "'+t+'" chat. You should add it first.');if(null!==se(i(),t,n).serverId)throw new Error('Event with "'+n+'" ID has already serverId.');return a({chat:t,id:n,serverId:r}),se(i(),t,n)})),it=B("SET_LOCALIZATION",(function(e,t){(0,e.action)(t)})),ot=B("SET_USER_SERVER_ID",(function(e,t,n){var r=e.action,a=e.getState;if(!xe(a(),t))throw new Error('There is no "'+t+'" user. You should add it first.');if(null!==je(a(),t).serverId)throw new Error('User with "'+t+'" ID has already serverId.');return r({id:t,serverId:n}),je(a(),t)})),ct=q("SET_USER_PROPERTIES",(function(e,t,n){var r=e.action,a=e.getState;if(!xe(a(),t))throw new Error('There is no user with "'+t+'" ID. You should add it first.');return r({id:t,properties:n}),je(a(),t)})),st=ct.actionMethod,ut=ct.requestActionMethod,lt=q("UPDATE_CHAT",(function(e,t,n){var r=e.action,a=e.getState;if(!ve(a(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');return Le(["id","participants","events"],n),r({id:t,data:Object(x.Z)(["active","properties"],n)}),me(a(),t)})),dt=lt.actionMethod,pt=lt.requestActionMethod,ft=q("UPDATE_EVENT",(function(e,t,n,r){var a=e.action,i=e.getState;if(!ve(i(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!le(i(),t,n))throw new Error('There is no "'+n+'" event in "'+t+'" chat. You should add it first.');return Le(["id","type","author","own","timestamp"],r),a({chat:t,id:n,data:Object(x.Z)(De,r)}),se(i(),t,n)})),mt=ft.actionMethod,ht=ft.requestActionMethod,vt=q("UPDATE_USER",(function(e,t,n){var r=e.action,a=e.getState;if(!xe(a(),t))throw new Error('There is no user with "'+t+'" ID. You should add it first.');return Le(["id","type"],n),r({id:t,data:Object(x.Z)(["name","email","avatar","properties"],n)}),je(a(),t)})),gt=vt.actionMethod,bt=vt.requestActionMethod,yt=function(e){var t;return void 0===e&&(e={}),F(e,((t={})[et]=function(e,t){var n,r=t.feature,a=t.data;return Object(M.a)({},e,{config:Object(M.a)({},e.config,{features:Object(M.a)({},e.config.features,(n={},n[r]=Object(M.a)({},e.config.features[r],a),n))})})},t[$e]=function(e,t){return Object(M.a)({},e,t)},t))},jt=function(e){return Object(x.rb)(e).reduce((function(e,t){var n=t.serverId,r=t.id;return null===n?e:(e[n]=r,e)}),{})},Ot=function(e,t){var n;return null!==t.serverId?Object(M.a)({},e,((n={})[t.serverId]=t.id,n)):e},xt=function(e,t){var n,r,a=t.id,i=t.chat,o=t.event;return Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(r={},r[i]=Object(M.a)({},e.chats.byIds[i],{events:{byIds:Object(M.a)({},e.chats.byIds[i].events.byIds,(n={},n[a]=o,n)),orderedIds:e.chats.byIds[i].events.orderedIds.concat(a),serverIdsMapping:Ot(e.chats.byIds[i].events.serverIdsMapping,o)}}),r))})})},_t=function(e,t){var n,r=t.id,a=t.chat;return Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(n={},n[a]=Object(M.a)({},e.chats.byIds[a],{events:{byIds:Object(x.R)([r],e.chats.byIds[a].events.byIds),orderedIds:e.chats.byIds[a].events.orderedIds.filter((function(e){return e!==r})),serverIdsMapping:Object(x.S)((function(e){return e!==r}),e.chats.byIds[a].events.serverIdsMapping)}}),n))})})},Ct=function(e,t){var n,r=t.chat,a=t.events;return Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(n={},n[r]=Object(M.a)({},e.chats.byIds[r],{events:{byIds:Object(M.a)({},e.chats.byIds[r].events.byIds,Object(x.F)("id",a)),orderedIds:a.map((function(e){return e.id})).concat(e.chats.byIds[r].events.orderedIds),serverIdsMapping:Object(M.a)({},e.chats.byIds[r].events.serverIdsMapping,Object(x.J)((function(e){return e.id}),Object(x.F)("serverId",a)))}}),n))})})},wt=function(e,t){var n,r=t.id,a=t.user;return Object(M.a)({},e,{users:Object(M.a)({},e.users,{byIds:Object(M.a)({},e.users.byIds,(n={},n[r]=a,n)),serverIdsMapping:Ot(e.users.serverIdsMapping,a)})})},Et=function(e,t,n){var r,a=n.properties,i=Object(K.a)(n,["properties"]),o=e.byIds[t];return Object(M.a)({},e,{byIds:Object(M.a)({},e.byIds,(r={},r[t]=Object(M.a)({},o,i,{properties:a?Object(M.a)({},o.properties,a):o.properties}),r))})},It=function(e,t,n){var r,a,i=e.byIds[t],o={byIds:Object(M.a)({},e.byIds,(r={},r[t]=Object(M.a)({},i,n),r))};n.serverId&&Object(x.x)("serverIdsMapping",e)&&(o.serverIdsMapping=Object(M.a)({},e.serverIdsMapping,((a={})[n.serverId]=t,a)));return Object(M.a)({},e,o)},St=function(e){var t,n=(void 0===e?{}:e).users,r=void 0===n?[]:n,a=Object(x.F)("id",r.map(X));return F({users:{byIds:Object(M.a)({},a,{system:{id:"system",type:"system"}}),serverIdsMapping:jt(a)},chats:{byIds:{},serverIdsMapping:{}}},((t={})[Ve]=function(e,t){var n,r=t.id,a=t.chat,i=t.events;return Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(n={},n[r]=Object(M.a)({},a,{events:{byIds:Object(x.F)("id",i),orderedIds:i.map((function(e){return e.id})),serverIdsMapping:jt(i)}}),n)),serverIdsMapping:Ot(e.chats.serverIdsMapping,a)})})},t[Ge]=xt,t[He]=_t,t[We]=Ct,t[Ye]=function(e,t){var n,r=t.chat,a=t.user,i=e.chats.byIds[r].participants;return Object(x.l)((function(e){return a===e}),i)>-1?e:Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(n={},n[r]=Object(M.a)({},e.chats.byIds[r],{participants:[].concat(i,[a])}),n))})})},t[Je]=wt,t[Ke]=function(e,t){var n,r=t.id;return Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(n={},n[r]=Object(M.a)({},e.chats.byIds[r],{serverId:null,events:{byIds:{},orderedIds:[],serverIdsMapping:{}},properties:{}}),n))})})},t[Ze]=function(e,t){var n,r=t.chat,a=t.user,i=e.chats.byIds[r].participants,o=Object(x.l)((function(e){return a===e}),i);return-1===o?e:Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(n={},n[r]=Object(M.a)({},e.chats.byIds[r],{participants:Object(x.cb)(o,i)}),n))})})},t[Xe]=xt,t[nt]=function(e,t){var n,r=t.id,a=t.serverId;return Object(M.a)({},e,{chats:Object(M.a)({},Et(e.chats,r,{serverId:a}),{serverIdsMapping:Object(M.a)({},e.chats.serverIdsMapping,(n={},n[a]=r,n))})})},t[at]=function(e,t){var n,r,a=t.id,i=t.chat,o=t.serverId;return Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(r={},r[i]=Object(M.a)({},e.chats.byIds[i],{events:Object(M.a)({},Et(e.chats.byIds[i].events,a,{serverId:o}),{serverIdsMapping:Object(M.a)({},e.chats.byIds[i].events.serverIdsMapping,(n={},n[o]=a,n))})}),r))})})},t[rt]=function(e,t){var n,r=t.id,a=t.chat,i=t.data;return Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(n={},n[a]=Object(M.a)({},e.chats.byIds[a],{events:It(e.chats.byIds[a].events,r,i)}),n))})})},t[st]=function(e,t){var n=t.id,r=t.properties;return Object(M.a)({},e,{users:It(e.users,n,{properties:r})})},t[ot]=function(e,t){var n,r=t.id,a=t.serverId;return Object(M.a)({},e,{users:Object(M.a)({},Et(e.users,r,{serverId:a}),{serverIdsMapping:Object(M.a)({},e.users.serverIdsMapping,(n={},n[a]=r,n))})})},t[dt]=function(e,t){var n=t.id,r=t.data;return Object(M.a)({},e,{chats:Et(e.chats,n,r)})},t[mt]=function(e,t){var n,r=t.id,a=t.chat,i=t.data;return Object(M.a)({},e,{chats:Object(M.a)({},e.chats,{byIds:Object(M.a)({},e.chats.byIds,(n={},n[a]=Object(M.a)({},e.chats.byIds[a],{events:Et(e.chats.byIds[a].events,r,i)}),n))})})},t[gt]=function(e,t){var n=t.id,r=t.data;return Object(M.a)({},e,{users:Et(e.users,n,r)})},t))},kt=function(e){return void 0===e&&(e={}),function(t,n){return void 0===t&&(t=e),n.type!==String(it)?t:Object(M.a)({},t,n.payload)}},Tt=function(e){var t;return F(function(e){var t=e.id,n=e.connectionState;return{id:t,connectionState:void 0===n?P:n}}(e),((t={})[tt]=function(e,t){var n=t.connectionState;return Object(M.a)({},e,{connectionState:n})},t))},At=function(e){return+new Date(e).setHours(0,0,0,0)},Pt=function(e,t){return At(e)===At(t)},Nt=function(e){var t=e.sessionUserId,n=e.event,r=e.showDate,a=void 0!==r&&r;return{own:n.author===t,author:n.author,events:[{id:n.id,type:n.type}],type:n.type,showDate:a,timestamp:n.timestamp}},Mt=function(e,t){return Nt({sessionUserId:ye(e).id,event:t,showDate:!0})},zt=function(e){return Object(x.Q)((function(e){return-1*Object(x.v)(0,"timestamp",Object(x.G)(e.events))}),e).map((function(e){return{id:e.id}}))},Rt=function(e,t){var n,r=t.id;return Object(M.a)({},e,{Chat:Object(M.a)({},e.Chat,(n={},n[r]=Object(M.a)({},e.Chat[r],{timeline:[]}),n))})},Dt=function(){return!1},Lt=function(){return!0},Bt=function(){return function(e){return void 0===e&&(e={}),e}},qt=function(e,t){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n){return t.reduce((function(e,t){return t(e,n)}),e)}}(Object(z.c)(Object(x.K)((function(t,n){return t(e[n])}),{application:yt,entities:St,localization:kt,session:Tt,views:Bt})),function(e){var t=e.shouldAddToTimeline,n=void 0===t?Lt:t,r=e.shouldCreateNewGroup,a=void 0===r?Dt:r,i=function(e,t){var n=ye(e).id;return function(r,i){var o=Object(x.G)(r),c=se(e,t,Object(x.G)(o.events).id);return Pt(c.timestamp,i.timestamp)?i.timestamp>=o.timestamp+3e5||o.author!==i.author||a(i)?[].concat(r,[Nt({sessionUserId:n,event:i})]):[].concat(Object(x.h)(1,r),[Object(M.a)({},o,{events:[].concat(o.events,[{id:i.id,type:i.type}])})]):[].concat(r,[Nt({sessionUserId:n,event:i,showDate:!0})])}},o=function(e,t,r){var a=r.filter(n);if(0===a.length)return[];var o=a[0],c=a.slice(1),s=Mt(e,o);return c.reduce(i(e,t),[s])},c=function(e,t,n){var r=ge(n);return{Chat:Object(x.J)((function(e){var t;return(t={})[e.id]={timeline:o(n,e.id,e.events)},t}),r),ChatList:zt(r),current:null}},s=function(e,t,n){var r,a=t.id;return Object(M.a)({},e,{Chat:Object(M.a)({},e.Chat,(r={},r[a]={timeline:o(n,a,me(n,a).events)},r)),ChatList:zt(ge(n))})},u=function(e,t,r){var a,o=t.chat,c=t.id,s=e.Chat[o].timeline,u=se(r,o,c);return n(u)?Object(M.a)({},e,{Chat:Object(M.a)({},e.Chat,(a={},a[o]=Object(M.a)({},e.Chat[o],{timeline:s.length>0?i(r,o)(s,u):[Mt(r,u)]}),a)),ChatList:zt(ge(r))}):e},l=function(e,t){var n,r,a=t.chat,i=t.id,o=e.Chat[a].timeline,c=Object(x.l)((function(e){return e.events.some((function(e){return e.id===i}))}),o),s=o[c],u=s.events.filter((function(e){return e.id!==i}));return u.length>0?r=Object(x.qb)(c,Object(M.a)({},s,{events:u}),o):(r=c+1<o.length?Object(x.qb)(c+1,Object(M.a)({},o[c+1],{showDate:o[c+1].showDate||s.showDate}),o):o,r=Object(x.cb)(c,r)),Object(M.a)({},e,{Chat:Object(M.a)({},e.Chat,(n={},n[a]=Object(M.a)({},e.Chat[a],{timeline:r}),n))})},d=function(e,t,n){var r,a=t.chat,i=t.events,c=e.Chat[a].timeline,s=c[0],u=c.slice(1),l=Object(x.G)(i);s&&Pt(l.timestamp,s.timestamp)&&(s=Object(M.a)({},s,{showDate:Pt(Date.now(),s.timestamp)}));var d=o(n,a,i),p=s?[].concat(d,[s],u):d,f=i[0],m=!Pt(f.timestamp,Date.now());return Object(M.a)({},e,{Chat:Object(M.a)({},e.Chat,(r={},r[a]=Object(M.a)({},e.Chat[a],{hasDividers:m,timeline:p}),r))})},p=function(e,t,n){var r,a=t.id;return Object(M.a)({},e,{Chat:Object(M.a)({},e.Chat,(r={},r[a]={timeline:o(n,a,me(n,a).events)},r))})};return function(e,t){var n=t.type,r=t.payload;if(Object(x.B)(e.views))return Object(M.a)({},e,{views:c(e.views,0,e)});switch(n){case String(Ve):return Object(M.a)({},e,{views:s(e.views,r,e)});case String(Ge):case String(Xe):return Object(M.a)({},e,{views:u(e.views,r,e)});case String(He):return Object(M.a)({},e,{views:l(e.views,r)});case String(We):return Object(M.a)({},e,{views:d(e.views,r,e)});case String(Be):var a=r.name.replace(/\//gi,".");return Object(M.a)({},e,{views:Object(x.db)(a,r.data,e.views)});case String(Ke):return Object(M.a)({},e,{views:Rt(e.views,r)});case String(Fe):var i=r.path.replace(/\//gi,".")+"._default";return Object(M.a)({},e,{views:Object(x.db)(i,r.name,e.views)});case String(Qe):return Object(M.a)({},e,{views:p(e.views,r,e)});case String(qe):return Object(M.a)({},e,{views:Object(M.a)({},e.views,{current:r.name})});case String(Ue):var o=r.name.replace(/\//gi,"."),f=Object(x.u)(o,e.views);return Object(M.a)({},e,{views:Object(x.db)(o,Object(M.a)({},f,r.data),e.views)});default:return e}}}(t))},Ut=function(e,t){var n=e.id,r=t.getState;return me(r(),n)},Ft=function(e,t){var n=e.id,r=e.chat,a=t.getState;return{chat:r,event:se(a(),r,n)}},Vt=function(e,t){var n=e.id,r=t.getState;return je(r(),n)},Gt=function(e){var t=ae(e);return{view:t,default:re(e,t)}},Ht=function(e){var t;return function(e,t){return function(n,r){if(Object(x.x)(n.type,e)){var a=e[n.type](n.payload,r);n.meta&&(a.meta=n.meta),t(n.type.toLowerCase(),a)}}}(((t={})[Ve]=Ut,t[Ge]=Ft,t[Je]=Vt,t[Ke]=Ut,t[pt]=x.y,t[ht]=x.y,t[Xe]=Ft,t[$e]=function(e,t){var n=t.getState;return Re(n())},t[tt]=function(e,t){var n=t.getState;return ie(n())},t[qe]=function(e,t){var n=e.name,r=t.getState;return{name:n,data:ne(r(),n),viewInfo:Gt(r())}},t[Fe]=function(e,t){var n=e.name,r=e.path,a=t.getState;return{name:n,path:r,data:ne(a(),r+"/"+n),viewInfo:Gt(a())}},t[dt]=Ut,t[mt]=Ft,t[gt]=Vt,t[st]=Vt,t[bt]=x.y,t[ut]=x.y,t[nt]=x.y,t),e)},Wt=function(e){var t=e.entities,n=void 0===t?{}:t,r=e.session,a=void 0===r?{}:r,i=a.id,o=void 0===i?"session_"+Object(x.s)():i,c=n.users,s=void 0===c?[]:c,u=Object(x.k)((function(e){return e.id===o}),s);return Object(M.a)({},e,{entities:Object(M.a)({},n,{users:u?s:[].concat(s,[{id:o,serverId:null}])}),session:Object(M.a)({},a,{id:o})})};var Yt=n(122),Jt={},Kt=function(){return Jt};function Qt(e,t){return void 0===t&&(t={}),Object(Yt.b)(e,Kt,void 0,Object(M.a)({areStatesEqual:function(e){return e.getState()===e.getPreviousState()}},t))}var Zt=n(0),Xt=n(14),$t=Zt.createContext(),en=$t.Provider,tn=$t.Consumer,nn=Qt((function(e){return{localization:e.getState().localization,localize:e.localize}}))(function(e){function t(){return e.apply(this,arguments)||this}return Object(Xt.a)(t,e),t.prototype.render=function(){var e=this;return Zt.createElement(en,{value:function(t,n){return e.props.localize(t,n)}},this.props.children)},t}(Zt.Component)),rn=function(e){if("string"===typeof e.children){var t=e.children,n=Object(K.a)(e,["children"]);return Zt.createElement(tn,null,(function(e){return e(t,n)}))}return Zt.createElement(tn,e)};function an(e){var t=e.store,n=e.children,r=Object.create(t);return r.getState=function(){return t},Zt.createElement(Yt.a,{store:r},Zt.createElement(nn,null,n))}var on=r.CONNECTED,cn=r.DISCONNECTED,sn=r.RECONNECTING,un=function(e,t){var n=t.getChat(e).properties.currentAgent;return n?t.getUser(n):null},ln=function(e,t){return t.getApplicationState("config").features[e]},dn=function(e){return ln("continuousChat",e).enabled},pn=function(e){return ln("chatHistory",e).enabled},fn=function(e,t,n){var r=t.authorPredicate,a=t.lastSeenPredicate,i=n.getEvents(e),o=Object(x.o)(a,i),c=Object(x.jb)((function(e){return r(e)||!e.seen}),o,i);return Object(x.bb)(r,c)},mn=function(e,t,n){var r=n.getSessionUserId();return fn(e,{authorPredicate:function(e){return e.author!==r},lastSeenPredicate:function(e){return(e.serverTimestamp||e.timestamp)<=t}},n)},hn=function(e,t,n){var r=n.getSessionUserId();return fn(e,{authorPredicate:function(e){return e.author===r},lastSeenPredicate:function(e){return e.timestamp<=t}},n)},vn=function(e,t,n){var r=e.getEvent(t,n);if(!r.own)return null;if(r.failed)return"Message not sent";if(r.seen){var a=e.getLastSeenEvent(t);return a&&n===a.id?e.localize("message_read"):null}var i=e.getLastDeliveredEvent(t);return i&&n===i.id?e.localize("message_delivered"):null},gn=function(e){var t=e.getApplicationState("config");return!0===e.getApplicationState("mobile")?t.mobileMinimizedType:t.minimizedType},bn=function(e){var t=e.getApplicationState("config");return!0===e.getApplicationState("mobile")?t.mobileScreenPosition:t.screenPosition},yn=function(e,t){return pn(e)&&e.getChat(t).properties.hasMoreHistory},jn=function(e,t){var n=e.getChat(t).properties.fakeAgentMessageId;return n?e.getEvent(t,n):null},On=function(e,t){return!!jn(e,t)},xn=function(e){return!!e.getApplicationState("embedded")},_n=function(e,t){var n=t.getChat("liveChatChatId"),r=n.active,a=n.properties.queued;if(r||a||On(t,e))return!1;var i=t.getApplicationState(),o=i.availability,c=i.maximized,s=i.ready;return"online"===o&&(!s||(!c||Object(x.B)(t.getEvents(e))))},Cn=function(e,t){if(pn(t))return!1;var n=t.getApplicationState(),r=n.availability,a=n.embedded,i=n.actingAsDirectLink,o=n.isInCustomContainer,c=t.getChat(e);return a&&!i&&!o&&!c.active&&!c.properties.ended&&"offline"===r&&!Bn(t)},wn=function(e){return e.getConnectionState()===on},En=function(e){return e.getConnectionState()===cn},In=function(e){return e.getConnectionState()===sn||En(e)},Sn=function(e,t){if(!t.getChat(e).active)return null;var n=t.getEvents(e);return function e(t,n){if(n<0)return null;var r=t[n];return r.own&&"message"===r.type?null:"system_message"===r.type||"rich_message_postback"===r.type?e(t,n-1):r.properties.quickReplies?r:null}(n,n.length-1)},kn=function(e,t){var n=t.getApplicationState().availability,r=t.getChat(e),a=r.active,i=r.properties,o=i.queued,c=i.ended;if(o)return t.localize("embedded_waiting_for_operator");var s=un(e,t);return a&&s?t.localize("embedded_chat_with",{operator:s.name}):c?t.localize("embedded_chat_ended"):"online"===n?t.localize("embedded_chat_now"):Bn(t)?t.localize("embedded_leave_message"):t.localize("agents_not_available")},Tn=function(e,t){var n=e.getChat(t),r=dn(e);return Yn(e)?null:n.active?"text":qn(e)?null:n.properties.ended?"startChatAgain":"offline"!==e.getApplicationState().availability||r?On(e,"liveChatChatId")?Ln(e)&&ln("preChatAfterGreeting",e).enabled?"requestPrechat":"text":r?Ln(e)?"requestPrechat":"text":null:null},An=function(e,t){return!!t.getChat(e).properties.queued},Pn=function(e,t){return!!t.getChat(e).properties.starting},Nn=function(e){return e.getApplicationState("testGroup")},Mn=function(e){return 1520===e.getApplicationState("license")},zn=Mn,Rn=function(e){var t=e.localize("user_in_queue"),n=e.getView("Chat/prechat").fields;if(!n||Object(x.B)(n))return t;var r=n.find((function(e){var t=e.meta;return t&&"groupSelect"===t}));if(!r||!r.options||Object(x.B)(r.options))return t;var a=r.options.find((function(t){return t.groupNumber===e.getApplicationState("group")}));return a&&a.queueTemplate?a.queueTemplate:t},Dn=function(e){return e.getApplicationState("config").theme.name},Ln=function(e){return e.getApplicationState().config.features.preChatForm.enabled},Bn=function(e){return e.getApplicationState().config.features.offlineForm.enabled},qn=function(e,t){void 0===t&&(t=void 0);var n=e.getLastEvent("liveChatChatId");if(!n)return!1;var r=n.type,a=n.properties;return"form"===r&&!a.answered&&("string"!==typeof t||a.formType===t)},Un=function(e,t){var n=e.getView("Chat/"+t);return n&&n.fields},Fn=function(e){var t=e.getChat("liveChatChatId"),n=t.active,r=t.properties,a=r.queued,i=r.ended,o=r.startChatAgainPending,c=r.currentAgent,s=dn(e);return!n&&(s||!a)&&(!i||o)&&(!s||!c)&&(!Bn(e)||s)&&"offline"===e.getApplicationState("availability")},Vn=function(e){return un("liveChatChatId",e)&&!qn(e)&&!An("liveChatChatId",e)&&!Fn(e)},Gn=function(e,t){return"loader"===t.getDefaultView("Chat")||Object(x.B)(t.getEvents(e))&&!An("liveChatChatId",t)&&!Fn(t)&&!dn(t)},Hn=function(e){var t=e.getLastEvent("liveChatChatId");return!!t&&("form"===t.type&&"offline"===t.properties.formType&&t.properties.answered)},Wn=function(e){var t=e.getApplicationState(),n=t.actingAsDirectLink,r=t.isInCustomContainer,a=t.mobileWrapper,i=t.embedded;return!n&&!r&&(a||i)},Yn=function(e){return!!e.getChat("liveChatChatId").properties.queued&&(!dn(e)||"offline"!==e.getApplicationState("availability"))},Jn=function(e){return e.hasEvent("liveChatChatId","queue_information")},Kn=function(e){return e.hasEvent("liveChatChatId","offline_information")},Qn=function(e){return e.getChat("liveChatChatId").active&&!In(e)&&ln("fileSharing",e).enabled},Zn=function(e){var t=e.getChat("liveChatChatId").properties.queued;return!In(e)&&(!t||dn(e))},Xn=function(){var e=Object(I.h)(window.location.search);return parseInt(function(){var e=String(window.location).match(/licen(?:s|c)e\/g?(\d+)/);return e?e[1]:null}()||e.license,10)},$n=function(e){var t=parseInt(e,10);return t>-1?t:null},er=function(){return"1"===Object(I.g)("unique_groups",window.location.search)||"1"===Object(I.g)("unique_group",window.location.search)},tr=function(e,t,n){void 0===n&&(n={});var r=n,a=r.name,i=void 0===a?function(e){var t=e.getSessionUser().name;return t||e.localize("client")}(e):a,o=r.agent,c=void 0===o?function(e){return un("liveChatChatId",e).name}(e):o;return t.replace(/%name%/g,i).replace(/%agent%/g,c)},nr=function(e){return Object(k.b)(e)>.8},rr=function(e){return Object(k.b)(e)<=.179},ar=[/sendURLToGuardwareProxy/i,/safari-extension:\/\//],ir=function(e,t,n){var r=Object(C.a)({type:"chat_widget_"+t,license:Xn(),userAgent:navigator.userAgent,severity:e,lc_env:"production"},n);return S(r)},or=function(e,t,n){var r,a={};if(t instanceof Error?(a.errorMessage=t.message,a.stack=t.stack,a.code=t.code):a.errorMessage=JSON.stringify({error:t}),r=a,!ar.some((function(e){return e.test(r.errorMessage+" "+r.stack)})))return Object(x.D)(n)||(n={meta:JSON.stringify({info:n})}),ir("Error",e,Object(C.a)({},n,a))},cr=function(e,t){return ir("Informational",e,t)},sr=function(e){return cr("chat_rated",e)},ur=(n(171),n(172)),lr=n.n(ur),dr=n(104),pr=(n(173),n(74)),fr=n.n(pr),mr=n(174),hr=n(58),vr=n(175),gr=(n(176),n(105)),br=n(177),yr=n(31),jr=n.n(yr),Or=n(41),xr=n(42),_r=n.n(xr),Cr=n(32),wr=n(75),Er=n.n(wr);function Ir(e,t){return fr()((function(n){return e.on(t,n),function(){e.off(t,n)}}))}var Sr=n(178),kr=n.n(Sr),Tr=n(106),Ar=n(65),Pr=n.n(Ar),Nr=n(107),Mr=n.n(Nr),zr=n(20),Rr=n.n(zr);function Dr(e){return function(t){return Object(Or.a)(Rr()(e)(t))}}var Lr=function(e,t,n){e.on(t,(function r(a){e.off(t,r),n(a)}))};var Br=n(56);n(179);var qr,Ur=(qr=function(){return gr.a},function(e){return function(t,n){if(0===t){var r,a=!1,i=function(e,t){r(e,t)};e(t,(function e(t,o){if(0===t)return r=o,a?void i(1):void n(t,i);if(2===t&&o&&!a){a=!0;try{qr(o)(0,e)}catch(c){n(2,c)}}else n(t,o)}))}}}),Fr=(n(108),n(180)),Vr=n(109),Gr=(n(181),n(182)),Hr=n(183),Wr=n(38),Yr=n(184),Jr=n.n(Yr),Kr=(n(76),n(110),n(43)),Qr=n.n(Kr),Zr=n(66),Xr=(n(185),n(186),n(77),n(187)),$r=n(44);function ea(e,t){return Pr()(kr()(e),Mr()(e.getState()),Rr()(t),Object(vr.a)(x.eb))}var ta=function(e){return Pr()(ea(e,(function(e){return e.application.ready})),jr()(Boolean),Qr()(1),Hr.a)},na=function(e){return Pr()(ta(e),Dr((function(){return Pr()(ea(e,(function(e){return me(e,"liveChatChatId").active})),Jr()(1),jr()(Boolean))})))},ra=function(){return Object(x.u)("webkit.messageHandlers.iosMobileWidget.postMessage",window)?"ios":!!Object(x.u)("androidMobileWidget.postMessage",window)&&"android"},aa=function(e){return window.androidMobileWidget.postMessage(JSON.stringify(e))},ia=function(e){return window.webkit.messageHandlers.iosMobileWidget.postMessage(e)},oa=function(){var e=ra();return"android"===e?aa:"ios"===e?ia:null}(),ca=function(){return Boolean(ra())},sa=function(e){oa&&(oa({messageType:"uiReady"}),e.on("add_event",(function(t){var n=t.event;if("message"===n.type){var r=e.getUser(n.author).name;oa({messageType:"newMessage",text:n.properties.text,id:n.id,timestamp:n.timestamp,author:{name:r}})}})),e.on("mobile_wrapper_minimize_intent",(function(){oa({messageType:"hideChatWindow"})})))},ua=function(e){var t,n=e.getApplicationState(),r=n.mobile,a=n.protocol,i=n.embedded,o=n.testGroup,c=n.actingAsDirectLink,s=n.config,u=n.language,l=n.integrationName,d=n.clientChatNumber,p=n.clientVisitNumber,f=s&&s.theme&&s.theme.name,m=ra()||"none",h=er(),v=pn(e),g=!!yn(e,"liveChatChatId"),b=!!e.getSessionUser().email,y=function(e,t){var n=e.getChat(t).properties.lastThread,r=Object(x.n)((function(e){return Object(x.u)("properties.invitation",e)||Object(x.u)("properties.thread",e)!==n}),e.getEvents(t));return!!Object(x.u)("properties.invitation",r)}(e,"liveChatChatId")?"invitation":"other";t={mobile:r,embedded:i,themeName:f,testGroup:o,uniqueGroups:h,language:u||"unknown",lcProtocol:a||"unknown",integrationName:l||"none",mobileBridgeType:m,chatHistoryEnabled:v,hasPreviousChatThreads:g,isCustomerEmailSet:b,actingAsDirectLink:c,chatWidgetWidth:window.innerWidth,chatWidgetHeight:window.innerHeight,clientChatNumber:d+1,clientVisitNumber:p,chatSource:y},cr("chat_started",t)},la=function(e){return Pr()(na(e),_r()((function(){return ua(e)})))},da=new RegExp("("+["BetterJsPop","LOCAL_STORAGE is null","Can't find variable: auto","Can't find variable: ext","_avast_submit","No license found in the URL.","getNewsReadStatus4Vivo","is banned!"].join("|")+")"),pa=new RegExp("("+["chrome-extension://","https://www.smybeds.com/"].join("|")+")"),fa=function(e){return!!(e.message&&da.test(e.message)||e.stack&&pa.test(e.stack))};window.addEventListener("error",(function(e){var t=e.error;if(t)if(t.message&&-1!==t.message.indexOf("evaluating 'document.getElementById('view-chat').innerHTML'")){var n=Xn();if(10095588===n||7243681===n)return;or("custom_mobile_hacks",t)}else fa(t)||or("onerror",t)})),window.addEventListener("unhandledrejection",(function(e){null!=e&&null!=e.reason&&(fa(e)||or("unhandledrejection",e.reason))}));var ma=n(124),ha=ma.a.Model;ma.a.Model=function(){return function(e){var t=Object(R.a)(),n={};return e.resolveRemoteCall=function(e){var t=e.id,r=e.value,a=n[t];delete n[t],a(r)},e.emitEvent=function(e){var n=e.event,r=e.data;t.emit(n,r)},new ha(e).then((function(r){return r.call=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];return new Promise((function(t){var i=Object(x.t)(n);n[i]=t,r.emit("remote-call",{id:i,method:e,args:a})}))},e.remoteCall=function(t){var n=t.id,a=t.method,i=t.args,o="function"===typeof e[a]?e[a].apply(r,i):void 0;o&&"function"===typeof o.then?o.then((function(e){r.call("resolveRemoteCall",{id:n,value:e})})):r.call("resolveRemoteCall",{id:n,value:o})},r.on=t.on,r.off=t.off,r}))}}();var va=ma.a;function ga(e,t){return"object"===typeof e&&"object"===typeof t?ba(e,t):e}function ba(e,t){var n;if(Array.isArray(e)){n=new Array(e.length);for(var r=0;r<e.length;r++)e[r]!==t[r]&&(n[r]=ga(e[r],t[r]))}else n={},Object.keys(e).forEach((function(r){e[r]!==t[r]&&(n[r]=ga(e[r],t[r]))}));return n}var ya=n(48),ja=Object(ya.b)()?window.localStorage:ya.a,Oa=6e4;function xa(e,t){var n,r=Object(x.J)((function(e){return e.defaultValue}),t),a=Object.keys(t),i=Object(x.e)((function(e){return Object(C.a)({},r,e)}),(function(e){return Object(x.J)((function(e){return e.value}),e)}),(function(e){var n=Date.now();return Object(x.T)((function(e,r){return e.expires<n||void 0===t[r]}),e)}),JSON.parse,Object(x.g)("{}"),(function(){return ja.getItem(e)})),o=Object(x.e)(JSON.stringify,(function(e){var t=Date.now()+30*Oa;return Object(x.J)((function(e){return{value:e,expires:t}}),e)}));return{persist:function(r){return r.subscribe((function(){var c,s=(c=r.getState(),a.reduce((function(e,n){return e[n]=Object(x.u)(t[n].path,c),e}),{})),u=ba(s,n);Object(x.B)(u)||(ja.setItem(e,o(Object(x.N)(i(),u))),n=s)})),r},rehydrate:function(){return n=i(),e=n,a.reduce((function(n,r){return Object(x.db)(t[r].path,e[r],n)}),{});var e}}}var _a,Ca=function(e){var t,n=[],r=D();return e.startStateSync=function(a){t=e.getState(),a.emit("state",t);var i=function(){n.forEach((function(e){var t=e[0],n=e[1];a.emit(t,n)})),n.length=0},o=function(e,t){1===n.push([e,t])&&setTimeout(i,0)};e.subscribe((function(){var n=e.getState();n!==t&&(o("state_diff",ba(n,t)),t=n)}));var c=/^request_/;e.on("*",(function(e,t){c.test(e)||o("store_event",[e,t])})),r.resolve()},e.syncing=function(){return r.promise},e},wa={application:{rtl:!1,actingAsDirectLink:!1,availability:null,clientLimitExceeded:!1,clientLimitExceededLifted:!1,config:{features:{agentAvatar:{enabled:!0},boosters:{enabled:!1,items:[]},chatHistory:{enabled:!1},continuousChat:{enabled:!1},creditCardMasking:{enabled:!1},disableSounds:{enabled:!1},emailTranscript:{enabled:!0},facebookButton:{enabled:!1},fileSharing:{enabled:!0},googlePlusButton:{enabled:!1},hideOnInit:{enabled:!1},hideOnMobile:{enabled:!1},hideTrademark:{enabled:!1},linksPreview:{enabled:!0},logo:{enabled:!0,path:"https://cdn.livechatinc.com/cloud/?uri=http://livechat.s3.amazonaws.com/default/logo/c4bf6633aa89a76af7461279581d8bdb.png"},offlineForm:{enabled:!0},preChatAfterGreeting:{enabled:!0},preChatForm:{enabled:!1},rating:{enabled:!0},twitterButton:{enabled:!1},mobileMinimized:{enabled:!0},minimized:{enabled:!0}},minimizedType:"bar",screenPosition:"right",theme:{}},destroyed:!1,eagerFetchingMode:!1,embedded:!0,mobileWrapper:null,invitation:{},isInCustomContainer:!1,hasUnseenEvents:!1,hidden:!1,maximized:!1,pageFocused:!1,applicationFocused:!1,mobile:/mobile/gi.test(navigator.userAgent),muted:!1,ready:!1,loadedInitialHistory:!1,integrationName:null,language:null,clientVisitNumber:0,clientChatNumber:0}},Ea={boosters:!0,carousel:!0,emoji:!0,form:!0,image_preview:!0,message:!0,rich_message:!0,sticker:!0,system_message:!0,url_preview:!0,email_prompt:!0,queue_information:!0,offline_information:!0},Ia=((_a={boosters:!0,carousel:!0,form:!0}).queue_information=!0,_a.offline_information=!0,_a),Sa=function(e){return function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=Object(R.a)(),r=x.y,o=J(),c=Object(z.d)(qt(Wt(e),t),void 0,r(Object(z.a)(o)));o.add(Ht(n.emit));var s=c.getState(),u=s,l=s;return c.subscribe((function(){var e=c.getState();if(l!==e){var t=[l,e];u=t[0],l=t[1]}})),Object(x.a)(c,U(i,c),Y(a,c.getState),{getPreviousState:function(){return u},emit:n.emit,on:n.on,once:n.once,off:function(e,t){if(!e||!t)throw new Error(".off needs to be called with both type and handler arguments.");if("*"===e)throw new Error(".off('*', ...) is not supported.");n.off(e,t)}}),c}(e,{shouldAddToTimeline:function(e){return Ea[e.type]},shouldCreateNewGroup:function(e){return Ia[e.type]}})},ka=function(e,t){var n=xa((void 0===t?{}:t).persistKey,{clientLimitExceededLifted:{path:["application","clientLimitExceededLifted"],defaultValue:!1},eyeCatcherHidden:{path:["application","eyeCatcher","hidden"],defaultValue:!1},invitationHidden:{path:["application","invitation","hidden"],defaultValue:!1},maximized:{path:["application","maximized"],defaultValue:!1},muted:{path:["application","muted"],defaultValue:!1}}),r=Object(x.N)(wa,Object(x.N)(e,n.rehydrate()));return Object(x.e)(n.persist,Ca,Sa)(r)},Ta=[{id:"iframekb",template:"moment",title:"Knowledge Base",description:"Save time with Knowledge Base - easy to access know-how right in the LiveChat widget",icon:"https://www.knowledgebase.ai/apple-touch-icon.71342b95.png",action:{type:"button",label:"Search",url:"https://livechat.kb.help/"}}],Aa=function(e,t){var n=!!Object(I.g)("lc_boosters",window.location.search)?function(e){return Object(x.N)(e,{application:{config:{features:{boosters:{enabled:!0,items:Ta}}}}})}(e):e,r=ka(n,t);return r.setCurrentView("Chat"),r.addView("Chat/information"),r.addView("loader"),r.addView("Chat/postchat"),r.addView("Chat/prechat"),r.addView("Chat/queue"),r.addView("Chat/timeline"),r.addView("minimized",{text:"Chat"}),r.addView("Chat/offline"),r.addView("Moment",{show:!1,data:{}}),r.addView("uploadList",{ids:[]}),r.addChat({id:"liveChatChatId",active:!1,properties:{agentIsTyping:!1,ended:!1,fakeAgentMessageId:null,hasMoreHistory:null,lastThread:null,loadingHistory:!1,queued:!1,rate:null,rateComment:null}}),r},Pa=n(82),Na=n(150),Ma=n.n(Na),za=n(151),Ra=n.n(za),Da=/^\s+$/,La=/^(?:\s+|[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/,Ba=3;function qa(e){for(var t=null,n=0;t=La.exec(e);){var r=t[0];if(e=e.slice(r.length),Da.test(r)||n++,n>Ba)return!1}return!e}var Ua=function(e){var t=e.customJson||{},n=rr(e.agentbarBackgroundColor)?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.05)",r=rr(e.agentbarBackgroundColor)?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.1)";return Object(x.N)({name:e.name,iconTheme:e.name,showMessageAvatar:"modern"!==e.name,colors:{agentBarText:e.agentbarText,agentBarBackground:e.agentbarBackgroundColor,cta:e.ctaColor,destructiveColor:"#eb4736",minimizedIcon:e.minimizedColorIcon,background:e.backgroundColor,visitorMessageText:e.visitorMessageColorText,visitorMessageBackground:e.visitorMessageBackgroundColor,systemMessage:e.systemMessageColor,agentMessageText:e.agentMessageColorText,minimizedText:e.minimizedColorText,titleBarText:e.titlebarText,titleBarBackgroundColor:e.titlebarBackgroundColor},AgentBar:{css:{background:e.agentbarBackgroundColor,color:e.agentbarText},IconButton:{css:{background:{default:n,active:e.ctaColor}}}},Form:{IconButton:{css:{background:{default:"rgba(0, 0, 0, 0.05)",active:e.ctaColor}}}},ChatSummary:{Icon:{color:e.minimizedColorIcon}},Divider:{css:{borderColor:n}},Maximized:{css:{background:e.backgroundColor}},Message:{own:{Bubble:{css:{background:"modern"===e.name?"transparent":e.visitorMessageBackgroundColor,color:e.visitorMessageColorText}}},system:{Bubble:{css:{color:e.systemMessageColor}}},Bubble:{css:{background:"modern"===e.name?"transparent":e.agentMessageBackgroundColor,color:e.agentMessageColorText}},css:{color:e.systemMessageColor}},TypingIndicator:{css:{color:e.systemMessageColor}},Minimized:{MinimizedBubble:{css:{color:e.minimizedColorText,backgroundColor:e.minimizedColorBackground},Icon:{color:e.minimizedColorIcon}},MinimizedBar:{css:{color:e.minimizedColorText,backgroundColor:e.minimizedColorBackground},Icon:{color:e.minimizedColorIcon}}},TitleBar:{css:{color:e.titlebarText,backgroundColor:e.titlebarBackgroundColor}},DividerLabel:{css:{color:e.systemMessageColor,borderColor:r}},TextComposer:{IconButton:{active:{Icon:{color:e.ctaColor}}}}},t)},Fa=[0,2,4,6,8,1,3,5,7,9],Va=function(e){return e.replace(/\b(?:\d[ -]*?){8,15}((?:\d[ -]*?){4})\b/g,(function(e,t){var n=e.replace(/(-|\s)/g,"");return function(e){if(/[^0-9-\s]+/.test(e))return!1;for(var t,n=e.replace(/\D/g,""),r=n.length,a=1,i=0;r;)t=parseInt(n.charAt(--r),10),i+=(a^=1)?Fa[t]:t;return i&&i%10===0}(n)?""+function(e){var t=e%4,n=t?4-t:0,r=Math.floor(e/4)+(t?1:0)-n-1,a=Object(x.j)(n,"XXX"),i=Object(x.j)(r,"XXXX");return a.concat(i).join("-").concat("-")}(n.length)+t:e}))},Ga=new Ma.a;Ga.tlds(Ra.a);var Ha=function(e,t,n){var r=Object(x.l)((function(t){return t.name===e}),n);return-1!==r?Object(x.qb)(r,Object(C.a)({},n[r],{defaultValue:t}),n):n},Wa=function(e,t,n){e.addEvent(t,Object(C.a)({},n,{serverId:n.serverId||null}))},Ya=function(e,t){var n=e.getView("uploadList").ids;e.updateView("uploadList",{ids:[].concat(n,[t])})},Ja=function(e,t){var n=e.getView("uploadList").ids;e.updateView("uploadList",{ids:n.filter((function(e){return e!==t}))})},Ka=function(e){_i(e),e.updateChat("liveChatChatId",{active:!1,properties:{ended:!0,queued:!1,agentIsTyping:!1}})},Qa=function(e){e.setApplicationState({eyeCatcher:Object(C.a)({},e.getApplicationState().eyeCatcher,{hidden:!0})})},Za=function(e){e.setApplicationState({invitation:Object(C.a)({},e.getApplicationState().invitation,{hidden:!0})})},Xa=function(e){e.setApplicationState({maximized:!0})},$a=function(e){e.setApplicationState({maximized:!1})},ei=function(e,t){var n=t.id,r=t.thread,a=t.group,i=t.agent,o=t.queued,c=void 0!==o&&o;void 0!==i&&ri(e,i);var s=un("liveChatChatId",e);null===e.getChat("liveChatChatId").serverId&&e.setChatServerId("liveChatChatId",n);var u={ended:!1,queued:c,fakeAgentMessageId:null};void 0!==r&&(u.lastThread=r),"number"===typeof a&&(u.group=a),Za(e),Qa(e),e.updateChat("liveChatChatId",{active:!0,properties:u}),Oi(e),Object(x.u)("properties.isBot",s)?setTimeout((function(){return"loader"===e.getDefaultView("Chat")&&e.setDefaultView("Chat","timeline")}),1500):e.setDefaultView("Chat","timeline"),e.setApplicationState({hidden:!1});var l=e.getApplicationState(),d=l.maximized,p=l.ready;e.setCurrentView("Chat"),p&&!d&&Xa(e),c||_i(e),Fn(e)||Ci(e)},ti=/\s/,ni=function(e,t,n,r){var a=n.trim(),i=(!ti.test(a)&&Ga.match(a),n);ln("creditCardMasking",e).enabled&&(i=Va(n));var o="message";qa(i)&&(o="emoji"),e.sendEvent(t,{type:o,properties:Object(x.d)({text:i,triggeredBy:r})})},ri=function(e,t){e.updateChat("liveChatChatId",{properties:{currentAgent:t}})},ai=function(e){if(!qn(e,"prechat")){var t=e.getView("Chat/prechat");fi(e,t)}},ii=function(e,t){var n=e.getChat("liveChatChatId").properties,r=n.rate,a=n.rateComment,i=t.fields,o=Object(w.a)(t,["fields"]);r&&(i=Ha("rating",r,i)),a&&(i=Ha("rateComment",a,i)),fi(e,Object(C.a)({},o,{fields:i}))},oi=function(e,t,n){var r=(void 0===n?{}:n).chatId;e.updateChat("liveChatChatId",{properties:{startChatAgainPending:!1}}),e.updateView("uploadList",{ids:[]}),gi(e);var a=e.getChat("liveChatChatId").properties.lastThread;if(pn(e)){ji(e);var i=jn(e,"liveChatChatId");i&&e.removeEvent("liveChatChatId",i.id),e.hasEvent("liveChatChatId","boosters")&&e.removeEvent("liveChatChatId","boosters")}else e.flushChat(t),Fn(e)&&Ii(e),r&&e.setChatServerId("liveChatChatId",r);e.updateChat(t,{properties:{agentIsTyping:!1,ended:!1,fakeAgentMessageId:null,lastThread:a,loadingHistory:!1,queued:!1,rate:null,rateComment:null}}),vi(e)},ci=function(e,t){var n=t.getApplicationState("config");t.setApplicationState({config:Object(C.a)({},n,{features:Object(x.N)(n.features,e.features),minimizedType:e.theme.minimized,mobileMinimizedType:e.theme.mobileMinimized,theme:Object(x.N)(n.theme,Ua(e.newTheme)),screenPosition:e.screenPosition,mobileScreenPosition:e.mobileScreenPosition,nonProfitLicense:e.nonProfitLicense})}),e.features.disableSounds.enabled&&t.setApplicationState({muted:!0})},si=function(e,t,n){var r,a=e.getApplicationState("config");e.setApplicationState({config:Object(C.a)({},a,{features:Object(x.N)(a.features,(r={},r[t]=n,r))})})},ui=function(e,t,n){si(e,t,Object(C.a)({enabled:!0},n))},li=function(e,t,n){var r={answered:!0};n&&(r.fields=n.properties.fields,n.id&&e.setEventServerId("liveChatChatId",t,n.id)),e.updateEvent("liveChatChatId",t,{properties:r})},di=function(e,t){var n=t.authorId,r=t.text,a=t.receivedFirstTime,i=t.properties,o=void 0===i?{}:i,c=e.getApplicationState(),s=c.mobile,u=c.maximized;ri(e,n);var l=s||"bar"!==gn(e),d=!u&&!l&&a;l||Za(e),"bar"!==gn(e)&&Qa(e);var p=Object(x.t)(e.getIndexedEvents("liveChatChatId")),f=tr(e,r),m=qa(f)?"emoji":"message";e.setDefaultView("Chat","timeline"),Oi(e),xi(e),Wa(e,"liveChatChatId",{id:p,type:m,author:n,seen:!0,properties:Object(C.a)({text:f,originalText:r,invitation:!0,receivedFirstTime:a},o)}),e.updateChat("liveChatChatId",{properties:{fakeAgentMessageId:p}}),e.setApplicationState({hidden:!1}),u||e.setCurrentView("Chat"),d&&Xa(e)},pi=function(e){fi(e,Object(C.a)({},e.getView("Chat/offline"),{id:"offline_form",type:"offline"}))},fi=function(e,t){var n={formType:t.type,formId:t.id,fields:t.fields};if(qn(e)){var r=e.getLastEvent("liveChatChatId").id;return e.updateEvent("liveChatChatId",r,{properties:n})}var a=Object(x.t)(e.getIndexedEvents("liveChatChatId"));return Wa(e,"liveChatChatId",{id:a,type:"form",author:"system",properties:n})},mi=function(e){return!!e&&function(e){var t=Object(I.f)(e);return!t||"https:"===t||!1}(Object(Pa.a)(e))},hi=function(e,t){mi(t.url)?e.updateView("Moment",{show:!0,data:t}):function(e,t,n){var r=n.systemMessageType,a=n.textVariables,i=n.text;Wa(e,t,{id:Object(x.t)(e.getIndexedEvents("liveChatChatId")),serverId:null,type:"system_message",author:"system",seen:!0,properties:Object(x.d)({systemMessageType:r,textVariables:a,defaultText:i})})}(e,"liveChatChatId",{text:"Link attached to the button is invalid."})},vi=function(e){var t=ln("boosters",e);t.enabled&&(e.hasEvent("liveChatChatId","boosters")||e.addEvent("liveChatChatId",{type:"boosters",id:"boosters",author:"system",seen:!0,properties:{boosters:t.items}}))},gi=function(e){e.updateView("Moment",{show:!1,data:{}})},bi=function(e,t){e.requestUpdateUser(e.getSessionUser().id,t)},yi=function(e,t){var n;e.setUserServerId(e.getSessionUser().id,t),e.setApplicationState({testGroup:(n=t,function(e){var t=0;return e.split("").forEach((function(e){var n=e.charCodeAt(0);t=(t<<5)-t+n,t&=t})),t}(n)%2?"A":"B")})},ji=function(e,t){if(void 0===t&&(t=void 0),qn(e,t)){var n=e.getLastEvent("liveChatChatId").id;e.removeEvent("liveChatChatId",n)}},Oi=function(e){ji(e,"prechat")},xi=function(e){ji(e,"offline")},_i=function(e){e.hasEvent("liveChatChatId","queue_information")&&e.removeEvent("liveChatChatId","queue_information")},Ci=function(e){e.hasEvent("liveChatChatId","offline_information")&&e.removeEvent("liveChatChatId","offline_information")},wi=function(e,t,n){if(e&&e.errors){var r=e.errors[0];if("incorrect requester structure"===Object.keys(r)[0]){var a=r["incorrect requester structure"].reduce((function(e,n){return/name must be at most \d+ characters long/.test(n)?Object(C.a)({},e,{name:n}):"mail must be a valid e-mail address"===n?Object(C.a)({},e,{email:t("invalid_email")}):e}),{});Object.keys(a).length>0?n(a):n()}else n()}else n()},Ei=function(e){var t=e.getView("Chat/queue"),n=t.numberInQueue,r=t.waitingTime;_i(e),e.addEvent("liveChatChatId",{serverId:null,seen:!0,author:"system",id:"queue_information",type:"queue_information",properties:{numberInQueue:n,waitingTime:r}})},Ii=function(e){Ci(e),e.addEvent("liveChatChatId",{serverId:null,seen:!0,author:"system",id:"offline_information",type:"offline_information"})};function Si(e){var t=function(t,n){return(e.getApplicationState("hidden")?n.call("show").then((function(){e.setApplicationState({hidden:!1})})):Promise.resolve()).then((function(){t!==e.getApplicationState("maximized")&&e.setApplicationState({maximized:t})}))};return{hide:function(){e.getApplicationState("hidden")||t(!1,this).then((function(){e.setApplicationState({hidden:!0})}))},hideEyeCatcher:function(){Qa(e)},isFocused:function(){return!!document.hasFocus&&document.hasFocus()},maximize:function(){t(!0,this)},minimize:function(){t(!1,this),e.getView("minimized").hidden&&e.updateView("minimized",{hidden:!1})},startStateSync:function(){e.startStateSync(this)},storeMethod:function(t){var n=t[0],r=t.slice(1);e[n].apply(e,r)}}}var ki,Ti,Ai=n(28),Pi=function(e){return/px$/.test(e)?Math.ceil(parseFloat(e))+"px":e},Ni=function(e,t){return e.call("resize",function(e){return Object(C.a)({},e,{width:Pi(e.width),height:Pi(e.height)})}(t))},Mi=function(e){var t=e.minimizedRef;return t?Object(Ai.b)(["width","height"],t):{width:"0px",height:"0px"}},zi=function(e){var t=!1,n=null,r=function e(){if(n&&!t){var r=n;return n=null,t=!0,void r().then((function(){t=!1,e()}))}};return function(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];n=e.bind.apply(e,[null].concat(a)),r()}}((function(e,t){var n=t.getApplicationState().maximized,r=ki,a=e.model,i=a.fullWidth,o=a.fullHeight;return ki=n,new Promise((function(a){r&&n?a():!r||n?r||!n?e.minimizedRef?Ni(e,{width:i,height:o,maximized:n}).then((function(){var t=Mi(e);return Ni(e,t)})).then(a):Ni(e,{width:"0px",height:"0px",maximized:n}).then(a):Ni(e,{width:i,height:o,maximized:n}).then(a):t.once("animation_end",(function(){Ni(e,Object(C.a)({},Mi(e),{maximized:n})).then(a)}))}))})),Ri=function(e,t){ki=t.getApplicationState().maximized,Pr()(ea(t,(function(e){return e.application.maximized})),_r()((function(){return zi(e,t)})))},Di=function(e){var t=e.license,n=e.group;return t+(e.uniqueGroups?":"+n:"")+":state"},Li=function(e){return Object(x.z)(e.lang,["ar","he","fa"])},Bi=function(e){document.documentElement.lang=e.lang},qi=function(e){return Re(e,"hidden")||ne(e,"minimized").hidden&&!Re(e,"maximized")},Ui=n(61),Fi=n(18),Vi=n(13),Gi={LICENSE:"license",GROUP:"group",SESSION_ID:"sessionId",SECURED_TOKEN:"securedToken",CHAT_ID:"chatId",CHAT_STATE:"chatState",CHAT_STATUS:"chatStatus",VISITOR_ID:"visitorId",CUSTOM_VISITOR_ID:"customVisitorId",LAST_MESSAGE_ID:"lastMessageId",CONNECTION_STATUS:"connectionStatus",SNEAK_PEEK:"sneakPeek",TICKET_FORM:"ticketForm",PRE_CHAT_FORM:"preChatForm",POST_CHAT_FORM:"postChatForm",STATIC_CONFIG_VERSION:"staticConfigVersion",TRANSLATIONS_VERSION:"translationsVersion",TRANSLATIONS:"translations",SECRET_ID:"secretId",REGION:"region",CONFIG_LOADED:"configLoaded",LAST_AGENT_ID:"lastAgentId",DYNAMIC_CONFIG:"dynamicConfig",CONFIG:"config",WELCOME_MESSAGE:"welcomeMessage",ACCEPTED_INVITATION:"acceptedInvitation",SERVER_IDS_MAP:"serverIdsMap",VISITOR_CUSTOM_ID_MAP:"visitorCustomIdMap",CLIENT_LIMIT_EXCEEDED:"clientLimitExceeded",PING_SENT:"pingSent",CHAT_BETWEEN_GROUPS:"chatBetweenGroups",HISTORY_LOADED:"historyLoaded",REQUEST_DISTRIBUTION:"requestDistribution",MOBILE:"mobile"},Hi=Object(Vi.a)({},W(Gi.LICENSE),W(Gi.GROUP),W(Gi.SESSION_ID),W(Gi.SECURED_TOKEN),W(Gi.CHAT_ID),W(Gi.CHAT_STATE),W(Gi.VISITOR_ID),W(Gi.CUSTOM_VISITOR_ID),W(Gi.LAST_MESSAGE_ID),W(Gi.CHAT_STATUS),W(Gi.CONNECTION_STATUS),W(Gi.SNEAK_PEEK),W(Gi.TICKET_FORM),W(Gi.STATIC_CONFIG_VERSION),W(Gi.SECRET_ID),W(Gi.REGION),W(Gi.CONFIG_LOADED),W(Gi.LAST_AGENT_ID),W(Gi.PRE_CHAT_FORM),W(Gi.TRANSLATIONS_VERSION),W(Gi.TRANSLATIONS),W(Gi.POST_CHAT_FORM),W(Gi.CONFIG),W(Gi.DYNAMIC_CONFIG),W(Gi.WELCOME_MESSAGE),W(Gi.ACCEPTED_INVITATION),W(Gi.SERVER_IDS_MAP),W(Gi.VISITOR_CUSTOM_ID_MAP),W(Gi.CLIENT_LIMIT_EXCEEDED),W(Gi.PING_SENT),W(Gi.CHAT_BETWEEN_GROUPS),W(Gi.HISTORY_LOADED),W(Gi.REQUEST_DISTRIBUTION),W(Gi.MOBILE)),Wi=L("CHAT_STARTED",(function(e){return{securedToken:e.securedToken,welcomeMessage:e.welcomeMessage,visitorMessage:e.visitorMessage}})),Yi=L("NEW_MESSAGE",(function(e){return{id:e.id,timestamp:e.timestamp,authorType:e.authorType,authorId:e.authorId,text:e.text,chatId:e.chatId,isMobile:e.isMobile,customId:e.customId,serverId:e.serverId,json:e.json}})),Ji=L("CHAT_ENDED",(function(e){return{reason:(void 0===e?{}:e).reason}})),Ki=L("NEW_AGENT",(function(e){var t=e.avatarUrl,n=e.jobTitle,r=e.name,a=e.id,i=e.fromInvitation,o=void 0!==i&&i,c=e.trigger;return{avatarUrl:t,jobTitle:n,name:r,id:a,fromInvitation:o,trigger:void 0===c?null:c}})),Qi=L("VISITOR_DATA_SET",(function(e){return{visitorData:e.visitorData,requestId:e.requestId}})),Zi=L("VISITOR_DATA_SET_ERROR",(function(e){return{error:e.error,requestId:e.requestId}})),Xi=L("NEW_FILE",(function(e){var t=e.id,n=e.timestamp,r=e.authorType,a=e.authorId,i=e.url,o=e.contentType;return{id:t,timestamp:n,authorType:r,authorId:a,url:i,size:e.size,contentType:o,attachmentToken:e.attachmentToken,thumbnail:e.thumbnail}})),$i=L("VISITOR_QUEUED",(function(e){return{numberInQueue:e.numberInQueue,waitingTime:e.waitingTime}})),eo=L("TYPING_INDICATOR",(function(e){return{authorId:e.authorId,isTyping:e.isTyping}})),to=L("RATE_CHAT",(function(e){return{rate:e.rate,comment:e.comment}})),no=L("SET_VISITOR_DATA",(function(e){var t=e.visitorData,n=e.requestId,r=e.internal;return{visitorData:t,requestId:n,internal:void 0!==r&&r}})),ro=L("SEND_FILE",(function(e){return{file:e.file,customId:e.customId}})),ao=L("REQUEST_FILE_TOKEN",(function(e){return{customId:e.customId}})),io=L("FILE_TOKEN_RECEIVED",(function(e){return{customId:e.customId,token:e.token}})),oo=L("NEW_INVITATION",(function(e){return{id:e.id,authorId:e.authorId,text:e.text,receivedFirstTime:e.receivedFirstTime}})),co=L("MESSAGE_SEEN",(function(e){return{id:e.id,customId:e.customId,type:e.type}})),so=L("PROTOCOL_UPGRADED",(function(){})),uo=L("INTEGRATION_DATA",(function(e){return{id:e.id,timestamp:e.timestamp,integrationName:e.integrationName,data:e.data}})),lo=Object(x.e)(x.O,(function(e){return e.map(G)}),x.rb)(Gi),po=Object(x.e)(x.O,(function(e){return e.map(H)}),x.rb)(Gi),fo=function(e){return e.environment},mo=((Ti={})[no.getActionName()]=function(e,t){return Object(Vi.a)({},e,{visitorData:t.visitorData})},Ti),ho=function(e){return e.visitorData},vo=F({},Object(Vi.a)({},mo,lo)),go=n(23),bo=function(e,t){var n=t.external,r=Object(go.c)({context:{external:n}}),a=x.y,i=Object(z.d)(vo,e,a(Object(z.a)(r)));return i.runSaga=r.run,i},yo=n(6),jo=n.n(yo),Oo=n(3),xo=L("PUBLIC_SEND_MESSAGE",(function(e){var t=e.customId,n=e.text,r=e.json,a=e.promise;return{customId:String(t),text:n,json:r,promise:a}})),_o=(L("PUBLIC_INIT",(function(e){return{license:e.license,group:e.group}})),L("PUBLIC_SET_VISITOR_DATA",(function(e){var t=e.name,n=e.email,r=e.pageUrl,a=e.pageTitle,i=e.customProperties,o=e.promise,c=e.update;return{name:t,email:n,customProperties:i,pageUrl:r,pageTitle:a,promise:o,update:void 0===c||c}}))),Co=L("GET_VISITOR_DATA",(function(e){return{promise:e.promise}})),wo=(L("PUBLIC_CALLBACK_ERROR",(function(e){return{errorMessage:e.errorMessage}})),L("PUBLIC_RATE_CHAT",(function(e){return{rate:e.rate,comment:e.comment,promise:e.promise}}))),Eo=L("PUBLIC_SET_SNEAK_PEEK",(function(e){return{text:e.text,promise:e.promise}})),Io=L("PUBLIC_FORWARD_CHAT_TRANSCRIPT",(function(e){return{email:e.email,promise:e.promise}})),So=L("PUBLIC_CLOSE_CHAT",(function(e){return{promise:e.promise}})),ko=L("PUBLIC_DISCONNECT",(function(e){return{promise:e.promise}})),To=L("PUBLIC_GET_TICKET_FORM",(function(e){return{promise:e.promise,group:e.group}})),Ao=L("PUBLIC_SEND_TICKET_FORM",(function(e){return{answers:e.answers,promise:e.promise}})),Po=L("PUBLIC_SEND_FILE",(function(e){return{file:e.file,customId:e.customId,promise:e.promise,onProgress:e.onProgress}})),No=L("PUBLIC_SEND_FILE",(function(e){return{customId:e.customId}})),Mo=L("PUBLIC_GET_PRECHAT_FORM",(function(e){return{promise:e.promise}})),zo=L("PUBLIC_SEND_PRECHAT_FORM",(function(e){return{promise:e.promise,answers:e.answers}})),Ro=L("PUBLIC_GET_TRANSLATIONS",(function(e){return{promise:e.promise}})),Do=L("PUBLIC_GET_PREDICTED_AGENT",(function(e){return{promise:e.promise}})),Lo=L("PUBLIC_GET_POSTCHAT_FORM",(function(e){return{promise:e.promise}})),Bo=L("PUBLIC_SEND_POSTCHAT_FORM",(function(e){return{promise:e.promise,answers:e.answers}})),qo=L("PUBLIC_GET_CONFIG",(function(e){return{promise:e.promise}})),Uo=L("PUBLIC_ACCEPT_INVITATION",(function(e){return{promise:e.promise,id:e.id}})),Fo=L("PUBLIC_MESSAGE_AS_SEEN",(function(e){return{promise:e.promise,messageId:e.messageId}})),Vo=L("PUBLIC_START_CHAT",(function(e){return{promise:e.promise}})),Go=L("PUBLIC_CHECK_GROUP_STATUS",(function(e){return{group:e.group,promise:e.promise}})),Ho=L("PUBLIC_SET_VISITOR_GROUP",(function(e){return{group:e.group}})),Wo=L("PUBLIC_GET_QUEUE_FORM",(function(e){return{promise:e.promise}})),Yo=n(49),Jo=n.n(Yo),Ko=n(117),Qo=n.n(Ko),Zo=Jo.a.mark(Xo);function Xo(e){var t,n,r,a,i=arguments;return Jo.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:for(t=i.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=i[r];case 1:return o.next=3,Oo.j.apply(void 0,[e].concat(n));case 3:if("undefined"===typeof(a=o.sent)){o.next=6;break}return o.abrupt("return",a);case 6:return o.next=8,Object(Oo.l)("*");case 8:o.next=1;break;case 9:case"end":return o.stop()}}),Zo)}var $o=function(e){return Object(Oo.e)(Jo.a.mark((function t(){return Jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e;case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))},ec="",tc=Object(ya.b)()?window.localStorage:ya.a,nc={setItem:function(e,t){tc.setItem(ec+e,t)},getItem:function(e){return tc.getItem(ec+e)},removeItem:function(e){tc.removeItem(ec+e)},setPrefix:function(e){ec=e},removeOldSecretTokenCookie:function(e){document.cookie="secret_token_"+e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/licence/"+e+"/v2;domain=.livechatinc.com",document.cookie="secret_token_"+e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/licence/"+e+";domain=.livechatinc.com"}};function rc(e){return-1!==e.indexOf("cdn.livechatinc.com/cloud/?uri")?"https://"+Object(I.j)(e):"https://cdn.livechatinc.com/cloud/?uri=http://"+encodeURI(Object(I.j)(e))}function ac(e){var t=e.agent;return{invitation:{id:e.unique_id,authorId:t.login,text:e.greeting_message.text,receivedFirstTime:e.displayed_first_time},agent:{avatarUrl:rc(t.avatar_url),jobTitle:t.job_title,name:t.name,id:t.login}}}var ic=n(125),oc=n.n(ic),cc=function(e){function t(){return e.apply(this,arguments)||this}Object(Xt.a)(t,e);var n=t.prototype;return n.listitem=function(e){return""+pc+e},n.list=function(e,t,n){var r=n;return e.replace(pc,(function(){return t?r+++". ":"- "}))},t}(ic.Renderer),sc=new DOMParser,uc=Array.prototype.map,lc=["A","UL","OL","LI","STRONG","EM","BR"],dc=new cc,pc="%list-item%",fc=function(e){return e.replace(/\n+$/,"")};function mc(e){var t=oc()(e,{renderer:dc}),n=sc.parseFromString(t,"text/html").body;return n?fc(n.textContent||""):""}var hc,vc,gc=function(e){var t=e.template,n=e.root,r=e.preserveLists,a=n?n.props:{},i=n?n.component:Zt.Fragment,o=Zt.useMemo((function(){var e=fc(oc()(t,r?{renderer:dc}:{})),n=sc.parseFromString(e,"text/html").body;return n?function e(t){return uc.call(t,(function(t,n){var r={key:n};return"#text"===t.nodeName?t.textContent:Object(x.z)(t.nodeName,lc)?("A"===t.nodeName&&t.hasAttribute("href")&&(r.href=t.getAttribute("href"),r.target="_blank",r.rel="nofollow noopener"),Zt.createElement(t.nodeName.toLowerCase(),Object(M.a)({},r,t.hasChildNodes()&&{children:e(t.childNodes)}))):t.hasChildNodes()?e(t.childNodes):null}))}(n.childNodes):""}),[t,r]);return Zt.createElement(i,a,o)},bc=function(e,t){return e.order-t.order},yc={question:{type:"text"},checkbox_for_email:{type:"checkbox",meta:"confirm_subscription"},header:{type:"information"},skill:{type:"group_select"}},jc=function(e){return e.map((function(e,t){var n={};return Object(x.x)("label",e)&&(n.label=e.label),Object(x.x)("checked",e)&&(n.checked=e.checked),n.value=String(t),Object(x.x)("skill_id",e)&&(n.value=String(e.skill_id)),Object(x.x)("embedded_chat_hide_when_offline",e)&&(n.ticketFormDisabled=Boolean(e.embedded_chat_hide_when_offline)),Object(x.x)("queue_template",e)&&(n.queueTemplate=e.queue_template),n}))},Oc=function(e){var t=!1,n={fields:e.fields.sort(bc).map((function(e,n){var r={};if("facebookConnect"===e.type)return t=!0,!1;e.id?r.name=e.id:-1===["header","information"].indexOf(e.type)&&(r.name=String(n)),Object(x.x)("value",e)&&(r.value=e.value),Object(x.x)("label",e)&&(r.label=e.label),Object(x.x)("required",e)&&(r.required=e.required),"rating"===e.type&&(r.commentLabel=e.options[0]),e.skills&&e.skills.length>0?r.options=jc(e.skills):e.options&&e.options.length>0&&(e.options_data?r.options=jc(e.options_data):Object(x.D)(e.options[0])?r.options=e.options.map((function(e,t){return{label:e.label,value:String(t)}})):r.options=e.options.map((function(e,t){return{label:e,value:String(t)}}))),e.serverType&&(r.serverType=e.serverType);var a=function(e){return{type:yc[e]&&yc[e].type||e,meta:yc[e]&&yc[e].meta||!1}}(e.type),i=a.type,o=a.meta;return r.type=i,o&&(r.meta=o),r})).filter(Boolean)};return e.id&&(n.id=e.id),t&&(n.facebookConnect=!0),n},xc=function(e){return Object(Vi.a)({},e,{fields:e.fields.map((function(e){switch(e.type){case"name":case"subject":return Object(Vi.a)({},e,{maxLength:1024});case"email":case"textarea":return Object(Vi.a)({},e,{required:!0});default:return e}}))})},_c=function(e,t,n){var r={survey_id:t.id},a=["name","question","email","checkbox","checkbox_for_email","radio","skill","select","textarea"],i=t.fields.map((function(r,a){var i,o,c={id:r.name,order:t.facebookConnect?a+1:a,type:(i=r.type,o=r.meta,void 0===o&&(o=!1),Object(x.m)((function(e){var t=e.type,n=e.meta;return t===i&&(!n||o===n)}),yc)||i)};return"checkbox_for_email"===c.type?c.label="":Object(x.x)("label",r)&&(c.label=mc(r.label)),Object(x.x)("options",r)?c.answers=r.options.map((function(t,a){var i={index:a};return Object(x.x)("label",t)&&(i.label=t.label),"skill"===c.type&&(i.group_id=parseInt(t.value,10)),"group_select"===r.type?i.chosen=parseInt(n,10)===a:i.chosen=e[r.name]&&(Array.isArray(e[r.name])&&-1!==e[r.name].indexOf(t.value)||"string"===typeof e[r.name]&&e[r.name]===t.value)||!1,i})):c.answer=e[r.name]||"",c})).filter((function(e){return-1!==a.indexOf(e.type)}));return r.fields=i,r},Cc=function(e,t,n){void 0===n&&(n={});var r=new XMLHttpRequest,a=new Promise((function(a,i){var o=n,c=o.headers,s=o.method,u=void 0===s?"POST":s,l=o.onProgress,d=o.withCredentials,p=void 0!==d&&d;"function"===typeof l&&(r.upload.onprogress=function(e){l(e.loaded/e.total)}),r.onload=function(){var e;try{e=JSON.parse(r.response)}catch(t){e=r.response}if(r.status>=200&&r.status<300)a(e);else{var t=new Error("Upload failed.");t.code="UPLOAD_FAILED",t.response=e,i(t)}},r.onerror=function(){var e=new Error("Upload failed.");e.code="UPLOAD_FAILED",i(e)},r.onabort=function(){var e=new Error("Upload canceled.");e.code="UPLOAD_CANCELED",i(e)},r.open(u,e),r.withCredentials=p,c&&Object.keys(c).forEach((function(e){return r.setRequestHeader(e,c[e])})),r.send(function(e){var t=new FormData;return Object.keys(e).forEach((function(n){return t.append(n,e[n])})),t}(t))}));return{then:function(e,t){return a.then(e,t)},catch:function(e){return a.catch(e)},cancel:function(){r.abort()}}},wc=((hc={}).labs="-labs.",hc.staging="-lc.",hc.production=".",hc),Ec=((vc={}).labs="labs.",vc.staging="staging.",vc.production="",vc),Ic=function(e,t,n){var r=t;return 1520===n&&(r="staging"),"https://secure"+(e?"-"+e:"")+wc[r]+"livechatinc.com"},Sc=function(e,t,n){var r=t;return 1520===n&&(r="staging"),"https://api"+(e?"-"+e:"")+"."+Ec[r]+"livechatinc.com"},kc=function(e,t,n){void 0===n&&(n={});var r=n.attempts||3,a=n.retryDelay||1e3;return new Promise((function(n,i){!function o(){var c;Object(E.a)(e,t).then((function(e){if(400!==e.status){if(!e.ok)throw new Error({type:"connection",reason:"Request failed"});n(e)}else e.json().then(i).catch(i)})).catch((function(e){return r?(--r,setTimeout((function(){o()}),a)):i(e)})),(c=15e3,new Promise((function(e){setTimeout(e,c)}))).then((function(){i({type:"connection",reason:"Request timeout"})}))}()}))},Tc=function(e){var t=e.environment,n=e.region,r=e.license,a=e.token,i=e.file,o=e.chatId,c=e.onProgress,s=Sc(n,t,r)+"/v2/chats/"+o+"/attachment",u=Cc(s,{"author[type]":"visitor",license_id:r,files:i,token:a},{onProgress:c});return u[go.a]=u.cancel,u},Ac=function(e,t,n){var r=t.environment,a=t.region,i=t.license,o=t.body,c=Sc(a,r,i)+"/"+e;return kc(c,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)},n).then((function(e){return e.json()}))},Pc=function(e,t){var n=t.environment,r=t.license,a=t.region,i=""+Ic(a,n,r)+e;return kc(i,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))},Nc=function(e,t,n,r){return!1===t?"licence/g"+e+"_"+r:n?"licence/external/"+e:"licence/"+e},Mc=function(e,t,n){var r=t.environment,a=t.license,i=t.body,o=void 0===i?{}:i,c=t.securedToken,s=t.secretId,u=t.region,l=t.queryStringData,d=void 0===l?{}:l,p=t.external,f=t.chatBetweenGroups,m=t.group,h=t.requestDistribution,v=!0===Object(x.u)(e,h)||-1!==e.indexOf("get_static_config")?"v2/":"",g={};c&&(g.secret_token=c),s&&(g.secret_id=s);var b=Ic(u,r,a)+"/"+Nc(a,f,p,m)+"/"+v+e+"?"+Object(I.a)(Object(Vi.a)({},d,g));return kc(b,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)},n).then((function(e){return e.text()})).then((function(e){return JSON.parse(e.replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g,""))}))},zc=function(e,t){var n=t.environment,r=t.license,a=t.securedToken,i=t.secretId,o=t.region,c=t.external,s=t.group,u=t.chatBetweenGroups,l=Ic(o,n,r)+"/"+Nc(r,u,c,s)+"/tunnel_callback.cgi?"+function(e){for(var t="",n="0123456789abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ",r=0;r<e;r++)t+=n.substr(Math.floor(Math.random()*n.length),1);return t}(20);return a&&(l+="&secret_token="+a),i&&(l+="&secret_id="+i),l+="&command="+encodeURIComponent(e),kc(l,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then((function(e){return e.text()})).then((function(e){return e.split("^")}))},Rc=jo.a.mark(Lc),Dc=jo.a.mark(Bc);function Lc(e,t){var n,r,a,i,o;return jo.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(Oo.j)(po.getPropertyChatBetweenGroups);case 2:return n=c.sent,c.next=5,Object(Oo.j)(po.getPropertyGroup);case 5:return r=c.sent,"get_dynamic_config.js",c.t0=Oo.c,c.t1=Mc,c.t2="get_dynamic_config.js",c.t3=Vi.a,c.t4={},c.t5=e,c.t6=t,c.next=16,Object(Oo.f)("external");case 16:return c.t7=c.sent,c.t8={queryStringData:c.t6,external:c.t7},c.t9=(0,c.t3)(c.t4,c.t5,c.t8),c.next=21,(0,c.t0)(c.t1,c.t2,c.t9);case 21:if(!(a=c.sent).error||"incorrect region"!==a.error){c.next=40;break}return c.next=25,Object(Oo.h)(Hi.setPropertyRegion(a.region));case 25:return c.t10=Oo.c,c.t11=Lc,c.t12=Vi.a,c.t13={},c.t14=e,c.t15=a.region,c.next=33,Object(Oo.f)("external");case 33:return c.t16=c.sent,c.t17={region:c.t15,external:c.t16},c.t18=(0,c.t12)(c.t13,c.t14,c.t17),c.next=38,(0,c.t10)(c.t11,c.t18);case 38:return i=c.sent,c.abrupt("return",i);case 40:if(!1!==n||a.visitor.groups===r){c.next=57;break}return c.next=43,Object(Oo.h)(Hi.setPropertyGroup(a.visitor.groups));case 43:return c.t19=Oo.c,c.t20=Lc,c.t21=Vi.a,c.t22={},c.t23=e,c.next=50,Object(Oo.f)("external");case 50:return c.t24=c.sent,c.t25={external:c.t24},c.t26=(0,c.t21)(c.t22,c.t23,c.t25),c.next=55,(0,c.t19)(c.t20,c.t26);case 55:return o=c.sent,c.abrupt("return",o);case 57:return c.abrupt("return",a);case 58:case"end":return c.stop()}}),Rc)}function Bc(){var e,t,n,r,a,i,o;return jo.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(Oo.j)(po.getPropertyLicense);case 2:return e=c.sent,c.next=5,Object(Oo.j)(po.getPropertyGroup);case 5:return t=c.sent,c.next=8,Object(Oo.j)(fo);case 8:return n=c.sent,c.next=11,Object(Oo.j)(po.getPropertyRegion);case 11:return r=c.sent,c.next=14,Object(Oo.j)(ho);case 14:return a=c.sent,c.next=17,Object(Oo.j)(po.getPropertyChatBetweenGroups);case 17:return i=c.sent,o={},a.pageUrl&&(o.url=a.pageUrl),"undefined"!==typeof t&&(o.groups=t),c.next=23,Object(Oo.c)(Lc,{environment:n,license:e,group:t,region:r,chatBetweenGroups:i},o);case 23:return c.abrupt("return",c.sent);case 24:case"end":return c.stop()}}),Dc)}var qc,Uc=function(e){return"1"===e},Fc=function(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&#94;/g,"^").replace(/&#45;/g,"-").replace(/&amp;/g,"&").replace(/<BR>/g,"\n")},Vc=Fc,Gc=function(e){return JSON.parse(Fc(e))},Hc=((qc={}).none="0",qc.bad="1",qc.good="2",qc),Wc={NEW_AGENT:"newAgent",NEW_AGENT_MESSAGE:"newAgentMessage",CHAT_ENDED:"chatEnded",VISITOR_QUEUED:"visitorQueued",TYPING_INDICATOR:"typingIndicator",RATE_CHAT:"rateChat",FORWARD_CHAT_TRANSCRIPT:"forwardChatTranscript",AGENTS_OFFLINE:"agentsOffline",GET_FORM:"getForm",GET_CUSTOM_FORM:"getCustomForm",JSON:"JSON",INTEGRATION_DATA:"integrationData"},Yc={IWCS5012F:[Wc.AGENTS_OFFLINE,{}],IWCS5011F:[Wc.AGENTS_OFFLINE,{}],IWCS0002R:[Wc.NEW_AGENT,{1:["id"],2:["name",Fc],12:["chatId"],23:["avatarUrl",Fc],25:["jobTitle",Fc]},function(e){return e&&{trigger:e.trigger}}],IWCS0006R:[Wc.NEW_AGENT_MESSAGE,{1:["authorId"],2:["message",Vc],9:["isMobile",Uc],10:["id"],11:["json",function(e){if(!e)return null;try{return Gc(e)}catch(t){return null}}]}],IWCS1007S:[Wc.CHAT_ENDED,null,{reason:"closed"}],IWCS0093R:[Wc.CHAT_ENDED,null,{reason:"inactivity"}],IWCS0003R:[Wc.CHAT_ENDED,null,{reason:"closed_by_agent"}],IWCS1002S:[Wc.VISITOR_QUEUED,{2:["numberInQueue",parseInt],3:["waitingTime",parseInt]}],IWCS0002P:[Wc.TYPING_INDICATOR,{2:["realCommand",function(e){var t=e.split("&#45;");return{authorId:t[1],isTyping:Uc(t[2])}}]}],IWCS0113C:[Wc.RATE_CHAT,{1:["visitorId"],2:["chatId"],3:["rate",function(e){return Object(x.k)((function(t){return Hc[t]===e}),Object.keys(Hc))},function(e){return Hc[e]}]}],IWCS0069C:[Wc.FORWARD_CHAT_TRANSCRIPT,{1:["visitorId"],2:["email"],5:["chatId"]}],IWCS0121C:[Wc.GET_FORM,{1:["type",null,function(){return"1"}],2:["license"],4:["group"]}],IWCS0122C:[Wc.GET_CUSTOM_FORM,{1:["license"],2:["type"],3:["group"]}],IWCSJSON:[Wc.JSON,{1:["json",Gc]}],IWCS0109R:[Wc.INTEGRATION_DATA,{1:["integrationName"],2:["data",Gc]}]},Jc=function(e,t){var n=e.split("^"),r=n[0],a=n.slice(1),i=Yc[r];if(!i)return null;var o=i[0],c=i[1],s=i[2],u=a.reduce((function(e,t,n){if(!c||!c[n+1])return e;var r=c[n+1],a=r[0],i=r[1],o=void 0===i?x.y:i;return"realCommand"===a?Object(Vi.a)({},e,o(t)):(e[a]=o(t),e)}),{});return{name:o,data:Object(Vi.a)({},u,"function"===typeof s?s(t):s)}},Kc=function(e,t){for(var n,r=Object(x.m)((function(t){return t[0]===e}),Yc),a=Yc[r][1],i=Math.max.apply(Math,Object.keys(a)),o=[r];o.length<i+1;){var c=a[o.length];if(c){var s=c[0],u=(n=String(t[s]),n.replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"")).replace(/\^/g,"&#94;");c[2]?o.push(c[2](u)):o.push(u)}else o.push("")}return o.join("^")+"^"},Qc=jo.a.mark(ts),Zc=jo.a.mark(ns),Xc=jo.a.mark(rs),$c=jo.a.mark(as),es=jo.a.mark(is);function ts(){var e;return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.b)({license:Object(Oo.j)(po.getPropertyLicense),securedToken:Object(Oo.j)(po.getPropertySecuredToken),secretId:Object(Oo.j)(po.getPropertySecretId),environment:Object(Oo.j)(fo),region:Object(Oo.j)(po.getPropertyRegion),external:Object(Oo.f)("external"),group:Object(Oo.j)(po.getPropertyGroup),chatBetweenGroups:Object(Oo.j)(po.getPropertyChatBetweenGroups),requestDistribution:Object(Oo.j)(po.getPropertyRequestDistribution)});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),Qc)}function ns(e,t,n){var r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return void 0===n&&(n={}),a.next=3,Object(Oo.c)(ts);case 3:return r=a.sent,a.next=6,Object(Oo.c)(Mc,e,Object(Vi.a)({},r,{body:t}),n);case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}}),Zc)}function rs(e){var t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(Oo.c)(ts);case 2:return t=r.sent,r.next=5,Object(Oo.c)(Pc,e,t);case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),Xc)}function as(e,t){var n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=Kc(e,t),a.next=3,Object(Oo.c)(ts);case 3:return r=a.sent,a.next=6,Object(Oo.c)(zc,n,r);case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}}),$c)}function is(e,t){var n,r,a,i;return jo.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(Oo.c)(ts);case 2:return n=o.sent,r=n.license,a=n.environment,i=n.region,o.next=6,Object(Oo.c)(Ac,e,{environment:a,region:i,license:r,body:t});case 6:return o.abrupt("return",o.sent);case 7:case"end":return o.stop()}}),es)}var os=jo.a.mark(cs);function cs(e,t){var n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n={},r.next=3,Object(Oo.c)(ns,"get_static_config."+e+"."+t+".js",n);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),os)}var ss=jo.a.mark(bs),us=jo.a.mark(Os),ls=jo.a.mark(xs),ds=jo.a.mark(_s),ps=jo.a.mark(Cs),fs=jo.a.mark(ws),ms=jo.a.mark(Es),hs=jo.a.mark(Is),vs=function(e){var t={};try{t=JSON.parse(e)}catch(n){}return t},gs=function(e){var t,n,r=e.license_properties,a=e.group_properties,i="1"===a.chat_window.custom_mobile_settings,o="1"===r.non_profit,c="3"===r.lc_version,s=c&&"1"===r.continuous_chat_widget_enabled,u={nonProfitLicense:o,visitorData:Object(x.I)(x.b,e.visitor),features:{fileSharing:{enabled:e.attachments.enable_for_visitors},agentAvatar:{enabled:e.chat_window.display_avatar,showWithMessage:e.chat_window.display_avatar&&"modern"!==Object(x.u)("group_properties.chat_window.new_theme.name",e)},continuousChat:{enabled:s},chatHistory:{enabled:s||c&&"1"===r.customer_history_enabled},rating:{enabled:e.chat_window.display_rating,position:"modern"===Object(x.u)("group_properties.chat_window.new_theme.name",e)?"bottom":"right"},emailTranscript:{enabled:e.chat_window.display_transcript_button},logo:{enabled:e.chat_window.logo.display,path:rc(e.chat_window.logo.path)},facebookButton:{enabled:Boolean(e.chat_window.social.facebook)},twitterButton:{enabled:Boolean(e.chat_window.social.twitter)},googlePlusButton:{enabled:Boolean(e.chat_window.social.plusone)},offlineForm:{enabled:!e.embedded_chat.hide_when_offline},linksPreview:{enabled:"1"===a.links_unfurling},preChatForm:{enabled:e.pre_chat_survey&&e.pre_chat_survey.enabled||!1},preChatAfterGreeting:{enabled:"1"===a.pre_chat_survey_after_greeting},creditCardMasking:{enabled:e.mask_credit_cards},hideTrademark:{enabled:"1"===a.chat_window.hide_trademark},hideOnMobile:{enabled:"1"===a.chat_window.hide_on_mobile},hideOnInit:{enabled:"1"===a.chat_window.hide_on_init},disableSounds:{enabled:"1"===a.chat_window.disable_sounds},minimized:{enabled:"0"===a.chat_window.disable_minimized},mobileMinimized:{enabled:i?"0"===a.chat_window.mobile_disable_minimized:"0"===a.chat_window.disable_minimized}},buttons:e.buttons.map((function(e){return{id:e.id,type:e.type,onlineImage:rc(e.online_value),offlineImage:rc(e.offline_value)}})),theme:{color:e.chat_window.theme.color,name:e.chat_window.theme.name,minimized:a.chat_window.theme.minimized,mobileMinimized:i?a.chat_window.mobile_minimized_theme:a.chat_window.theme.minimized},newTheme:{name:a.chat_window.new_theme.name,iconTheme:"modern"===a.chat_window.new_theme.name?"modern":"smooth",agentMessageBackgroundColor:Object(x.v)("#fffff","group_properties.chat_window.new_theme.agent_message_color_background",e),agentMessageColorText:Object(x.v)("#424d57","group_properties.chat_window.new_theme.agent_message_color_text",e),backgroundColor:Object(x.v)("#e9eef4","group_properties.chat_window.new_theme.background_color",e).toLowerCase(),minimizedColorBackground:Object(x.v)("#ffffff","group_properties.chat_window.new_theme.minimized_color_background",e),minimizedColorIcon:Object(x.v)("#4384F5","group_properties.chat_window.new_theme.minimized_color_icon",e),minimizedColorText:Object(x.v)("#000000","group_properties.chat_window.new_theme.minimized_color_text",e),visitorMessageBackgroundColor:Object(x.v)("#4384f5","group_properties.chat_window.new_theme.visitor_message_color_background",e),visitorMessageColorText:Object(x.v)("#ffffff","group_properties.chat_window.new_theme.visitor_message_color_text",e),titlebarBackgroundColor:Object(x.v)("#ffffff","group_properties.chat_window.new_theme.titlebar_background_color",e),titlebarText:Object(x.v)("#424d57","group_properties.chat_window.new_theme.titlebar_text",e),systemMessageColor:Object(x.v)("#424d57","group_properties.chat_window.new_theme.system_message_color",e),agentbarBackgroundColor:Object(x.v)("#ffffff","group_properties.chat_window.new_theme.agentbar_background_color",e),agentbarText:Object(x.v)("#424d57","group_properties.chat_window.new_theme.agentbar_text",e),ctaColor:Object(x.v)("#427fe1","group_properties.chat_window.new_theme.cta_color",e),customJson:vs(Object(x.u)("group_properties.chat_window.new_theme.custom_json",e))},domainWhitelist:e.domain_whitelist,widgetType:e.embedded_chat.enabled?"embedded":"popup",integrations:e.integrations,language:e.lang,groups:(t=e.skills,n=e.skills_online,Object(x.F)("id",t.map((function(e){return{id:e.id,status:-1!==n.indexOf(e.id)?"online":"offline",oldButtons:{onlineImage:rc(e.chat_button.online_url),offlineImage:rc(e.chat_button.offline_url)}}})))),clientLimitExceeded:e.client_limit_exceeded,screenPosition:a.chat_window.screen_position,mobileScreenPosition:i?a.chat_window.mobile_screen_position:a.chat_window.screen_position};return u.features.facebookButton.enabled&&(u.features.facebookButton.path=e.chat_window.social.facebook),u.features.twitterButton.enabled&&(u.features.facebookButton.path=e.chat_window.social.twitter),u.features.googlePlusButton.enabled&&(u.features.facebookButton.path=e.chat_window.social.plusone),u};function bs(e){var t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Oo.h)(Hi.setPropertyTicketForm(xc(Oc(e.offline_form))));case 2:return a.next=4,Object(Oo.f)("external");case 4:if(t=a.sent,!e.pre_chat_survey){a.next=9;break}return n=Oc(e.pre_chat_survey),a.next=9,Object(Oo.h)(Hi.setPropertyPreChatForm(n));case 9:return r=t?e.localization_url.replace("/licence/","/licence/external/"):e.localization_url,a.next=12,Object(Oo.h)(Hi.setPropertyTranslationsVersion(r));case 12:return a.next=14,Object(Oo.h)(Hi.setPropertyConfigLoaded(!0));case 14:case"end":return a.stop()}}),ss)}var ys={labs:"labs",staging:"staging",production:"prod"},js=function(e,t){var n=t.split(",").map((function(e){return e.split(":")})),r=Object(x.r)(n);return Object(x.J)((function(t){if(!t)return!1;var n=parseFloat(t);return!(n<1&&e)&&n>Math.random()}),r)};function Os(e){var t,n,r,a,i,o,c;return jo.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(Oo.j)(fo);case 2:return t=s.sent,n=ys[t],r=e.global_properties[n].requests_distribution,a=!1===e.t,i=js(a,r),s.next=9,Object(Oo.h)(Hi.setPropertyRequestDistribution(i));case 9:return o=gs(e),s.next=12,Object(Oo.j)(po.getPropertyGroup);case 12:if(c=s.sent,-1===e.skills_online.indexOf(c)){s.next=18;break}return s.next=16,Object(Oo.h)(Hi.setPropertyChatStatus("ONLINE"));case 16:s.next=20;break;case 18:return s.next=20,Object(Oo.h)(Hi.setPropertyChatStatus("OFFLINE"));case 20:return s.next=22,Object(Oo.h)(Hi.setPropertyConfig(o));case 22:case"end":return s.stop()}}),us)}function xs(){var e,t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(Oo.c)(Xo,po.getPropertyStaticConfigVersion);case 2:return e=i.sent,i.next=5,Object(Oo.j)(po.getPropertyGroup);case 5:return t=i.sent,i.next=8,Object(Oo.c)(cs,t,e);case 8:return n=i.sent,i.next=11,Object(Oo.c)(bs,n);case 11:return i.next=13,Object(Oo.j)(po.getPropertyDynamicConfig);case 13:return r=i.sent,a=Object(Vi.a)({},r,n),i.next=17,Object(Oo.c)(Os,a);case 17:case"end":return i.stop()}}),ls)}function _s(){var e,t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(Oo.c)(Xo,po.getPropertyTranslationsVersion);case 2:return e=r.sent,r.next=5,Object(Oo.c)(rs,e+"?acao=true");case 5:return t=r.sent,n=Object(x.I)((function(e){return e.toLowerCase()}),t.localization),r.next=9,Object(Oo.h)(Hi.setPropertyTranslations(n));case 9:case"end":return r.stop()}}),ds)}function Cs(e){var t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(Oo.j)(ho);case 2:return t=i.sent,i.next=5,Object(Oo.j)(po.getPropertyVisitorId);case 5:if(n=i.sent,r=Object(Vi.a)({},t),"undefined"===typeof e.visitor.groups){i.next=10;break}return i.next=10,Object(Oo.h)(Hi.setPropertyGroup(e.visitor.groups));case 10:return i.next=12,Object(Oo.h)(Hi.setPropertyStaticConfigVersion(e.static_config_version));case 12:if((t.name||e.visitor.nick)&&(r.name=t.name||e.visitor.nick),(a=r.customProperties||e.visitor.params&&Object(I.b)(e.visitor.params))&&(r.customProperties=a),!e.visitor.nick&&!e.visitor.params){i.next=18;break}return i.next=18,Object(Oo.h)(no({visitorData:r}));case 18:if(n){i.next=22;break}return i.next=21,Object(Oo.h)(Hi.setPropertyVisitorId(e.visitor.session));case 21:nc.setItem("visitorId",e.visitor.session);case 22:case"end":return i.stop()}}),ps)}function ws(e){var t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Oo.c)(Cs,e);case 2:return a.next=4,Object(Oo.h)(Hi.setPropertyDynamicConfig(e));case 4:return a.next=6,Object(Oo.h)(Hi.setPropertyClientLimitExceeded(e.client_limit_exceeded));case 6:if(!e.automatic_greeting){a.next=12;break}return t=ac(e.automatic_greeting),n=t.agent,r=t.invitation,a.next=10,Object(Oo.h)(Ki(Object(Vi.a)({},n,{fromInvitation:!0})));case 10:return a.next=12,Object(Oo.h)(oo(r));case 12:case"end":return a.stop()}}),fs)}function Es(){var e,t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Oo.c)(Bc);case 2:return e=a.sent,t=e.static_config_version,n=e.visitor.groups,a.next=7,Object(Oo.c)(cs,n,t);case 7:if(r=a.sent,"3"!==r.license_properties.lc_version){a.next=12;break}return a.next=12,Object(Oo.h)(so());case 12:case"end":return a.stop()}}),ms)}function Is(e){var t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=8;break}return n.next=3,Object(Oo.c)(ws,e);case 3:return n.next=5,Object(Oo.c)(bs,e);case 5:return n.next=7,Object(Oo.c)(Os,e);case 7:return n.abrupt("return");case 8:return n.next=10,Object(Oo.c)(Bc);case 10:return t=n.sent,n.next=13,Object(Oo.c)(ws,t);case 13:return n.next=15,Object(Oo.c)(xs);case 15:case"end":return n.stop()}}),hs)}var Ss="CHATTING",ks="NOT_CHATTING",Ts=n(118),As=jo.a.mark(Ps);function Ps(e){var t,n,r,a,i;return jo.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.customId,n=e.text,r=e.json,o.next=3,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 3:return a=o.sent,i={author:"visitor",message:n,message_id:t,random_id:t,visitor:{id:a}},r&&(i.message_json=JSON.stringify(r)),o.next=8,Object(Oo.c)(ns,"send_message",i);case 8:return o.next=10,Object(Oo.h)({type:"PRIVATE_SEND_MESSAGE"});case 10:case"end":return o.stop()}}),As)}var Ns=jo.a.mark(Ms);function Ms(){var e,t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 2:return e=n.sent,t={source:"visitor",random_id:String(Math.random()),visitor:{id:e}},n.next=6,Object(Oo.c)(ns,"close_chat",t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),Ns)}var zs=jo.a.mark(Rs);function Rs(e){var t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 2:return t=a.sent,a.next=5,Object(Oo.j)(po.getPropertyChatId);case 5:return n=a.sent,r={visitorId:t,chatId:n,email:e.payload.email},a.next=9,Object(Oo.c)(as,"forwardChatTranscript",r);case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}}),zs)}var Ds=jo.a.mark(Ls);function Ls(e){var t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 2:return t=a.sent,a.next=5,Object(Oo.j)(po.getPropertyChatId);case 5:return n=a.sent,r={visitorId:t,chatId:n,rate:e.payload.rate},a.next=9,Object(Oo.c)(as,"rateChat",r);case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}}),Ds)}var Bs=jo.a.mark(qs);function qs(e){var t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(Oo.j)(po.getPropertyLicense);case 2:return t=r.sent,n={license:t,type:"offline",group:e},r.next=6,Object(Oo.c)(as,"getCustomForm",n);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),Bs)}var Us=jo.a.mark(Fs);function Fs(){var e,t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(Oo.j)(po.getPropertyLicense);case 2:return e=r.sent,r.next=5,Object(Oo.j)(po.getPropertyGroup);case 5:return t=r.sent,n={license:e,type:"queued",group:t},r.next=9,Object(Oo.c)(as,"getCustomForm",n);case 9:return r.abrupt("return",r.sent);case 10:case"end":return r.stop()}}),Us)}var Vs=jo.a.mark(Gs);function Gs(e){var t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 2:return t=a.sent,a.next=5,Object(Oo.j)(po.getPropertyChatId);case 5:return n=a.sent,r={comment:e.payload.comment,conference_id:n,random_id:String(Math.random()),visitor:{id:t}},a.next=9,Object(Oo.c)(ns,"send_rating_comment",r);case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}}),Vs)}var Hs=jo.a.mark(Js),Ws=function(e,t,n){var r=e.group,a=e.license,i=e.visitorId,o=e.visitorData,c=e.defaultValues,s=function(e,t){var n=Object(x.I)((function(e){return"message"===e?"textarea":e}),e);return t.fields.map((function(e){if("information"===e.type)return null;var t={type:e.type,text:mc(e.label),serverType:e.serverType};return(e.name in n||e.type in n)&&("options"in e?t.value=Object(x.i)(n[e.name]).map((function(t){return Object(x.k)((function(e){return e.value===t}),e.options).label})).join(", "):e.name in n?t.value=n[e.name]:t.value=n[e.type],t.value=Object(x.nb)(t.value),t.text=t.text+" "+t.value),t})).filter(Boolean)}(n,t),u=Object(x.k)((function(e){return"email"===e.type||"email"===e.serverType}),s);if(!u)throw{type:"missing argument",reason:"Missing email"};if(!Object(x.k)((function(e){return"textarea"===e.type}),s))throw{type:"missing argument",reason:"Missing message"};var l=Object(x.k)((function(e){return"name"===e.type||"name"===e.serverType}),s),d=Object(x.k)((function(e){return"subject"===e.type||"subject"===e.serverType}),s),p=s.filter((function(e){var t=e.type,n=e.serverType;return-1===["name","email","subject"].indexOf(n||t)})).map((function(e){return e.text})).join("\n"),f={mail:u.value};l?f.name=l.value:c&&c.name&&(f.name=c.name);var m={group:r,licence_id:a,ticket_message:p,offline_message:s.map((function(e){return e.text})).join("\n"),requester:f,visitor_id:i};return d&&d.value&&(m.subject=d.value),o.pageUrl&&(m.source={url:o.pageUrl}),m},Ys=function(e,t){var n={id:e,text:t.ticket_message,visitor:{name:t.requester.name||null,email:t.requester.mail||null}};return t.subject&&(n.subject=t.subject),n};function Js(e){var t,n,r,a,i,o,c,s,u,l,d;return jo.a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Object(Oo.j)(po.getPropertyGroup);case 2:return t=p.sent,p.next=5,Object(Oo.j)(po.getPropertyLicense);case 5:return n=p.sent,p.next=8,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 8:return r=p.sent,p.next=11,Object(Oo.j)(ho);case 11:return a=p.sent,p.next=14,Object(Oo.j)(po.getPropertyTicketForm);case 14:return i=p.sent,p.next=17,Object(Oo.j)(po.getPropertyTranslations);case 17:return o=p.sent,c=o?{name:o.client}:{},s=Ws({group:t,license:n,visitorId:r,visitorData:a,defaultValues:c},i,e.answers),p.next=22,Object(Oo.c)(is,"v2/tickets/new",s);case 22:if(!(u=p.sent).errors){p.next=27;break}throw l=u.errors[0],{type:d=Object.keys(l)[0],reason:l[d][0]};case 27:return p.abrupt("return",Ys(u.id,s));case 28:case"end":return p.stop()}}),Hs)}var Ks=jo.a.mark(Qs);function Qs(e){var t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 2:return t=i.sent,n=e.customId,i.next=6,Object(Oo.c)(Xo,po.getPropertyChatId);case 6:return r=i.sent,a={random_id:n,conference_id:r,visitor:{id:t},valid_time_sec:60},i.next=10,Object(Oo.c)(ns,"attachment_token",a);case 10:return i.abrupt("return",i.sent);case 11:case"end":return i.stop()}}),Ks)}var Zs=jo.a.mark(Xs);function Xs(){var e,t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(Oo.j)(po.getPropertyLicense);case 2:return e=r.sent,r.next=5,Object(Oo.j)(po.getPropertyGroup);case 5:return t=r.sent,n={type:"postchat",license:e,group:t},r.next=9,Object(Oo.c)(as,"getForm",n);case 9:return r.abrupt("return",r.sent);case 10:case"end":return r.stop()}}),Zs)}var $s=jo.a.mark(eu);function eu(e){var t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.answers,i.next=3,Object(Oo.j)(po.getPropertyVisitorId);case 3:return n=i.sent,i.next=6,Object(Oo.j)(po.getPropertyChatId);case 6:return r=i.sent,a={conference_id:r,random_id:String(Math.random()),survey:t,visitor:{id:n}},i.next=10,Object(Oo.c)(ns,"post_chat_survey_data",a);case 10:return i.abrupt("return",i.sent);case 11:case"end":return i.stop()}}),$s)}var tu=jo.a.mark(nu);function nu(){var e,t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 2:return e=n.sent,t={random_id:String(Math.random()),visitor:{id:e}},n.next=6,Object(Oo.c)(ns,"get_predicted_agent",t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),tu)}var ru=jo.a.mark(au);function au(e){var t,n,r,a,i,o,c;return jo.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.messageId,s.next=3,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 3:return n=s.sent,s.next=6,Object(Oo.j)(po.getPropertyServerIdsMap);case 6:return r=s.sent,a=r[t],i=a.serverId,o=a.authorId,c={message:{id:i,agent_id:o},random_id:String(Math.random()),visitor:{id:n}},s.next=11,Object(Oo.c)(ns,"agent_message_seen",c);case 11:return s.abrupt("return",s.sent);case 12:case"end":return s.stop()}}),ru)}var iu=jo.a.mark(ou);function ou(e){var t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("undefined"===typeof e){a.next=4;break}a.t0=e,a.next=7;break;case 4:return a.next=6,Object(Oo.j)(po.getPropertyGroup);case 6:a.t0=a.sent;case 7:return t=a.t0,a.next=10,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 10:return n=a.sent,r={visitor:{id:n},skill:t,random_id:String(Math.random())},a.next=14,Object(Oo.c)(ns,"status_ping",r,{retry:10});case 14:return a.abrupt("return",a.sent);case 15:case"end":return a.stop()}}),iu)}var cu=function(e){return{chatState:e.visitor_is_chatting?Ss:ks,chatStatus:e.agent_available?"ONLINE":"OFFLINE"}},su=jo.a.mark(ul),uu=jo.a.mark(ll),lu=jo.a.mark(dl),du=jo.a.mark(pl),pu=jo.a.mark(fl),fu=jo.a.mark(ml),mu=jo.a.mark(hl),hu=jo.a.mark(vl),vu=jo.a.mark(gl),gu=jo.a.mark(bl),bu=jo.a.mark(yl),yu=jo.a.mark(jl),ju=jo.a.mark(Ol),Ou=jo.a.mark(xl),xu=jo.a.mark(_l),_u=jo.a.mark(Cl),Cu=jo.a.mark(Sl),wu=jo.a.mark(kl),Eu=jo.a.mark(Al),Iu=jo.a.mark(Pl),Su=jo.a.mark(Nl),ku=jo.a.mark(Ml),Tu=jo.a.mark(zl),Au=jo.a.mark(Rl),Pu=jo.a.mark(Dl),Nu=jo.a.mark(Ll),Mu=jo.a.mark(Bl),zu=jo.a.mark(ql),Ru=jo.a.mark(Ul),Du=jo.a.mark(Fl),Lu=18e5,Bu=xo,qu=_o,Uu=Co,Fu=wo,Vu=Eo,Gu=Io,Hu=So,Wu=ko,Yu=To,Ju=Ao,Ku=Po,Qu=Mo,Zu=zo,Xu=Ro,$u=Do,el=Lo,tl=Bo,nl=qo,rl=Uo,al=Fo,il=Vo,ol=Go,cl=Ho,sl=Wo;function ul(){var e;return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.j)(po.getPropertyTranslations);case 2:if(!(e=t.sent)){t.next=5;break}return t.abrupt("return",e);case 5:return t.next=7,Object(Oo.c)(_s);case 7:return t.next=9,Object(Oo.j)(po.getPropertyTranslations);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),su)}function ll(){var e;return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.j)(po.getPropertyWelcomeMessage);case 2:if(!(e=t.sent)){t.next=5;break}return t.abrupt("return",e);case 5:return t.next=7,Object(Oo.c)(ul);case 7:return t.abrupt("return",t.sent.welcome_to_chat);case 8:case"end":return t.stop()}}),uu)}function dl(e){var t,n,r,a,i,o,c,s,u,l,d;return jo.a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:return u=function(){return jo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oo.l)((function(e){return e.type===Yi.getActionName()&&Object(x.u)("payload.customId",e)===a}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),t)},t=jo.a.mark(u),p.next=4,Object(Oo.c)(Xo,po.getPropertyChatState);case 4:return n=p.sent,r=e.payload,a=r.customId,i=r.text,o=r.json,c=n!==Ss,p.next=9,Object(Oo.j)(po.getPropertyAcceptedInvitation);case 9:return s=p.sent,p.next=12,Object(Oo.e)(u);case 12:if(l=p.sent,p.prev=13,!c){p.next=28;break}return p.t0=Oo.c,p.t1=Gl,p.t2=a,p.t3=i,p.next=21,Object(Oo.c)(ll);case 21:return p.t4=p.sent,p.t5=s,p.t6={customId:p.t2,text:p.t3,welcomeMessage:p.t4,acceptedInvitation:p.t5},p.next=26,(0,p.t0)(p.t1,p.t6);case 26:p.next=30;break;case 28:return p.next=30,Object(Oo.c)(Ps,{customId:a,text:i,json:o});case 30:p.next=38;break;case 32:return p.prev=32,p.t7=p.catch(13),e.payload.promise.reject({type:"connection",reason:"Request failed"}),p.next=37,Object(Oo.d)(l);case 37:return p.abrupt("return");case 38:if(!c){p.next=45;break}return p.next=41,Object(Oo.l)([Ki.getActionName(),Ji.getActionName()]);case 41:if(p.sent.type!==Ji.getActionName()){p.next=45;break}return e.payload.promise.reject({type:"state",reason:"Chat is offline"}),p.abrupt("return");case 45:return p.next=47,Object(Oo.g)(l);case 47:d=p.sent,e.payload.promise.resolve({id:d.payload.id,timestamp:d.payload.timestamp});case 49:case"end":return p.stop()}}),lu,null,[[13,32]])}function pl(e){var t,n,r,a,i,o;return jo.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(Oo.c)(Xo,po.getPropertyClientLimitExceeded);case 2:return c.next=4,Object(Oo.j)(ho);case 4:return t=c.sent,n=Object(x.R)(["customProperties"],t),r=Object(x.S)(x.C,Object(x.W)(["name","email","pageUrl","pageTitle","customProperties"],e.payload)),a=String(Math.random()),i=e.payload.update?Object(x.N)(t,r):Object(x.N)(n,r),c.next=11,Object(Oo.h)(no({requestId:a,visitorData:i}));case 11:return c.next=13,Object(Oo.l)((function(e){return(e.type===Qi.getActionName()||e.type===Zi.getActionName())&&e.payload.requestId===a}));case 13:if((o=c.sent).type!==Qi.getActionName()){c.next=16;break}return c.abrupt("return",e.payload.promise.resolve(o.payload.visitorData));case 16:return c.abrupt("return",e.payload.promise.reject({type:"connection",reason:"Request failed"}));case 17:case"end":return c.stop()}}),du)}function fl(e){return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.h)(Hi.setPropertySneakPeek(e.payload.text));case 2:e.payload.promise.resolve({success:!0});case 3:case"end":return t.stop()}}),pu)}function ml(e){return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.j)(po.getPropertyChatId);case 2:if(t.sent){t.next=6;break}return e.payload.promise.reject({type:"state",reason:"There is no chat to forward transcript"}),t.abrupt("return");case 6:return t.prev=6,t.next=9,Object(Oo.c)(Rs,e);case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(6),e.payload.promise.reject({type:"connection",reason:"Request failed"}),t.abrupt("return");case 15:e.payload.promise.resolve({success:!0});case 16:case"end":return t.stop()}}),fu,null,[[6,11]])}function hl(e){return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.j)(po.getPropertyChatId);case 2:if(t.sent){t.next=6;break}return e.payload.promise.reject({type:"state",reason:"There is no chat to close"}),t.abrupt("return");case 6:return t.prev=6,t.next=9,Object(Oo.c)(Ms);case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(6),e.payload.promise.reject({type:"connection",reason:"Request failed"}),t.abrupt("return");case 15:return t.next=17,Object(Oo.l)(Ji.getActionName());case 17:e.payload.promise.resolve({success:!0});case 18:case"end":return t.stop()}}),mu,null,[[6,11]])}function vl(e){return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.j)(po.getPropertyChatId);case 2:if(t.sent){t.next=6;break}return e.payload.promise.reject({type:"state",reason:"There is no chat to rate"}),t.abrupt("return");case 6:if(!e.payload.rate){t.next=16;break}return t.prev=7,t.next=10,Object(Oo.c)(Ls,e);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(7),e.payload.promise.reject({type:"connection",reason:"Request failed"}),t.abrupt("return");case 16:if(!e.payload.comment){t.next=26;break}return t.prev=17,t.next=20,Object(Oo.c)(Gs,e);case 20:t.next=26;break;case 22:return t.prev=22,t.t1=t.catch(17),e.payload.promise.reject({type:"connection",reason:"Rate Comment request failed"}),t.abrupt("return");case 26:e.payload.promise.resolve({success:!0});case 27:case"end":return t.stop()}}),hu,null,[[7,12],[17,22]])}function gl(e){var t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(Oo.j)(po.getPropertyChatState);case 3:if(n.sent!==Ss){n.next=7;break}return t.promise.reject({type:"state",reason:"You can't disconnect during the chat"}),n.abrupt("return");case 7:t.promise.resolve({success:!0});case 8:case"end":return n.stop()}}),vu)}function bl(e){var t,n,r,a,i,o,c;return jo.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(t=e.payload,n=t.promise,"undefined"===typeof(r=t.group)){s.next=18;break}return s.prev=3,s.next=6,Object(Oo.c)(qs,r);case 6:return a=s.sent,i=Jc(a.join("^")),o=xc(Oc(i.data.json)),s.next=11,Object(Oo.h)(Hi.setPropertyTicketForm(o));case 11:n.resolve(o),s.next=17;break;case 14:s.prev=14,s.t0=s.catch(3),n.reject({type:"connection",reason:"Request failed"});case 17:return s.abrupt("return");case 18:return s.next=20,Object(Oo.c)(Xo,po.getPropertyTicketForm);case 20:c=s.sent,n.resolve(c);case 22:case"end":return s.stop()}}),gu,null,[[3,14]])}function yl(e){var t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,n=t.promise,i.prev=2,i.next=5,Object(Oo.c)(Fs);case 5:r=i.sent,a=Jc(r.join("^")),n.resolve(Oc(a.data.json)),i.next=13;break;case 10:i.prev=10,i.t0=i.catch(2),n.reject({type:"connection",reason:"Request failed"});case 13:case"end":return i.stop()}}),bu,null,[[2,10]])}function jl(e){var t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,r.next=4,Object(Oo.c)(ul);case 4:return n=r.sent,r.abrupt("return",t.promise.resolve(n));case 8:return r.prev=8,r.t0=r.catch(1),r.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 11:case"end":return r.stop()}}),yu,null,[[1,8]])}function Ol(e){var t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 3:return r.next=5,Object(Oo.j)(ho);case 5:return n=r.sent,r.abrupt("return",t.promise.resolve(n));case 7:case"end":return r.stop()}}),ju)}function xl(e){var t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(Oo.c)(Xo,po.getPropertyTicketForm);case 3:return n.prev=3,n.t0=t.promise,n.next=7,Object(Oo.c)(Js,t);case 7:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=14;break;case 11:n.prev=11,n.t2=n.catch(3),t.promise.reject(n.t2&&n.t2.reason||n.t2&&n.t2.errors?n.t2:{type:"connection",reason:"Request failed"});case 14:case"end":return n.stop()}}),Ou,null,[[3,11]])}function _l(){var e;return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.c)(Xo,po.getPropertyConfigLoaded);case 2:return t.next=4,Object(Oo.j)(po.getPropertyPreChatForm);case 4:if(e=t.sent){t.next=7;break}return t.abrupt("return",null);case 7:return t.abrupt("return",e);case 8:case"end":return t.stop()}}),xu)}function Cl(e){var t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,r.next=4,Object(Oo.c)(_l);case 4:if(n=r.sent){r.next=7;break}return r.abrupt("return",t.promise.reject({type:"state",reason:"Pre-chat survey is turned off"}));case 7:return r.abrupt("return",t.promise.resolve(n));case 10:return r.prev=10,r.t0=r.catch(1),r.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 13:case"end":return r.stop()}}),_u,null,[[1,10]])}var wl=["email","text","radio","select","group_select"],El=["checkbox"],Il=function(e,t){return e.map((function(e){var n=t[e.name],r=typeof t[e.name];return e.required&&!n?{reason:"Required field",description:"Pease fill in required field",field:e.name}:n&&-1!==wl.indexOf(e.type)&&"string"!==r?{reason:"Wrong type",field:e.name}:!(!n||-1===El.indexOf(e.type)||Array.isArray(n))&&{reason:"Wrong type",field:e.name}})).filter(Boolean)};function Sl(e){var t,n,r,a,i,o,c,s,u,l,d,p,f;return jo.a.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:return t=e.payload,m.next=3,Object(Oo.c)(Xo,po.getPropertyChatState);case 3:if(n=m.sent,m.prev=4,n!==Ss){m.next=7;break}return m.abrupt("return",t.promise.reject({type:"state",reason:"You can't send prechat when chat is running"}));case 7:return m.next=9,Object(Oo.j)(ho);case 9:return r=m.sent,m.next=12,Object(Oo.c)(_l);case 12:return a=m.sent,i=t.answers,o=t.promise,c=i.choosenGroupIndex,s=Object(Ts.a)(i,["choosenGroupIndex"]),m.next=17,Object(Oo.j)(po.getPropertyAcceptedInvitation);case 17:if(u=m.sent,l=_c(s,a,c),0===(d=Il(a.fields,s)).length){m.next=22;break}return m.abrupt("return",o.reject({type:"wrong arguments",fields:d}));case 22:if(!(p=l.fields.filter((function(e){return"email"===e.type||"name"===e.type})))){m.next=27;break}return f=p.reduce((function(e,t){var n;return Object(Vi.a)({},e,((n={})[t.type]=t.answer,n))}),r),m.next=27,Object(Oo.h)(no({visitorData:f}));case 27:return m.t0=Oo.c,m.t1=Gl,m.t2=l,m.next=32,Object(Oo.c)(ll);case 32:return m.t3=m.sent,m.t4=u,m.t5={customId:"prechat_startchat",answers:m.t2,welcomeMessage:m.t3,acceptedInvitation:m.t4},m.next=37,(0,m.t0)(m.t1,m.t5);case 37:return m.next=39,Object(Oo.c)(Xo,po.getPropertyChatId);case 39:return m.abrupt("return",o.resolve({success:!0}));case 42:return m.prev=42,m.t6=m.catch(4),m.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 45:case"end":return m.stop()}}),Cu,null,[[4,42]])}function kl(e){var t,n,r,a,i,o,c,s,u,l,d,p;return jo.a.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return t=e.payload,f.next=3,Object(Oo.c)(Xo,po.getPropertyChatState);case 3:return n=f.sent,f.next=6,Object(Oo.j)(fo);case 6:return r=f.sent,f.next=9,Object(Oo.j)(po.getPropertyLicense);case 9:return a=f.sent,f.next=12,Object(Oo.j)(po.getPropertyRegion);case 12:if(i=f.sent,o=t.customId,c=t.file,s=t.onProgress,f.prev=14,n===Ss){f.next=18;break}return f.next=18,Object(Oo.c)(Gl,{customId:o+"_startchat",text:""});case 18:return f.next=20,Object(Oo.c)(Xo,po.getPropertyChatId);case 20:return u=f.sent,f.next=23,Object(Oo.c)(Qs,t);case 23:return l=f.sent,d=l.attachment_token,f.next=27,Object(Oo.c)(Tc,{environment:r,region:i,license:a,token:d,file:c,chatId:u,onProgress:s});case 27:return f.next=29,Object(Oo.l)((function(e){return e.type===Xi.getActionName()&&e.payload.attachmentToken===d}));case 29:return p=f.sent,f.abrupt("return",t.promise.resolve(Object(x.S)(x.C,Object(x.W)(["id","timestamp","url","contentType","size","width","height"],p.payload))));case 33:return f.prev=33,f.t0=f.catch(14),f.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 36:case"end":return f.stop()}}),wu,null,[[14,33]])}var Tl=function(e){var t=e.type,n=e.payload;return t===Hi.setPropertyPingSent.getActionName()&&!0===n.data};function Al(e){var t,n,r,a,i,o,c,s,u,l,d;return jo.a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:return t=e.payload,p.prev=1,p.next=4,Object(Oo.c)(Xo,po.getPropertyClientLimitExceeded);case 4:if(!p.sent){p.next=8;break}return p.next=8,Object(Oo.l)(Tl);case 8:return p.next=10,Object(Oo.c)(nu);case 10:if((n=p.sent).agent){p.next=13;break}return p.abrupt("return",t.promise.resolve({}));case 13:return p.next=15,Object(Oo.c)(ul);case 15:return r=p.sent,a=n.agent,i=a.login,o=a.name,c=a.avatar_url,s=a.job_title,u=a.is_bot,l=r.welcome_to_chat,p.next=20,Object(Oo.h)(Hi.setPropertyWelcomeMessage(l));case 20:return d={name:o,isBot:u,jobTitle:s,id:i,avatarUrl:rc(c),message:l},p.abrupt("return",t.promise.resolve(d));case 24:return p.prev=24,p.t0=p.catch(1),p.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 27:case"end":return p.stop()}}),Eu,null,[[1,24]])}function Pl(e){var t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.prev=1,i.next=4,Object(Oo.c)(Xs);case 4:if(n=i.sent,(r=Gc(n[1])).survey){i.next=8;break}return i.abrupt("return",t.promise.reject({type:"state",reason:"Post-chat survey is turned off"}));case 8:return a=Oc(r.survey),i.next=11,Object(Oo.h)(Hi.setPropertyPostChatForm(a));case 11:return i.abrupt("return",t.promise.resolve(a));case 14:return i.prev=14,i.t0=i.catch(1),i.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 17:case"end":return i.stop()}}),Iu,null,[[1,14]])}function Nl(e){var t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.prev=1,n=t.answers,i.next=5,Object(Oo.j)(po.getPropertyPostChatForm);case 5:return r=i.sent,a=_c(n,r),i.next=9,Object(Oo.c)(eu,{answers:a});case 9:return i.abrupt("return",t.promise.resolve({success:!0}));case 12:return i.prev=12,i.t0=i.catch(1),i.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 15:case"end":return i.stop()}}),Su,null,[[1,12]])}function Ml(e){var t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(Oo.j)(po.getPropertyConfig);case 3:if(n=r.sent){r.next=7;break}return r.next=7,Object(Oo.c)(xs);case 7:return r.next=9,Object(Oo.j)(po.getPropertyConfig);case 9:n=r.sent,t.promise.resolve(n);case 11:case"end":return r.stop()}}),ku)}function zl(e){var t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(Oo.h)(Hi.setPropertyAcceptedInvitation(t.id));case 3:t.promise.resolve({success:!0});case 4:case"end":return n.stop()}}),Tu)}function Rl(e){var t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,n=t.messageId,r.next=5,Object(Oo.c)(au,{messageId:n});case 5:return r.abrupt("return",t.promise.resolve({success:!0}));case 8:return r.prev=8,r.t0=r.catch(1),r.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 11:case"end":return r.stop()}}),Au,null,[[1,8]])}function Dl(e){var t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.next=3,Object(Oo.c)(Xo,po.getPropertyChatState);case 3:if(n=i.sent,!(n===Ss)){i.next=8;break}return t.promise.reject({type:"state",reason:"You can't start new chat during chat"}),i.abrupt("return");case 8:return i.next=10,Object(Oo.j)(po.getPropertyWelcomeMessage);case 10:if(r=i.sent){i.next=15;break}return i.next=14,Object(Oo.c)(ul);case 14:r=i.sent.welcome_to_chat;case 15:return i.prev=15,i.next=18,Object(Oo.c)(Gl,{customId:"startchat",welcomeMessage:r});case 18:return i.next=20,Object(Oo.c)(Xo,po.getPropertyChatId);case 20:a=i.sent,t.promise.resolve({chatId:a}),i.next=27;break;case 24:i.prev=24,i.t0=i.catch(15),t.promise.reject({type:"connection",reason:"Request failed"});case 27:case"end":return i.stop()}}),Pu,null,[[15,24]])}function Ll(e){var t,n,r,a,i,o,c,s,u,l,d,p;return jo.a.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(t=e.payload,n=t.group,r=t.promise,"undefined"===typeof n){f.next=6;break}f.t0=n,f.next=9;break;case 6:return f.next=8,Object(Oo.j)(po.getPropertyGroup);case 8:f.t0=f.sent;case 9:return a=f.t0,f.next=12,Object(Oo.j)(po.getPropertyClientLimitExceeded);case 12:if((i=f.sent)||"undefined"!==typeof n){f.next=23;break}return f.next=16,Object(Oo.j)(po.getPropertyChatState);case 16:return o=f.sent,c=o===Ss,f.next=20,Object(Oo.j)(po.getPropertyChatStatus);case 20:return s=f.sent,r.resolve({groupStatus:s.toLowerCase(),chatting:c}),f.abrupt("return");case 23:return f.prev=23,f.next=26,Object(Oo.c)(ou,a);case 26:if(u=f.sent,l=cu(u),d=l.chatStatus,p=l.chatState,!i||p!==Ss){f.next=31;break}return f.next=31,Object(Oo.h)(Hi.setPropertyClientLimitExceeded(!1));case 31:r.resolve({groupStatus:d.toLowerCase(),chatting:p===Ss}),f.next=37;break;case 34:f.prev=34,f.t1=f.catch(23),r.reject({type:"connection",reason:"Request failed"});case 37:case"end":return f.stop()}}),Nu,null,[[23,34]])}function Bl(){var e;return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(Oo.c)(go.d,Lu);case 3:return t.next=5,Object(Oo.j)(po.getPropertyChatState);case 5:if(e=t.sent,e===Ss){t.next=10;break}return t.next=10,Object(Oo.h)(Hi.setPropertyClientLimitExceeded(!0));case 10:t.next=0;break;case 12:case"end":return t.stop()}}),Mu)}function ql(){var e,t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Oo.a)([qu.getActionName()],go.b.expanding());case 2:return e=n.sent,n.next=5,Object(Oo.l)("VISITOR_DATA_WATCHER");case 5:return n.next=8,Object(Oo.l)(e);case 8:return t=n.sent,n.next=11,Object(Oo.c)(Xo,po.getPropertyPingSent);case 11:return n.next=13,Object(Oo.c)(pl,t);case 13:n.next=5;break;case 15:case"end":return n.stop()}}),zu)}function Ul(e){var t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(Oo.h)(Hi.setPropertyGroup(t.group));case 3:case"end":return n.stop()}}),Ru)}function Fl(){var e,t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(Oo.e)(Bl);case 2:return r.next=4,Object(Oo.e)(ql);case 4:return r.next=6,Object(Oo.m)(rl.getActionName(),zl);case 6:return r.next=8,Object(Oo.m)(Xu.getActionName(),jl);case 8:return r.next=10,Object(Oo.m)(Yu.getActionName(),bl);case 10:return r.next=12,Object(Oo.m)(sl.getActionName(),yl);case 12:return r.next=14,Object(Oo.m)(Ju.getActionName(),xl);case 14:return r.next=16,Object(Oo.m)(Fu.getActionName(),vl);case 16:return r.next=18,Object(Oo.m)(Vu.getActionName(),fl);case 18:return r.next=20,Object(Oo.m)(Hu.getActionName(),hl);case 20:return r.next=22,Object(Oo.m)(Gu.getActionName(),ml);case 22:return r.next=24,Object(Oo.m)(Wu.getActionName(),gl);case 24:return r.next=26,Object(Oo.m)(Uu.getActionName(),Ol);case 26:return r.next=28,Object(Oo.m)(Qu.getActionName(),Cl);case 28:return r.next=30,Object(Oo.m)($u.getActionName(),Al);case 30:return r.next=32,Object(Oo.m)(el.getActionName(),Pl);case 32:return r.next=34,Object(Oo.m)(tl.getActionName(),Nl);case 34:return r.next=36,Object(Oo.m)(nl.getActionName(),Ml);case 36:return r.next=38,Object(Oo.m)(al.getActionName(),Rl);case 38:return r.next=40,Object(Oo.m)(ol.getActionName(),Ll);case 40:return r.next=42,Object(Oo.m)(cl.getActionName(),Ul);case 42:return r.next=44,Object(Oo.a)([Bu.getActionName(),Ku.getActionName(),Zu.getActionName(),il.getActionName()],go.b.expanding());case 44:e=r.sent,t=jo.a.mark((function t(){var n,r;return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.l)(e);case 2:n=t.sent,t.t0=n.type,t.next=t.t0===Bu.getActionName()?6:t.t0===Ku.getActionName()?9:t.t0===Zu.getActionName()?19:t.t0===il.getActionName()?22:25;break;case 6:return t.next=8,Object(Oo.c)(dl,n);case 8:return t.abrupt("break",26);case 9:return t.next=11,Object(Oo.e)(kl,n);case 11:return r=t.sent,t.next=14,Object(Oo.i)({success:Object(Oo.g)(r),cancel:Object(Oo.l)((function(e){return e.type===No.getActionName()&&e.payload.customId===n.payload.customId}))});case 14:if(!t.sent.cancel){t.next=18;break}return t.next=18,Object(Oo.d)(r);case 18:return t.abrupt("break",26);case 19:return t.next=21,Object(Oo.c)(Sl,n);case 21:return t.abrupt("break",26);case 22:return t.next=24,Object(Oo.c)(Dl,n);case 24:return t.abrupt("break",26);case 25:return t.abrupt("return",{v:void 0});case 26:case"end":return t.stop()}}),t)}));case 46:return r.delegateYield(t(),"t0",48);case 48:if("object"!==typeof(n=r.t0)){r.next=51;break}return r.abrupt("return",n.v);case 51:r.next=46;break;case 53:case"end":return r.stop()}}),Du)}var Vl=jo.a.mark(Gl);function Gl(e){var t,n,r,a,i,o,c,s,u,l,d,p,f,m,h;return jo.a.wrap((function(v){for(;;)switch(v.prev=v.next){case 0:return t=e.customId,n=e.text,r=e.answers,a=e.welcomeMessage,i=e.acceptedInvitation,o=e.fromManualInvitation,c=void 0!==o&&o,v.next=3,Object(Oo.j)(po.getPropertyGroup);case 3:return s=v.sent,v.next=6,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 6:return u=v.sent,v.next=9,Object(Oo.j)(ho);case 9:if(l=v.sent,v.t1=l.name,v.t1){v.next=15;break}return v.next=14,Object(Oo.c)(ul);case 14:v.t1=v.sent.client;case 15:if(v.t0=v.t1,v.t0){v.next=18;break}v.t0="Client";case 18:return d=v.t0,v.next=21,Object(Oo.j)(po.getPropertyMobile);case 21:return p=v.sent,v.next=24,Object(Oo.c)(Xo,po.getPropertyPingSent);case 24:return f={group:s,source_group:s,details:"",details_labels:"",from_manual_invitation:c,integration_params:"",random_id:t,trigger_unique_id:"",version:"Embedded",custom_variables:{},is_mobile:p,welcome_message:(a||"").replace(/%name%/g,d),return_secured_session_id:!0,visitor:{id:u,nick:d,email:l.email||""},script_version:{embedded_env:"production",embedded_version:"VisitorSDK-a5be43e"}},n&&(f.visitor_message=n,f.visitor_message_id=t),l.customProperties&&(f.custom_variables=Object(x.J)(String,l.customProperties)),r&&(f.pre_chat_survey=r),i&&(f.trigger_unique_id=i),v.next=31,Object(Oo.h)(Hi.setPropertyChatId(void 0));case 31:return v.next=33,Object(Oo.j)(po.getPropertyLicense);case 33:return m=v.sent,nc.removeItem("securedToken"),nc.removeOldSecretTokenCookie(m),v.next=38,Object(Oo.h)(Hi.removePropertySecuredToken());case 38:return v.next=40,Object(Oo.h)(Hi.setPropertyServerIdsMap({}));case 40:return v.next=42,Object(Oo.h)(Hi.setPropertyVisitorCustomIdMap({}));case 42:return v.next=44,Object(Oo.c)(ns,"start_chat",f);case 44:if(!(h=v.sent).secured_session_id){v.next=49;break}return v.next=48,Object(Oo.h)(Hi.setPropertySecretId(h.secured_session_id));case 48:nc.setItem("secretId",h.secured_session_id);case 49:if(!h.secured_token){v.next=55;break}return v.next=52,Object(Oo.h)(Hi.setPropertySecuredToken(h.secured_token));case 52:return v.next=54,Object(Oo.h)(Hi.setPropertyChatState(Ss,{source:c?"manual_invitation":"start_chat"}));case 54:nc.setItem("securedToken",h.secured_token);case 55:case"end":return v.stop()}}),Vl)}var Hl=jo.a.mark(Zl),Wl=jo.a.mark(Xl),Yl=jo.a.mark($l),Jl=jo.a.mark(ed),Kl=jo.a.mark(td),Ql=function(e,t,n,r){var a,i={visitor:{id:t,group:n}};return e&&(i.page={title:r.pageTitle,url:r.pageUrl}),e&&r.pageReferrer&&(i.page.referrer=r.pageReferrer),e&&r.email&&(i.visitor.email=r.email),e&&r.name&&(i.visitor.name=r.name),e&&r.customProperties&&(i.visitor.custom_variables=(a=r.customProperties,Object.keys(a).map((function(e){return{name:String(e),value:String(a[e])}})))),i};function Zl(e){var t,n,r,a,i,o,c,s,u,l,d;return jo.a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:return t=e.sendFullPing,p.next=3,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 3:return n=p.sent,p.next=6,Object(Oo.j)(po.getPropertyLicense);case 6:return r=p.sent,p.next=9,Object(Oo.j)(po.getPropertyGroup);case 9:return a=p.sent,p.next=12,Object(Oo.j)(ho);case 12:return i=p.sent,p.next=15,Object(Oo.j)(fo);case 15:return o=p.sent,p.next=18,Object(Oo.j)(po.getPropertyRegion);case 18:return c=p.sent,s=Ql(t,n,a,i),p.next=22,Object(Oo.j)(po.getPropertyChatBetweenGroups);case 22:return u=p.sent,p.next=25,Object(Oo.j)(po.getPropertyRequestDistribution);case 25:return l=p.sent,p.prev=26,p.t0=Oo.c,p.t1=Mc,p.t2=r,p.t3=o,p.t4=c,p.t5=s,p.next=35,Object(Oo.f)("external");case 35:return p.t6=p.sent,p.t7=u,p.t8=a,p.t9=l,p.t10={license:p.t2,environment:p.t3,region:p.t4,body:p.t5,external:p.t6,chatBetweenGroups:p.t7,group:p.t8,requestDistribution:p.t9},p.t11={retry:10},p.next=43,(0,p.t0)(p.t1,"ping",p.t10,p.t11);case 43:return d=p.sent,p.next=46,Object(Oo.j)(po.getPropertyConnectionStatus);case 46:if("connected"===p.sent){p.next=50;break}return p.next=50,Object(Oo.h)(Hi.setPropertyConnectionStatus("connected"));case 50:return p.abrupt("return",d);case 53:return p.prev=53,p.t12=p.catch(26),p.next=57,Object(Oo.j)(po.getPropertyConnectionStatus);case 57:if("disconnected"===p.sent){p.next=61;break}return p.next=61,Object(Oo.h)(Hi.setPropertyConnectionStatus("disconnected"));case 61:return p.abrupt("return",{error:!0});case 62:case"end":return p.stop()}}),Hl,null,[[26,53]])}function Xl(e){var t,n,r,a,i;return jo.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!e.automatic_greeting){o.next=8;break}return t=ac(e.automatic_greeting),n=t.agent,r=t.invitation,o.next=4,Object(Oo.h)(Ki(Object(Vi.a)({},n,{fromInvitation:!0})));case 4:return o.next=6,Object(Oo.h)(oo(r));case 6:o.next=20;break;case 8:if(!e.personal_greeting){o.next=13;break}return o.next=11,Object(Oo.c)(Gl,{customId:String(Math.random()),welcomeMessage:e.personal_greeting.greeting_message.message,fromManualInvitation:!0});case 11:o.next=20;break;case 13:if(!e.standard_greeting){o.next=20;break}return o.next=16,Object(Oo.c)(ul);case 16:return a=o.sent,i=a.welcome_to_chat,o.next=20,Object(Oo.c)(Gl,{customId:String(Math.random()),welcomeMessage:i,fromManualInvitation:!0});case 20:case"end":return o.stop()}}),Wl)}function $l(){var e,t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Oo.a)(no.getActionName(),go.b.expanding());case 2:return e=a.sent,a.next=5,Object(Oo.h)({type:"VISITOR_DATA_WATCHER"});case 5:return a.next=8,Object(Oo.l)(e);case 8:if((t=a.sent).payload.internal){a.next=26;break}return a.next=12,Object(Oo.c)(Zl,{sendFullPing:!0});case 12:if(!(n=a.sent).error){a.next=17;break}return a.next=16,Object(Oo.h)(Zi({error:n.error,requestId:t.payload.requestId}));case 16:return a.abrupt("return",a.sent);case 17:return a.next=19,Object(Oo.c)(Xl,n);case 19:return a.next=21,Object(Oo.j)(ho);case 21:return r=a.sent,a.next=24,Object(Oo.h)(Qi({visitorData:r,requestId:t.payload.requestId}));case 24:a.next=34;break;case 26:return a.t0=Oo.h,a.next=29,Object(Oo.j)(ho);case 29:return a.t1=a.sent,a.t2={visitorData:a.t1},a.t3={type:"EMIT_VISITOR_DATA",payload:a.t2},a.next=34,(0,a.t0)(a.t3);case 34:a.next=5;break;case 36:case"end":return a.stop()}}),Yl)}function ed(){var e,t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e=3,t=!0,a.next=4,Object(Oo.c)(Xo,po.getPropertyRequestDistribution);case 4:return a.next=7,Object(Oo.c)(Zl,{sendFullPing:t});case 7:if(n=a.sent,r=t,t=Boolean(n.next_ping_send_full_details),0!==n.next_ping_delay){a.next=16;break}return a.next=13,Object(Oo.c)(Es);case 13:return a.next=15,Object(Oo.h)(Hi.setPropertyClientLimitExceeded(!0));case 15:return a.abrupt("return");case 16:return e=!r&&t?0:n.next_ping_delay||3,a.next=19,Object(Oo.c)(Xl,n);case 19:return a.next=21,Object(Oo.h)(Hi.setPropertyPingSent(!0));case 21:return a.next=23,Object(Oo.c)(go.d,1e3*e);case 23:a.next=4;break;case 25:case"end":return a.stop()}}),Jl)}function td(){return jo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oo.e)(ed);case 2:return e.next=4,Object(Oo.e)($l);case 4:case"end":return e.stop()}}),Kl)}var nd=function(e){var t=document.cookie.split(";"),n=Object(x.k)((function(t){var n=Object(x.ob)(t).split("=")[0];return decodeURIComponent(n)===e}),t);return n?decodeURIComponent(n.split("=")[1]):null},rd=jo.a.mark(ad);function ad(){var e,t,n,r,a,i,o,c;return jo.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(Oo.c)(Xo,po.getPropertyRequestDistribution);case 2:return s.next=5,Object(Oo.j)(po.getPropertyLicense);case 5:return e=s.sent,s.prev=6,s.next=9,Object(Oo.c)(ou);case 9:return t=s.sent,s.next=12,Object(Oo.j)(po.getPropertyChatStatus);case 12:return n=s.sent,s.next=15,Object(Oo.j)(po.getPropertyChatState);case 15:return r=s.sent,a=cu(t),i=a.chatStatus,o=a.chatState,s.next=19,Object(Oo.j)(po.getPropertyConnectionStatus);case 19:if("connected"===s.sent){s.next=23;break}return s.next=23,Object(Oo.h)(Hi.setPropertyConnectionStatus("connected"));case 23:if(n===i){s.next=26;break}return s.next=26,Object(Oo.h)(Hi.setPropertyChatStatus(i));case 26:if(r===o||o!==Ss){s.next=32;break}return c=nc.getItem("securedToken")||nd("secret_token_"+e),s.next=30,Object(Oo.h)(Hi.setPropertySecuredToken(c));case 30:return s.next=32,Object(Oo.h)(Hi.setPropertyChatState(o,{source:"other_tab"}));case 32:s.next=42;break;case 34:return s.prev=34,s.t0=s.catch(6),s.next=38,Object(Oo.j)(po.getPropertyConnectionStatus);case 38:if("disconnected"===s.sent){s.next=42;break}return s.next=42,Object(Oo.h)(Hi.setPropertyConnectionStatus("disconnected"));case 42:return s.next=44,Object(Oo.c)(go.d,3e3);case 44:s.next=2;break;case 46:case"end":return s.stop()}}),rd,null,[[6,34]])}var id=ad,od="chat_started",cd="new_message",sd="chat_ended",ud="agent_changed",ld="status_changed",dd="connection_status_changed",pd="new_file",fd="visitor_queued",md="typing_indicator",hd="visitor_data",vd="chat_rated",gd="new_invitation",bd="ready",yd="message_seen",jd="protocol_upgraded",Od="integration_data",xd=jo.a.mark(Td),_d=jo.a.mark(Nd),Cd=jo.a.mark(Md),wd=jo.a.mark(zd),Ed=jo.a.mark(Ld),Id=jo.a.mark(qd),Sd=jo.a.mark(Vd),kd=jo.a.mark(Yd);function Td(e,t){var n,r,a,i,o,c,s;return jo.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return n=e.emitter,r=t.payload,n.emit("__start_chat_request_succeeded"),u.next=5,Object(Oo.c)(Xo,po.getPropertyChatId);case 5:if(a=u.sent,n.emit(od,{chatId:a}),!r.welcomeMessage){u.next=18;break}return u.next=10,Object(Oo.j)(po.getPropertyLastAgentId);case 10:return i=u.sent,u.next=13,Object(Oo.j)(po.getPropertyServerIdsMap);case 13:return o=u.sent,u.next=16,Object(Oo.h)(Hi.setPropertyServerIdsMap(Object(Vi.a)({},o,{welcome_message:{serverId:"welcome_message",authorId:i}})));case 16:return u.next=18,Object(Oo.h)(Yi({id:"welcome_message",timestamp:Date.now(),authorType:"agent",authorId:i,text:r.welcomeMessage,chatId:a,customId:"welcome_message"}));case 18:if(!r.visitorMessage){u.next=21;break}return u.next=21,Object(Oo.h)(Yi(r.visitorMessage));case 21:return u.next=23,Object(Oo.l)(Ji.getActionName());case 23:return c=u.sent,s=c.payload.reason,n.emit(sd,{reason:s}),u.next=28,Object(Oo.h)(Hi.setPropertyLastMessageId(null));case 28:case"end":return u.stop()}}),xd)}function Ad(e,t){var n=e.emitter,r=t.payload;n.emit(ld,{status:r.data.toLowerCase()})}function Pd(e,t){var n=e.emitter,r=t.payload;n.emit(dd,{status:r.data.toLowerCase()})}function Nd(e,t){var n,r,a,i,o;return jo.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return n=e.emitter,r=t.payload,c.next=4,Object(Oo.c)(Xo,po.getPropertyChatId);case 4:return a=c.sent,c.next=7,Object(Oo.j)(po.getPropertyVisitorId);case 7:i=c.sent,o={id:r.id,timestamp:r.timestamp,authorId:"visitor"===r.authorType?i:r.authorId,text:r.text,chatId:a,json:r.json},"undefined"!==typeof r.isMobile&&(o.isMobile=r.isMobile),"undefined"!==typeof r.customId&&(o.customId=r.customId),n.emit(cd,o);case 12:case"end":return c.stop()}}),_d)}function Md(e,t){var n,r,a,i;return jo.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=e.emitter,r=t.payload,o.next=4,Object(Oo.j)(po.getPropertyVisitorId);case 4:a=o.sent,i={id:r.id,timestamp:r.timestamp,authorId:"visitor"===r.authorType?a:r.authorId,url:r.url,contentType:r.contentType,size:r.size},r.thumbnail&&(i.thumbnail=r.thumbnail),n.emit(pd,i);case 8:case"end":return o.stop()}}),Cd)}function zd(e,t){var n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n=e.emitter,r=t.payload,Object(Oo.j)(po.getPropertyLastAgentId)!==r.id){i.next=5;break}return i.abrupt("return");case 5:return i.next=7,Object(Oo.h)(Hi.setPropertyLastAgentId(r.id));case 7:a={name:r.name,id:r.id},r.avatarUrl&&(a.avatarUrl=r.avatarUrl),r.jobTitle&&(a.jobTitle=r.jobTitle),r.fromInvitation&&(a.fromInvitation=r.fromInvitation),r.trigger&&(a.trigger=r.trigger),n.emit(ud,a);case 13:case"end":return i.stop()}}),wd)}function Rd(e,t){var n=e.emitter,r=t.payload,a=r.numberInQueue,i=r.waitingTime;n.emit(fd,{numberInQueue:a,waitingTime:i})}function Dd(e,t){var n=e.emitter,r=t.payload,a=r.authorId,i=r.isTyping;n.emit(md,{authorId:a,isTyping:i})}function Ld(e){var t,n,r,a;return jo.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.emitter,i.next=3,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 3:return n=i.sent,i.next=6,Object(Oo.j)(ho);case 6:r=i.sent,a=r.name?{id:n,name:r.name}:{id:n},Promise.resolve().then((function(){t.emit(hd,a)}));case 9:case"end":return i.stop()}}),Ed)}function Bd(e,t){e.emitter.emit(vd,{rate:t.payload.rate,comment:t.payload.comment})}function qd(e,t){return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.emitter.emit(gd,t.payload),n.next=4,Object(Oo.l)((function(e){return e.type===Uo.getActionName()&&e.payload.id===t.payload.id}));case 4:return n.next=6,Object(Oo.h)(Hi.setPropertyWelcomeMessage(t.payload.text));case 6:case"end":return n.stop()}}),Id)}function Ud(e){e.emitter.emit(bd)}function Fd(e,t){var n=e.emitter,r=t.payload;n.emit(yd,r)}function Vd(e,t,n){return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(Oo.c)(e[n.type],{emitter:t},n);case 3:r.next=7;break;case 5:r.prev=5,r.t0=r.catch(0);case 7:case"end":return r.stop()}}),Sd,null,[[0,5]])}function Gd(e){e.emitter.emit(jd)}function Hd(e,t){var n=e.emitter,r=t.payload;n.emit(Od,r)}function Wd(e,t){var n=e.emitter,r=t.payload.visitorData;n.emit(hd,Object(x.c)(r))}function Yd(e){var t,n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.emitter,a.next=3,Object(Oo.e)(Ld,{emitter:n});case 3:return(t={})[Wi.getActionName()]=Td,t[Hi.setPropertyChatStatus.getActionName()]=Ad,t[Hi.setPropertyConnectionStatus.getActionName()]=Pd,t[Yi.getActionName()]=Nd,t[Xi.getActionName()]=Md,t[Ki.getActionName()]=zd,t[$i.getActionName()]=Rd,t[eo.getActionName()]=Dd,t[to.getActionName()]=Bd,t[oo.getActionName()]=qd,t[Hi.setPropertyHistoryLoaded.getActionName()]=Ud,t[co.getActionName()]=Fd,t[so.getActionName()]=Gd,t[uo.getActionName()]=Hd,t.EMIT_VISITOR_DATA=Wd,r=t,a.next=6,Object(Oo.m)(Object.keys(r),Vd,r,n);case 6:case"end":return a.stop()}}),kd)}var Jd=L("INCOMING_MESSAGE",(function(e){return{name:e.name,message:e.message,trigger:e.trigger}})),Kd=1800,Qd=jo.a.mark(Zd);function Zd(e){var t,n,r,a,i;return jo.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===e&&(e={}),o.next=3,Object(Oo.c)(Xo,po.getPropertyVisitorId);case 3:return t=o.sent,o.next=6,Object(Oo.j)(po.getPropertyGroup);case 6:return n=o.sent,o.next=9,Object(Oo.j)(po.getPropertyLastMessageId);case 9:return r=o.sent,a=e.sneakPeek,i={random_id:String(Math.random()),visitor:{id:t,group:n}},r&&(i.last_unique_id=r),"string"===typeof a&&(i.sneak_peek=a),o.next=16,Object(Oo.c)(ns,"get_pending_messages",i);case 16:return o.abrupt("return",o.sent);case 17:case"end":return o.stop()}}),Qd)}var Xd=jo.a.mark(ap),$d=jo.a.mark(sp),ep=jo.a.mark(up),tp=jo.a.mark(lp),np=jo.a.mark(dp),rp="";function ap(){var e;return jo.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oo.j)(po.getPropertyLicense);case 2:return e=t.sent,t.next=5,Object(Oo.h)(Hi.setPropertyChatState(ks));case 5:return t.next=7,Object(Oo.h)(Hi.removePropertySecuredToken());case 7:return t.next=9,Object(Oo.h)(Ji());case 9:return nc.removeItem("securedToken"),nc.removeOldSecretTokenCookie(e),t.next=13,Object(Oo.h)(Hi.setPropertyServerIdsMap({}));case 13:return t.next=15,Object(Oo.h)(Hi.setPropertyVisitorCustomIdMap({}));case 15:case"end":return t.stop()}}),Xd)}var ip=function(e){return Object(x.u)("message.data",e)&&(e.message.data=Object(x.I)(x.b,e.message.data)),Object(x.u)("message.name",e)&&(e.message.name=Object(x.b)(e.message.name)),Object(Vi.a)({timestamp:e.timestamp,uniqueId:e.unique_id},e.message)},op=function(e){return Math.max.apply(Math,[0].concat(e.map((function(e){return e.unique_id}))))},cp=function(e,t){return e.messages.map((function(e){if(e.message_iwcs){var n=Jc(e.message_iwcs,t);return!!n&&{timestamp:e.timestamp,unique_id:e.unique_id,message:n}}return e})).filter(Boolean).map(ip)};function sp(){var e,t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(Oo.c)(Xo,po.getPropertyConfigLoaded);case 2:return r.next=4,Object(Oo.j)(po.getPropertySecuredToken);case 4:if(!r.sent){r.next=34;break}return r.prev=6,r.next=9,Object(Oo.c)(Zd);case 9:if(!(e=r.sent).messages){r.next=20;break}return t=cp(e,{trigger:"init"}),r.next=14,Object(Oo.b)(t.map((function(e){return Object(Oo.h)(Jd({name:e.name,message:e}))})));case 14:if(!(n=op(e.messages))){r.next=18;break}return r.next=18,Object(Oo.h)(Hi.setPropertyLastMessageId(n));case 18:r.next=22;break;case 20:return r.next=22,Object(Oo.c)(ap);case 22:r.next=32;break;case 24:return r.prev=24,r.t0=r.catch(6),r.next=28,Object(Oo.j)(po.getPropertyConnectionStatus);case 28:if("disconnected"===r.sent){r.next=32;break}return r.next=32,Object(Oo.h)(Hi.setPropertyConnectionStatus("disconnected"));case 32:r.next=36;break;case 34:return r.next=36,Object(Oo.h)(Hi.setPropertyChatState(ks));case 36:return r.next=38,Object(Oo.h)(Hi.setPropertyHistoryLoaded(!0));case 38:case"end":return r.stop()}}),$d,null,[[6,24]])}function up(){var e,t,n,r,a,i,o;return jo.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:e={};case 1:return c.next=4,Object(Oo.j)(po.getPropertySecuredToken);case 4:return t=c.sent,c.next=7,Object(Oo.j)(po.getPropertyChatState);case 7:return n=c.sent,c.next=10,Object(Oo.j)(po.getPropertySneakPeek);case 10:if(r=c.sent,!t||n!==Ss){c.next=44;break}return c.prev=12,c.next=15,Object(Oo.c)(Zd,{sneakPeek:rp!==r?r:null});case 15:return a=c.sent,c.next=18,Object(Oo.j)(po.getPropertyConnectionStatus);case 18:if("connected"===c.sent){c.next=22;break}return c.next=22,Object(Oo.h)(Hi.setPropertyConnectionStatus("connected"));case 22:if(a.messages){c.next=27;break}return c.next=25,Object(Oo.c)(ap);case 25:c.next=34;break;case 27:if(i=cp(a,{trigger:e.chatHasJustStarted?e.chatHasJustStarted.payload.meta.source:null}),!(o=op(a.messages))){c.next=32;break}return c.next=32,Object(Oo.h)(Hi.setPropertyLastMessageId(o));case 32:return c.next=34,Object(Oo.b)(i.map((function(e){return Object(Oo.h)(Jd({name:e.name,message:e}))})));case 34:c.next=44;break;case 36:return c.prev=36,c.t0=c.catch(12),c.next=40,Object(Oo.j)(po.getPropertyConnectionStatus);case 40:if("disconnected"===c.sent){c.next=44;break}return c.next=44,Object(Oo.h)(Hi.setPropertyConnectionStatus("disconnected"));case 44:return rp=r,c.next=47,Object(Oo.i)({chatHasJustStarted:Object(Oo.l)((function(e){return e.type===Hi.setPropertyChatState.getActionName()&&e.payload.data===Ss})),intervalElapsed:Object(Oo.c)(go.d,Kd),sendFileAttempt:Object(Oo.l)(Po.getActionName()),sendMessegeResponseReceived:Object(Oo.l)("PRIVATE_SEND_MESSAGE")});case 47:e=c.sent,c.next=1;break;case 50:case"end":return c.stop()}}),ep,null,[[12,36]])}function lp(){return jo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oo.c)(Xo,po.getPropertyChatState);case 2:return e.next=4,Object(Oo.c)(up);case 4:case"end":return e.stop()}}),tp)}function dp(){return jo.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oo.c)(sp);case 2:return e.next=4,Object(Oo.k)(lp);case 4:case"end":return e.stop()}}),np)}var pp="agentMessageSeen",fp="sendMessage",mp="startChat",hp="chatAttachment",vp="sendRatingComment",gp="visitorMessageSeen",bp=jo.a.mark(Op),yp=jo.a.mark(xp),jp=jo.a.mark(_p);function Op(e,t){var n,r;return jo.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(Oo.j)(po.getPropertyVisitorCustomIdMap);case 2:return r=a.sent,a.next=5,Object(Oo.h)(Hi.setPropertyVisitorCustomIdMap(Object(Vi.a)({},r,((n={})[e]=t,n))));case 5:case"end":return a.stop()}}),bp)}function xp(e){var t,n,r,a,i,c,s,u,l,d,p,f,m;return jo.a.wrap((function(h){for(;;)switch(h.prev=h.next){case 0:t=e.payload,(n=t.message).timestamp*=1e3,h.t0=n.name,h.next=h.t0===mp?6:h.t0===fp?26:h.t0===Wc.RATE_CHAT?31:h.t0===vp?34:h.t0===hp?37:h.t0===Wc.NEW_AGENT_MESSAGE?45:h.t0===Wc.AGENTS_OFFLINE?53:h.t0===Wc.CHAT_ENDED?53:h.t0===Wc.NEW_AGENT?69:h.t0===Wc.VISITOR_QUEUED?78:h.t0===Wc.TYPING_INDICATOR?81:h.t0===gp?84:h.t0===Wc.INTEGRATION_DATA?96:h.t0===pp?99:111;break;case 6:return h.next=8,Object(Oo.j)(po.getPropertySecuredToken);case 8:return h.t1=h.sent,h.t2=n.data.welcomeMessage,r={securedToken:h.t1,welcomeMessage:h.t2},a=Object(x.u)("data.visitor.nick",n),h.next=14,Object(Oo.j)(ho);case 14:if(i=h.sent,!a||a===i.name){h.next=18;break}return h.next=18,Object(Oo.h)(no({visitorData:Object(Vi.a)({},i,{name:a}),internal:!0}));case 18:return n.data.visitorMessage&&(r.visitorMessage={id:n.uniqueId,timestamp:n.timestamp,authorType:"visitor",text:n.data.visitorMessage,customId:n.data.randomId}),h.next=21,Object(Oo.h)(Hi.setPropertyChatId(void 0));case 21:return h.next=23,Object(Oo.h)(Wi(r));case 23:return h.next=25,Object(Oo.c)(Op,n.data.randomId,n.uniqueId);case 25:return h.abrupt("break",112);case 26:return h.next=28,Object(Oo.c)(Op,n.data.randomId,n.uniqueId);case 28:return h.next=30,Object(Oo.h)(Yi({id:n.uniqueId,timestamp:n.timestamp,authorType:"visitor",text:n.data.message,customId:n.data.randomId}));case 30:return h.abrupt("break",112);case 31:return h.next=33,Object(Oo.h)(to({id:n.uniqueId,timestamp:n.timestamp,rate:n.data.rate,comment:n.data.comment}));case 33:return h.abrupt("break",112);case 34:return h.next=36,Object(Oo.h)(to({id:n.uniqueId,timestamp:n.timestamp,comment:n.data.comment}));case 36:return h.abrupt("break",112);case 37:return h.next=39,Object(Oo.j)(po.getPropertyServerIdsMap);case 39:return s=h.sent,h.next=42,Object(Oo.h)(Hi.setPropertyServerIdsMap(Object(Vi.a)({},s,((c={})[n.uniqueId]={serverId:n.data.attachmentToken,authorId:n.data.author.login},c))));case 42:return h.next=44,Object(Oo.h)(Xi({id:n.uniqueId,timestamp:n.timestamp,authorId:n.data.author.login||"visitor",authorType:n.data.author.type,url:n.data.files[0].url,size:n.data.files[0].size,contentType:n.data.files[0]["content-type"],attachmentToken:n.data.attachmentToken,thumbnail:n.data.files[0].thumbs}));case 44:return h.abrupt("break",112);case 45:return h.next=47,Object(Oo.j)(po.getPropertyServerIdsMap);case 47:return l=h.sent,h.next=50,Object(Oo.h)(Hi.setPropertyServerIdsMap(Object(Vi.a)({},l,((u={})[n.uniqueId]={serverId:n.data.id,authorId:n.data.authorId},u))));case 50:return h.next=52,Object(Oo.h)(Yi({id:n.uniqueId,timestamp:n.timestamp,authorType:"agent",text:n.data.message,isMobile:n.data.isMobile,authorId:n.data.authorId,serverId:n.data.id,json:n.data.json}));case 52:return h.abrupt("break",112);case 53:return h.next=55,Object(Oo.h)(Ji(n.data));case 55:return h.next=57,Object(Oo.h)(Hi.setPropertyChatState(ks));case 57:return h.next=59,Object(Oo.j)(po.getPropertyHistoryLoaded);case 59:return d=h.sent,h.next=62,Object(Oo.j)(po.getPropertyLicense);case 62:if(p=h.sent,nc.removeItem("securedToken"),nc.removeOldSecretTokenCookie(p),d){h.next=68;break}return h.next=68,Object(Oo.h)(Hi.removePropertySecuredToken());case 68:return h.abrupt("break",112);case 69:return h.next=71,Object(Oo.h)(Ki({id:n.data.id,name:n.data.name,jobTitle:n.data.jobTitle,avatarUrl:rc(n.data.avatarUrl),trigger:n.data.trigger}));case 71:return h.next=73,Object(Oo.j)(po.getPropertyChatId);case 73:if(h.sent){h.next=77;break}return h.next=77,Object(Oo.h)(Hi.setPropertyChatId(n.data.chatId));case 77:return h.abrupt("break",112);case 78:return h.next=80,Object(Oo.h)($i({numberInQueue:n.data.numberInQueue,waitingTime:n.data.waitingTime}));case 80:return h.abrupt("break",112);case 81:return h.next=83,Object(Oo.h)(eo({authorId:n.data.authorId,isTyping:n.data.isTyping}));case 83:return h.abrupt("break",112);case 84:return h.t3=Oo.h,h.t4=o,h.next=88,Object(Oo.j)(po.getPropertyVisitorCustomIdMap);case 88:return h.t5=n.data.id,h.t6=h.sent[h.t5],h.t7=n.data.id,h.t8={id:h.t6,customId:h.t7,type:"visitor"},h.t9=h.t4.messageSeen.call(h.t4,h.t8),h.next=95,(0,h.t3)(h.t9);case 95:return h.abrupt("break",112);case 96:return h.next=98,Object(Oo.h)(uo({id:String(n.uniqueId),timestamp:n.timestamp,integrationName:n.data.integrationName,data:n.data.data}));case 98:return h.abrupt("break",112);case 99:return h.next=101,Object(Oo.j)(po.getPropertyServerIdsMap);case 101:if(f=h.sent,m=null,f){h.next=105;break}return h.abrupt("break",112);case 105:if(Object(x.q)((function(e,t){e.serverId===n.data.message.id&&(m=t)}),f),m){h.next=108;break}return h.abrupt("break",112);case 108:return h.next=110,Object(Oo.h)(co({id:m,customId:n.data.message.id,type:"agent"}));case 110:return h.abrupt("break",112);case 111:return h.abrupt("return");case 112:case"end":return h.stop()}}),yp)}function _p(){var e,t;return jo.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Oo.a)(Jd.getActionName(),go.b.expanding());case 2:e=n.sent;case 3:return n.next=6,Object(Oo.l)(e);case 6:return t=n.sent,n.next=9,Object(Oo.c)(xp,t);case 9:n.next=3;break;case 11:case"end":return n.stop()}}),jp)}var Cp=jo.a.mark(Tp),wp=jo.a.mark(Ap),Ep=jo.a.mark(Pp),Ip=[xo,zo,Vo,Do,Wi].map((function(e){return e.getActionName()})),Sp=function(e){var t=e.type,n=e.payload;return t===Hi.setPropertyClientLimitExceeded.getActionName()&&!0===n.data},kp=function(e){var t=e.type,n=e.payload;return t===Hi.setPropertyClientLimitExceeded.getActionName()&&!1===n.data};function Tp(){var e,t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,$o(Object(Oo.e)(dp));case 2:e=r.sent;case 3:return r.next=6,Object(Oo.i)([Object(Oo.l)(Ip),Object(Oo.l)(kp)]);case 6:return r.next=8,$o(Object(Oo.e)(id));case 8:return t=r.sent,r.next=11,$o(Object(Oo.e)(td));case 11:return n=r.sent,r.next=14,Object(Oo.i)([Object(Oo.l)(ko.getActionName()),Object(Oo.l)(Sp)]);case 14:return r.next=16,Object(Oo.h)(Hi.setPropertyPingSent(void 0));case 16:return r.next=18,Object(Oo.d)(t,e,n);case 18:r.next=3;break;case 20:case"end":return r.stop()}}),Cp)}function Ap(){var e,t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,Object(Oo.l)(Hi.setPropertyGroup);case 3:return e=r.sent,t=e.payload.data,r.next=7,Object(Oo.j)(po.getPropertyLicense);case 7:n=r.sent,nc.setPrefix("_livechat_"+n+"_"+t),r.next=0;break;case 11:case"end":return r.stop()}}),wp)}function Pp(e){var t,n;return jo.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.emitter,n=e.serverConfig,r.next=3,Object(Oo.j)(po.getPropertyChatBetweenGroups);case 3:if(!1!==r.sent){r.next=7;break}return r.next=7,$o(Object(Oo.e)(Ap));case 7:return r.next=9,$o(Object(Oo.e)(Fl));case 9:return r.next=11,$o(Object(Oo.e)(Yd,{emitter:t}));case 11:return r.next=13,$o(Object(Oo.e)(_p));case 13:return r.next=15,$o(Object(Oo.e)(Tp));case 15:return r.next=17,Object(Oo.c)(Is,n);case 17:case"end":return r.stop()}}),Ep)}var Np="undefined"!==typeof document,Mp=function(e){return function(t){var n=void 0===t?{}:t,r=n.text,a=n.customId,i=n.json,o=Object(Fi.a)();return r&&a?(e.dispatch(xo({customId:a,text:r,json:i,promise:o})),o.promise):(o.reject({type:"missing argument",reason:"Missing text or customId parameter"}),o.promise)}},zp=function(e){return function(t){var n=t.text,r=Object(Fi.a)();return e.dispatch(Eo({text:n,promise:r})),r.promise}},Rp=function(e){return function(t){var n=void 0===t?{}:t,r=n.rate,a=n.comment,i=Object(Fi.a)();return r||a?r&&"good"!==r&&"none"!==r&&"bad"!==r?(i.reject({type:"wrong argument",reason:'Rate argument should be equal "good", "bad" or "none"'}),i.promise):(e.dispatch(wo({rate:r,comment:a,promise:i})),i.promise):(i.reject({type:"missing argument",reason:"Missing rate parameter"}),i.promise)}},Dp=function(e){return function(t){var n=(void 0===t?{}:t).email,r=Object(Fi.a)();return n?(e.dispatch(Io({email:n,promise:r})),r.promise):(r.reject({type:"missing argument",reason:"Missing email parameter"}),r.promise)}},Lp=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(So({promise:t})),t.promise}},Bp=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(ko({promise:t})),t.promise}},qp=function(e,t){return function(){t.off("*"),e.cancel()}},Up=function(e){return function(t){var n=(void 0===t?{}:t).group,r=Object(Fi.a)();return e.dispatch(To({promise:r,group:n})),r.promise}},Fp=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(Ro({promise:t})),t.promise}},Vp=function(e){return function(t){var n=void 0===t?{}:t,r=n.file,a=n.onProgress,i=String(Math.random()),o=Object(Fi.a)();return r?r.size>10485760?(o.reject({type:"wrong argument",reason:"Cannot upload a file over 10MB"}),o.promise):(e.dispatch(Po({file:r,customId:i,promise:o,onProgress:a})),{then:function(e,t){return o.promise.then(e,t)},catch:function(e){return o.promise.catch(e)},cancel:function(){e.dispatch(No({customId:i}))}}):(o.reject({type:"missing argument",reason:"Missing file"}),o.promise)}},Gp=function(e){return function(t){void 0===t&&(t={});var n=Object(Fi.a)();return e.dispatch(Ao({answers:t,promise:n})),n.promise}},Hp=function(e){return function(t){var n=void 0===t?{}:t,r=n.name,a=n.email,i=n.customProperties,o=n.pageUrl,c=n.pageTitle,s=n.update,u=Object(Fi.a)();return r||a||i||o||c?(e.dispatch(_o({name:r,email:a,customProperties:i,pageUrl:o,pageTitle:c,update:s,promise:u})),u.promise):(u.reject({type:"missing argument",reason:"Missing name, email, url or customProperties"}),u.promise)}},Wp=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(Co({promise:t})),t.promise}},Yp=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(Mo({promise:t})),t.promise}},Jp=function(e){return function(t){void 0===t&&(t={});var n=Object(Fi.a)();return e.dispatch(zo({promise:n,answers:t})),n.promise}},Kp=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(Do({promise:t})),t.promise}},Qp=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(Lo({promise:t})),t.promise}},Zp=function(e){return function(t){void 0===t&&(t={});var n=Object(Fi.a)();return e.dispatch(Bo({promise:n,answers:t})),n.promise}},Xp=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(qo({promise:t})),t.promise}},$p=function e(t){return function(n){var r=Object(Fi.a)();return t.dispatch(Uo({id:n,promise:r})),e.promise}},ef=function(e){return function(t){var n=Object(Fi.a)();return e.dispatch(Fo({promise:n,messageId:t})),n.promise}},tf=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(Vo({promise:t})),t.promise}},nf=function(e){return function(t){var n="undefined"!==typeof t?parseInt(t,10):void 0,r=Object(Fi.a)();return e.dispatch(Go({promise:r,group:n})),r.promise}},rf=function(e){return function(t){e.dispatch(Ho({group:parseInt(t,10)}))}},af=function(e){return function(){var t=Object(Fi.a)();return e.dispatch(Wo({promise:t})),t.promise}},of=function(e,t){var n,r=void 0===e?{}:e,a=r.license,i=r.group,o=r.environment,c=void 0===o?"production":o,s=r.page,u=void 0===s?{}:s,l=r.visitor,d=void 0===l?{}:l,p=r.region,f=r.external,m=void 0===f||f,h=r.mobile,v=void 0!==h&&h;if(!a)throw new Error("Missing license parameter");if("production"!==c&&"labs"!==c&&"staging"!==c)throw new Error("Wrong environment parameter");var g=Object(R.a)(),b=g.emit,y=[];g.emit=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.push(t)},setTimeout((function(){g.emit=b,y.forEach((function(e){g.emit.apply(g,e)})),y=null}),0);var j=String(Math.random()),O=function(e){if(void 0===e&&(e={}),e.__lc&&!1===e.__lc.chat_between_groups)return!1;var t=Object(x.u)("location.href",Np&&document),n=t&&Object(I.h)(t);return!(n&&"1"===n.unique_groups||"1"===n.unique_group)}(t);O?nc.setPrefix("_livechat_"+a):nc.setPrefix("_livechat_"+a+"_"+i);var _=((n={environment:c})[Gi.LICENSE]=a,n[Gi.GROUP]=i,n[Gi.SESSION_ID]=j,n[Gi.MOBILE]=v,n.visitorData={email:d.email||null,name:d.name||null,pageUrl:u.url||Object(x.v)("unknown","location.href",Np&&document),pageTitle:u.title||Object(x.v)("unknown","0.innerHTML",Np&&document.getElementsByTagName("title")||{}),pageReferrer:u.referrer,customProperties:d.customProperties&&!Object(x.B)(d.customProperties)?d.customProperties:null},n[Gi.SECURED_TOKEN]=nc.getItem("securedToken")||nd("secret_token_"+a),n[Gi.SECRET_ID]=nc.getItem("secretId"),n[Gi.CHAT_BETWEEN_GROUPS]=O,n);p&&(_[Gi.REGION]=p);var C=bo(_,{external:m}),w=nc.getItem("visitorId");w&&C.dispatch(Hi.setPropertyVisitorId(w));var E=C.runSaga(Pp,{emitter:g,serverConfig:t});return{sendMessage:Mp(C),setSneakPeek:zp(C),setVisitorData:Hp(C),getVisitorData:Wp(C),rateChat:Rp(C),forwardChatTranscript:Dp(C),closeChat:Lp(C),disconnect:Bp(C),getTicketForm:Up(C),getTranslations:Fp(C),sendTicketForm:Gp(C),sendFile:Vp(C),on:g.on,off:g.off,destroy:qp(E,g),getPrechatForm:Yp(C),sendPrechatForm:Jp(C),getPredictedAgent:Kp(C),getPostChatForm:Qp(C),sendPostChatForm:Zp(C),getConfig:Xp(C),acceptInvitation:$p(C),markMessageAsSeen:ef(C),startChat:tf(C),checkGroupStatus:nf(C),setVisitorGroup:rf(C),getQueueForm:af(C)}};var cf,sf=function(e){var t=Object.keys(e);return Promise.all(Object(x.rb)(e)).then((function(e){return Object(x.r)(Object(x.sb)(t,e))}))},uf=function(e){var t=e.id,n=e.serverId,r=void 0===n?t:n,a=e.thread,i=void 0===a?null:a,o=e.author,c=e.timestamp,s=e.seen;return{id:t,serverId:r,thread:i,author:o,timestamp:c,seen:void 0!==s&&s}},lf=function(e){e.id,e.customId,e.author,e.timestamp,e.thread,e.properties,e.seen,e.serverId,e.type,e.text,e.urlDetails;return Object(w.a)(e,["id","customId","author","timestamp","thread","properties","seen","serverId","type","text","urlDetails"])},df=function(e){if(e.urlDetails){var t=e.urlDetails;return Object(C.a)({},uf(e),{type:"url_preview",properties:{serverType:e.type,title:t.title,description:t.description,image:{url:t.imageUrl,link:t.url}}})}return qa(e.text)?Object(C.a)({},uf(e),{type:"emoji",properties:Object(C.a)({serverType:e.type,text:e.text},lf(e))}):Object(C.a)({},uf(e),{type:"message",properties:Object(C.a)({serverType:e.type,text:e.text},lf(e))})},pf=function(e){return e.replace(/\w/g,"$&[\\r\\n\\t]*")},ff=new RegExp("^[\0-\x1f]*("+pf("javascript")+"|"+pf("data")+"):","i"),mf=function(e){return ff.test(e)},hf=function(e){switch(e.type){case"url":return mf(e.value)?null:e;case"webview":if(mf(e.value))return null;var t=Object(I.d)(e.value);if(!t)return e;if(/chatbot\.com$/.test(t)){var n=Object(I.b)(Object(I.k)(Object(I.i)(e.value)));if(n.p)try{var r=JSON.parse(atob(n.p));if(r.url)return Object(C.a)({},e,{proxiedValue:r.url})}catch(a){return e}}return e;default:return e}},vf=function(e){var t={};return"string"===typeof e.title&&(t.title=e.title),"string"===typeof e.subtitle&&(t.subtitle=e.subtitle),e.image&&(t.image=e.buttons?e.image:Object(C.a)({},e.image,{link:e.image.url})),e.buttons&&(t.buttons=e.buttons.map(hf).filter(Boolean)),t},gf=function(e){switch(e.template){case"quick_replies":var t=e.elements[0];return Object(C.a)({},uf(e),{type:"message",properties:{serverType:e.type,text:t.title,quickReplies:t.buttons.map((function(e){return{text:e.text,value:e.value,postback:e.postback}}))}});case"sticker":var n=e.elements[0].image;return Object(C.a)({},uf(e),{type:"sticker",properties:{serverType:e.type,url:n.url,name:n.name}});default:if(e.elements.length>1)return Object(C.a)({},uf(e),{type:"carousel",properties:{serverType:e.type,cards:e.elements.map(vf)}});var r=e.elements[0];if(1===Object.keys(r).length&&r.image){var a=r.image;return Object(C.a)({},uf(e),{type:"image_preview",properties:{serverType:e.type,url:a.url}})}return Object(C.a)({},uf(e),{type:"rich_message",properties:{serverType:e.type,card:vf(r)}})}},bf=function(e){if(e.thumbnails){var t=e.thumbnails,n=Object(C.a)({},uf(e),{type:"image_preview",properties:Object(C.a)({serverType:e.type},t.default,{link:e.url})});return t.high&&(n.properties.srcSet=t.default.url+" 1x, "+t.high.url+" 2x"),n}return Object(C.a)({},uf(e),{type:"message",properties:{serverType:e.type,text:e.name,url:e.url}})},yf=function(e){var t=Object(C.a)({},uf(e),{type:"system_message",properties:{serverType:e.type,systemMessageType:e.systemMessageType,defaultText:e.text}});return e.textVars&&(t.properties.textVariables=e.textVars),t},jf={group_select:"select",name:"text",subject:"text"},Of=function(e){return e.replace(/index[0-9]*_/gi,"")},xf=function(e,t){var n=Object(x.k)((function(e){return"groupSelect"===e.meta}),e);return Object.keys(t).reduce((function(r,a){var i=t[a];if("rateComment"===a)return r.rateComment=i,r;if("rating"===a)return r.rate=null===i?i:Of(i),r;var o=Object(x.k)((function(e){return e.name===a}),e),c=o.serverName;return n&&c&&c===n.serverName&&(r.choosenGroupIndex=t[n.name].match(/index([0-9]*)_/)[1],r.choosenGroup=parseInt(Of(i),10)),o.options?r.fields[c]=Object(x.A)(i)?i.map(Of):Of(i):r.fields[c]=i,r}),{fields:{}})},_f=function(e,t){return Object(C.a)({},t,{type:e,fields:t.fields.reduce((function(e,t){var n=t.name,r=Object(w.a)(t,["name"]),a=Object(C.a)({},r,{type:jf[r.type]||r.type,serverType:r.type});if(a.options){a.options=a.options.map((function(e,t){return Object(C.a)({},e,{value:"index"+t+"_"+e.value,originalValue:e.value})}));var i=a.options.filter((function(e){return e.checked}));i.length&&(a.defaultValue=i.map((function(e){return e.value})))}if("information"===r.type&&(a.value=a.value.replace(/<br(\s)?(\/)?>/gi,"\n")),"group_select"===r.type&&(a.meta="groupSelect",a.options=a.options.map((function(e){return Object(C.a)({},e,{groupNumber:parseInt(e.originalValue,10)})}))),n&&(a.serverName=n),"name"===r.type)a.name="name";else if("email"===r.type)a.name="email";else{if("rating"===r.type)return a.name="rating",[].concat(e,[a,{name:"rateComment",type:"textarea",label:a.commentLabel,required:!1,dependOn:"rating"}]);n&&(a.name="name_"+n)}return[].concat(e,[a])}),[])})},Cf=function(e,t){return e.filter((function(e){return e.serverName in t})).map((function(e){return{type:e.type,label:e.label,value:e.options?Object(x.i)(t[e.serverName]).map((function(t){return Object(x.k)((function(e){return e.originalValue===t}),e.options).label})).join(", "):t[e.serverName]}}))},wf=function(e,t){var n=e.getEvent("liveChatChatId",t),r=n.author,a=n.timestamp,i=n.properties.text,o=e.getUser(r),c=o.type,s={text:i,timestamp:Math.floor(a/1e3),user_type:"agent"===c?c:"visitor"};"agent"===c?(s.agent_name=o.name,s.agent_login=o.id):s.visitor_name=o.name,e.emit("on_message",s)},Ef=function(e,t,n,r){e.emit("on_"+t+"_survey_submitted",{form_data:Cf(n,r)})},If=function(e,t,n){Ef(e,"prechat",t,n)},Sf=function(e,t,n){Ef(e,"postchat",t,n)},kf=function(e,t){e.emit("on_rating_comment_submitted",t)},Tf=function(e,t){e.emit("on_rating_submitted",null===t?"none":t)},Af=function(e,t,n){e.emit("on_message",{text:t.properties.text,timestamp:n/1e3,user_type:"visitor",visitor_name:e.getSessionUser().name})},Pf=function(e,t,n,r){var a=r.id,i=r.text,o=r.visitor,c=o.email,s=o.name,u=r.subject,l={form_data:Cf(t,n),ticket_id:a,text:i,visitor_name:s,visitor_email:c};u&&(l.ticket_subject=u),e.emit("on_ticket_created",l)},Nf=function(e,t){return new Promise((function(n){var r=Object(x.l)((function(e){return"groupSelect"===e.meta}),t);if(-1!==r){var a,i=t[r],o=i.options.map((function(e){return parseInt(e.groupNumber,10)}));(a=o.map(e.checkGroupStatus),Promise.all(a.map((function(e){return e.then((function(e){return{status:"fulfilled",value:e}}),(function(e){return{status:"rejected",reason:e}}))})))).then((function(e){n(Object(x.qb)(r,Object(C.a)({},i,{options:Object(x.tb)((function(e,t){return"fulfilled"!==t.status?e:Object(C.a)({},e,{meta:{online:"online"===t.value.groupStatus}})}),i.options,e)}),t))}))}else n(null)}))},Mf=function(e){return Object(C.a)({},e,{serverId:null,timestamp:Date.now(),seen:!0,properties:e.properties?e.properties:{}})},zf=function(e,t,n){return Mf(Object(C.a)({id:Object(x.t)(e.getIndexedEvents("liveChatChatId")),type:"system_message",author:"system",systemMessageType:t},Object(x.d)({textVars:n})))},Rf=function(e,t){var n=xf(e,t),r=n.fields;return{properties:{fields:e.filter((function(e){return void 0!==e.serverName&&"rating"!==e.type&&"information"!==e.type&&(!e.meta||"confirm_subscription"!==e.meta)})).map((function(e){var t=e.label,a=e.serverName;if("groupSelect"===e.meta)return{label:t,answer:e.options[n.choosenGroupIndex].label};if(Object(x.A)(e.options)){var i=Object(x.x)(a,r)?Object(x.i)(r[a]):[],o=e.options.filter((function(e){return Object(x.z)(e.originalValue,i)})).map((function(e){return e.label}));return 0===o.length?null:{label:t,answer:"checkbox"===e.type?o:o[0]}}return Object(x.x)(a,r)?{label:t,answer:r[a]}:null})).filter(Boolean)}}},Df=function(e,t,n){var r=e.license,a=e.group,i=e.region,o=e.mobile;t.setApplicationState({eagerFetchingMode:!0});var c=t.getSessionUser(),s={name:c.name,email:c.email};c.properties&&(s.customProperties=c.properties);var u={license:r,environment:"production",page:t.getApplicationState("page"),visitor:s,external:!1,region:i,mobile:o};null!==a&&(u.group=a);var l=of(u,n);var d=function(e){void 0===e&&(e=!1);var t=[],n=e;return{add:function(e){n?e():t.push(e)},run:function(){n=!0;var e=t;t=[],e.forEach((function(e){return e()}))},pause:function(){n=!1}}}(),p=function(e){return function(t){return d.add((function(){return e(t)}))}};t.setApplicationState({isReturning:n.visitor.visit_number>1,clientChatNumber:n.visitor.chat_number||0,clientVisitNumber:n.visitor.visit_number||0});var f=function(){l.destroy(),t.setApplicationState({destroyed:!0})},m=function(){return l.getPredictedAgent().then((function(e){if(!e.id){var n=new Error;throw n.code="MISSING_PREDICTED_AGENT",n}var r=e.name,a=e.id,i=e.avatarUrl,o=e.jobTitle,c=e.message,s=e.isBot;return t.hasUser(a)||t.addUser({id:a,name:r,type:"agent",avatar:i,properties:{jobTitle:o,isBot:s||!1}}),{agent:e,message:Mf({id:Object(x.t)(t.getIndexedEvents("liveChatChatId")),type:"message",author:a,text:tr(t,c,{agent:r}),originalText:c,welcomeMessage:!0})}}))},h=!1,v=function(){var e=t.getChat("liveChatChatId"),n=e.active,r=e.properties,a=r.queued,i=r.ended;if(!(n||a||i)){if(!Bn(t))return t.updateView("minimized",{hidden:!0}),t.setDefaultView("Chat","timeline"),Oi(t),void(Fn(t)&&Ii(t));if(Un(t,"offline")){if(Hn(t))return;pi(t)}else l.getTicketForm().then((function(e){t.updateView("Chat/offline",_f("offline",e)),Hn(t)||pi(t)}),f)}},g=function(){var e=t.getChat("liveChatChatId"),n=e.active,r=e.properties,a=r.queued,i=r.ended;if(Yn(t)||_i(t),Kn(t)&&Ci(t),n)t.setDefaultView("Chat","timeline");else if(!a&&!i){var o=t.getApplicationState().maximized;t.updateView("minimized",{hidden:!1}),qn(t,"prechat")||(On(t,"liveChatChatId")?xi(t):Ln(t)?ai(t):o&&(h||(h=!0,m().then((function(e){var n=e.agent,r=e.message;h=!1;var a=t.getEvents("liveChatChatId").some((function(e){return!e.own&&"system"!==e.author}));if("offline"!==t.getApplicationState("availability")&&!a){var i=n.id;if(n.isBot)return l.startChat();xi(t),ri(t,i),j(r),t.updateChat("liveChatChatId",{properties:{fakeAgentMessageId:r.id}})}}),(function(e){if("MISSING_PREDICTED_AGENT"===e.code)return l.startChat();throw e})).finally((function(){h=!1})).catch(f))))}},b=function(e){var n=e.id,r=e.authorId,a=e.text,i=e.receivedFirstTime;l.acceptInvitation(n),t.getChat("liveChatChatId").properties.ended&&oi(t,"liveChatChatId"),di(t,{authorId:r,text:a,receivedFirstTime:i})},y=function(e){var n=t.getSessionUser();return n.serverId===e.author?n.id:e.author},j=function(e){var n=function(e){var t=Object(C.a)({},e,{id:String(e.id),author:y(e),thread:null,properties:{}});switch(t.type){case"message":return df(t);case"rich_message":return gf(t);case"file":return bf(t);case"system_message":return yf(t);default:return void 0}}(e);Wa(t,"liveChatChatId",n),"message"===n.properties.serverType&&t.getApplicationState("ready")&&wf(t,n.id),t.getChat("liveChatChatId").properties.agentIsTyping&&n.author!==t.getSessionUser().serverId&&t.updateChat("liveChatChatId",{properties:{agentIsTyping:!1}})},O=function(e){return e.buttons?Object(C.a)({},e,{buttons:e.buttons.map((function(e){var t={text:e.text,type:e.type,value:e.value,users:e.user_ids,postback:e.postback_id};return e.webview_height&&(t.webviewHeight=e.webview_height),t}))}):e},_=function(e){return e.elements?Object(C.a)({},e,{elements:e.elements.map(O)}):e},E=function(e){t.updateChat("liveChatChatId",{properties:{rate:e}}),j(zf(t,"good"===e?"rate_me_confirmation_good":"bad"===e?"rate_me_confirmation_bad":"rate_me_cancel"))},I=new Promise((function(e){l.on("ready",(function t(){l.off("ready",t),e()}))})),S=new Promise((function(e){l.on("status_changed",(function t(){l.off("status_changed",t),e()}))}));Promise.all([l.getTranslations(),l.getPrechatForm().catch((function(){return null})),l.getConfig(),I,S]).then((function(e){var n=e[0],r=e[1],a=e[2];t.setLocalization(n),ci(a,t),r&&t.updateView("Chat/prechat",_f("prechat",r)),d.run(),Cn("liveChatChatId",t)&&$a(t),"offline"===t.getApplicationState().availability?v():g(),t.setApplicationState({ready:!0}),Yn(t)&&Ei(t)})),l.on("visitor_data",p((function(e){t.getSessionUser().serverId||yi(t,e.id);var n=Object(x.Z)(["email","name"],e);Object(x.B)(n)||t.updateUser(t.getSessionUserId(),n)}))),l.on("chat_ended",p((function(e){switch(e.reason){case"inactivity":j(zf(t,"client_inactive"));break;case"closed_by_agent":j(zf(t,"operator_closed_session",{operator:un("liveChatChatId",t).name}));break;case"closed":j(zf(t,"chat_closed_by_customer"));break;default:j(zf(t,"chat_session_closed"))}Ka(t),t.setDefaultView("Chat","loader"),l.getPostChatForm().then((function(e){ii(t,_f("postchat",e)),t.setDefaultView("Chat","timeline")}),(function(){t.setDefaultView("Chat","timeline")}))}))),l.on("chat_started",p((function(e){var n=e.chatId;ei(t,{id:n})}))),l.on("status_changed",(function(e){var n=e.status;t.setApplicationState({availability:n}),t.getApplicationState().ready&&("offline"===n?v():g())})),l.on("agent_changed",p((function(e){var n=e.id,r=e.name,a=e.avatarUrl,i=e.jobTitle,o=e.fromInvitation,c=e.trigger;if(!o||xn(t)){var s=t.getChat("liveChatChatId").properties,u=s.ended,l=s.queued;(u||"manual_invitation"===c||"other_tab"===c)&&oi(t,"liveChatChatId"),l&&(t.updateChat("liveChatChatId",{properties:{queued:!1}}),_i(t));var d=un("liveChatChatId",t);null!==d&&d.id!==n&&j(zf(t,"user_transfer",{operator:r})),t.hasUser(n)||(t.addUser({id:n,name:r,type:"agent",avatar:a,properties:{jobTitle:i}}),t.addParticipant("liveChatChatId",n)),ri(t,n)}}))),l.on("new_invitation",p((function(e){xn(t)&&(qn(t,"postchat")?t.updateChat("liveChatChatId",{properties:{postponedInvitation:e}}):_n("liveChatChatId",t)&&b(e))}))),l.on("new_message",p((function(e){var n=e.id,r=e.authorId,a=e.timestamp,i=e.text,o=e.customId,c=e.json;if(!t.hasEvent("liveChatChatId",o)){var s="welcome_message"===n,u=t.getEvents("liveChatChatId").some((function(e){return e.properties.welcomeMessage||e.properties.invitation}));if(!s||!u){var l={id:n,author:r,timestamp:a,seen:!1};c&&"rich_message"===c.type&&c.payload?j(Object(C.a)({},l,_(c.payload),{template:c.payload.template_id,type:"rich_message"})):(j(Object(C.a)({},l,{type:"message",text:s?tr(t,i):i})),s&&t.updateChat("liveChatChatId",{properties:{fakeAgentMessageId:n}}))}}}))),l.on("new_file",p((function(e){var n=e.id,r=e.authorId,a=e.timestamp,i=e.url,o=e.customId,c=e.thumbnail;if(!t.hasEvent("liveChatChatId",o)){var s={id:n,type:"file",author:r,timestamp:a,url:i,name:decodeURIComponent(Object(x.G)(i.split("/")))};c&&(s.thumbnails={default:{url:c.url}}),j(s)}}))),l.on("chat_rated",p((function(e){var n=e.rate,r=e.comment;n&&("none"===n?(E(null),t.updateChat("liveChatChatId",{properties:{rateComment:null}})):E(n));r&&function(e){t.updateChat("liveChatChatId",{properties:{rateComment:e}}),j(zf(t,"rate_me_comment_added",{comment:e}))}(r)}))),l.on("message_seen",p((function(e){if("agent"!==e.type){var n=t.hasEvent("liveChatChatId",e.id)?e.id:e.customId;t.hasEvent("liveChatChatId",n)&&t.updateEvent("liveChatChatId",n,{seen:!0})}else(function(e,t,n){var r=n.getSessionUserId();return fn(e,{authorPredicate:function(e){return e.author===r},lastSeenPredicate:function(e){return e.serverId===t}},n)})("liveChatChatId",e.id,t).forEach((function(e){t.updateEvent("liveChatChatId",e.id,{seen:!0})}))}))),l.on("visitor_queued",p((function(e){Oi(t),t.updateChat("liveChatChatId",{properties:{queued:!0}});var n=e.numberInQueue,r=e.waitingTime;t.updateView("Chat/queue",{numberInQueue:n,waitingTime:r}),t.getView("Chat/queue").template||l.getQueueForm().then((function(e){var n;t.updateView("Chat/queue",{template:(n=e,n.fields.find((function(e){return"information"===e.type})).value)})}),x.P),Ei(t)}))),l.on("connection_status_changed",p((function(e){var n=e.status;t.setConnectionState("disconnected"===n?sn:n)}))),l.on("typing_indicator",p((function(e){var n=e.isTyping,r=t.getChat("liveChatChatId").properties,a=r.agentIsTyping,i=!!r.messageDraft;t.updateChat("liveChatChatId",{properties:{agentIsTyping:a?n:n&&!i}})}))),l.on("protocol_upgraded",p((function(){t.emit("protocol_upgraded",{version:"3"})}))),l.on("integration_data",p((function(e){var n=e.id,r=e.integrationName,a=e.data;if("joinme"===r){var i=un("liveChatChatId",t);j(function(e,n,r){return{id:e,author:r.id,type:"rich_message",template:"default",elements:[{title:t.localize("joinme_info").replace(/<(\/)?strong>/gi,"").replace(/<br>/gi,"\n").replace(/%sender%/gi,r.name),buttons:[{text:t.localize("button_allow"),type:"url",value:n.link},{text:t.localize("button_link_cancel"),type:"message",value:t.localize("joinme_session_rejected")}]}]}}(n,a,i))}}))),t.on("request_update_event",(function(e){var n=t.getEvent("liveChatChatId",e.id);if(e.data.seen)l.markMessageAsSeen(n.serverId).then(e.resolve,x.P);else if("offline"===n.properties.formType){var r=e.data.properties.answers,a=xf(n.properties.fields,r).fields;l.sendTicketForm(a).then((function(r){Pf(t,n.properties.fields,a,r),e.resolve(),li(t,e.id),t.setCurrentView("Chat")}),(function(n){wi(n,t.localize,e.reject)}))}else if("prechat"===n.properties.formType){var i=e.data.properties.answers,o=n.properties.fields,c=xf(o,i);If(t,o,c.fields);var s=function n(){l.off("__start_chat_request_succeeded",n),li(t,e.id,Rf(o,i))};if(l.on("__start_chat_request_succeeded",s),"number"===typeof c.choosenGroup){var u=Object(x.k)((function(e){return"groupSelect"===e.meta}),o),d=Object(x.k)((function(e){return e.groupNumber===c.choosenGroup}),u.options);return t.updateFeature("offlineForm",{enabled:!d.ticketFormDisabled}),l.setVisitorGroup(c.choosenGroup),void l.checkGroupStatus(c.choosenGroup).then((function(n){return"offline"===n.groupStatus?d.ticketFormDisabled?void v():l.getTicketForm({group:c.choosenGroup}).then((function(e){t.updateView("Chat/offline",_f("offline",e)),v()})):l.sendPrechatForm(Object(C.a)({},c.fields,{choosenGroupIndex:c.choosenGroupIndex})).then((function(){e.resolve()}))})).catch((function(){l.off("__start_chat_request_succeeded",s),f()}))}l.sendPrechatForm(c.fields).then((function(){e.resolve()}),(function(){l.off("__start_chat_request_succeeded",s),e.reject()}))}else if("postchat"===n.properties.formType){var p=e.data.properties.answers,m=n.properties.fields,h=xf(m,p);Sf(t,m,h.fields);var g=null;if(Object(x.x)("rate",h)){var y=t.getChat("liveChatChatId").properties,j=y.rate,O=y.rateComment,_={},w=j&&h.rate!==j,E=!j&&h.rate;if((w||E)&&(_.rate=h.rate,Tf(t,_.rate)),Object(x.x)("rateComment",h)&&h.rateComment!==O&&(_.comment=h.rateComment,kf(t,_.comment)),!Object(x.B)(_)){var I=t.getApplicationState().testGroup;sr({testGroup:I,chatRating:null===_.rate?"canceled":_.rate,chatRatingSource:"postchat"}),g=l.rateChat(_).then((function(){t.updateChat("liveChatChatId",{properties:Object(x.Z)(["rate","rateComment"],h)})}),x.P)}}Promise.all([l.sendPostChatForm(h.fields),g].filter(Boolean)).then((function(){e.resolve(),li(t,e.id,Rf(m,p));var n=t.getApplicationState().availability,r=t.getChat("liveChatChatId").properties.postponedInvitation;"online"===n&&r?Promise.resolve().then((function(){t.updateChat("liveChatChatId",{properties:{postponedInvitation:void 0}}),b(r),t.setDefaultView("Chat","timeline")})):t.setDefaultView("Chat","timeline")}))}})),t.on("request_update_chat",(function(e){var n=e.resolve,r=e.reject,a=e.data,i=a.properties,o=void 0===i?{}:i,c=Object(w.a)(a,["properties"]);if(o.rateComment)kf(t,o.rateComment),l.rateChat({comment:o.rateComment}).then(n).catch(r);else if("undefined"!==typeof o.rate){Tf(t,o.rate);var s=null===o.rate,u=t.getApplicationState().testGroup;sr({testGroup:u,chatRating:s?"canceled":o.rate,chatRatingSource:"other"}),l.rateChat({rate:s?"none":o.rate}).then((function(){s&&t.updateChat("liveChatChatId",{properties:{rateComment:null}}),n()})).catch(r)}else o.transcriptSentTo?l.forwardChatTranscript({email:o.transcriptSentTo}).then(n).catch(r):!1===c.active?l.closeChat().then(n).catch(r):"string"===typeof o.messageDraft&&l.setSneakPeek({text:o.messageDraft}).then(n).catch(r)})),t.on("request_update_user",(function(e){var n=e.resolve,r=e.id,a=e.data,i=a.properties,o=Object(w.a)(a,["properties"]);t.getSessionUserId()===r&&(i&&(o.customProperties=i,o.update=!0),l.setVisitorData(o).then(n,x.P))})),t.on("request_set_user_properties",(function(e){var n=e.resolve,r=e.id,a=e.properties;if(t.getSessionUserId()===r){var i={};a&&(i.customProperties=a,i.update=!1),l.setVisitorData(i).then(n,x.P)}})),t.on("update_event",(function(e){var n=e.event;"file"===n.type&&n.properties.canceled&&Ja(t,n.id)})),t.on("send_event",(function(e){var n=e.event,r=e.meta;if("file"===n.type)Ya(t,n.id),l.sendFile({file:r.file,onProgress:function(e){t.updateEvent("liveChatChatId",n.id,{properties:{progress:e}})}}).then((function(e){var r=e.id,a=e.url;t.setEventServerId("liveChatChatId",n.id,r),t.updateEvent("liveChatChatId",n.id,{delivered:!0,properties:{url:a}}),Ja(t,n.id)})).catch((function(e){var r={failed:!0,failReason:"Cannot upload a file over 10MB"===e.reason?t.localize("cannot_upload_a_file_over_10mb"):t.localize("upload_failed")};t.updateEvent("liveChatChatId",n.id,{properties:r})}));else if("message"===n.type||"emoji"===n.type){var a={customId:n.id,text:n.properties.text},i=n.properties.triggeredBy;if(i){var o=t.getEvent("liveChatChatId",i.event);a.json={postback:{id:i.button.postback,type:"message",value:i.button.value,event_id:o.serverId}}}l.setSneakPeek({text:""}),l.sendMessage(a).then((function(e){Af(t,n,e.timestamp),t.setEventServerId("liveChatChatId",n.id,e.id),t.updateEvent("liveChatChatId",n.id,{delivered:!0})}),(function(){t.updateEvent("liveChatChatId",n.id,{failed:!0})}))}}));var k=Pr()(ea(t,(function(e){return e.application.destroyed})),jr()(Boolean),Qr()(1),Hr.a);Pr()(ea(t,(function(e){return e.application.page})),Jr()(1),Object(Zr.a)(k),_r()((function(e){var t=e.title,n=e.url;return l.setVisitorData({pageTitle:t,pageUrl:n}).catch(x.P)})));var T=function(){t.getApplicationState("destroyed")||l.checkGroupStatus().then((function(e){"online"===e.groupStatus?g():v()})).catch(f)},A=ta(t),P=function(e){return Pr()(A,Dr(e))},N=Pr()(P((function(){return ea(t,(function(e){return e.application.maximized}))})),jr()(Boolean),Hr.a);Pr()(N,_r()((function(){return d.add(T)}))),Pr()(P((function(){if(!Ln(t))return Fr.a;var e=ea(t,(function(){return qn(t,"prechat")}));return Pr()(Er()(N,e),jr()((function(){return qn(t,"prechat")})),Dr((function(){var e=t.getLastEvent("liveChatChatId");return Pr()(Object(Tr.a)(Nf(l,e.properties.fields)),Ur)})))})),jr()((function(e){return e&&qn(t,"prechat")})),_r()((function(e){var n=t.getLastEvent("liveChatChatId").id;return t.updateEvent("liveChatChatId",n,{properties:{fields:e}})}))),Pr()(ea(t,(function(){return t.getChat("liveChatChatId").properties.startChatAgainPending})),jr()(Boolean),_r()((function(){var e=null;l.checkGroupStatus().then((function(n){return"online"===n.groupStatus?(e="online",Ln(t)?{type:"show_prechat"}:m().then((function(e){var t=e.agent,n=e.message;return t.isBot?l.startChat().then((function(){return{type:"nothing"}})):{type:"predicted_welcome_message",payload:{agent:t,message:n}}}),(function(e){if("MISSING_PREDICTED_AGENT"===e.code)return l.startChat().then((function(){return{type:"nothing"}}));throw e})).catch((function(){return{type:"panic"}}))):(e="offline",Bn(t)?Un(t,"offline")?{type:"show_offline_form"}:l.getTicketForm().then((function(e){return{type:"show_offline_form",payload:_f("offline",e)}})):{type:"hide_minimized"})})).then((function(n){if("nothing"!==n.type)switch(oi(t,"liveChatChatId"),t.setApplicationState({availability:e}),n.type){case"hide_minimized":return void t.updateView("minimized",{hidden:!0});case"show_offline_form":return n.payload&&t.updateView("Chat/offline",n.payload),void pi(t);case"show_prechat":return void ai(t);case"predicted_welcome_message":var r=n.payload,a=r.agent,i=r.message;return ri(t,a.id),j(i),void t.updateChat("liveChatChatId",{properties:{fakeAgentMessageId:i.id}});case"panic":return void f();default:return}}),f)})))},Lf=Object(ya.b)()?window.localStorage:ya.a,Bf={setItem:function(e,t){return new Promise((function(n){return n(Lf.setItem(e,t))}))},getItem:function(e){return new Promise((function(t){return t(Lf.getItem(e))}))},removeItem:function(e){return new Promise((function(t){return t(Lf.removeItem(e))}))}},qf=function(e,t,n){return""+("production"===n?"https://accounts.livechatinc.com":"https://accounts.livechatinc.com".replace("accounts.","accounts."+n+"."))+function(e){var t=e.uniqueGroups,n=e.license,r=e.group;return(t?"/licence/g"+n+"_"+r:"")+"/customer"}(e)+"?"+Object(I.a)(function(e,t){var n=e.clientId,r=e.license;return{license_id:String(r),flow:"button",response_type:"token",client_id:n,redirect_uri:t,post_message_uri:t,state:"@livechat/customer-auth"}}(e,t))},Uf=function(e){var t=e.code,n=e.message,r=new Error(n);return r.code=t,r},Ff=function(e,t){if("identity_exception"in e)throw Uf({code:"SSO_IDENTITY_EXCEPTION",message:e.identity_exception});if("oauth_exception"in e)throw Uf({code:"SSO_OAUTH_EXCEPTION",message:e.oauth_exception});return{accessToken:e.access_token,entityId:e.entity_id,expiresIn:1e3*e.expires_in,tokenType:e.token_type,creationDate:Date.now(),license:t}},Vf=function(e,t){var n=e.license,r=function(e){return"production"===e?"https://accounts.livechatinc.com":"https://accounts.livechatinc.com".replace("accounts.","accounts."+e+".")}(t);return new Promise((function(a,i){var o=function(e,t){var n=document.createElement("iframe");return n.style.display="none",n.setAttribute("src",qf(e,Object(I.d)(String(window.location))+window.location.pathname,t)),n}(e,t),c=function(){Object(Ai.f)(o),window.removeEventListener("message",u,!1)},s=setTimeout((function(){c(),i(Uf({message:"Request timed out.",code:"REQUEST_TIMEOUT"}))}),15e3),u=function(e){var t=e.origin,o=e.data;if(t===r&&function(e){return e&&"@livechat/customer-auth"===e.state}(o)){clearTimeout(s),c();try{a(Ff(o,n))}catch(u){i(u)}}};window.addEventListener("message",u,!1),Object(Ai.c)().then((function(e){e.appendChild(o)}))}))},Gf=function(e){var t=e.license,n=e.clientId;if("number"!==typeof t||"string"!==typeof n)throw new Error("You need to pass valid configuration object: { license, clientId }.")},Hf=function(e,t){Gf(e);var n="@@lc_auth_token:"+e.license+(e.uniqueGroups?":"+e.group:""),r=null,a=null,i=Bf.getItem(n).then((function(e){null!==i&&(i=null,e&&(a=JSON.parse(e)))})),o=function(){return r=Vf(e,t).then((function(e){return r=null,Bf.setItem(n,JSON.stringify(e)),a=e,e}),(function(e){throw r=null,e}))};return{getFreshToken:o,getToken:function e(){return r||(a&&!function(e){var t=e.creationDate,n=e.expiresIn;return Date.now()>=t+n}(a)?Promise.resolve(a):i?i.then(e):o())},hasToken:function e(){return i?i.then(e):Promise.resolve(!!a)},invalidate:function(){return a=null,i=null,Bf.removeItem(n)}}},Wf=n(45),Yf="login",Jf="set_customer_fields",Kf="update_customer",Qf="update_customer_page";function Zf(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var Xf=function(e){return e.connection.status},$f=function(e,t){return e.requests[t]},em=function(e){var t={},n=e.users.self;return n.name&&(t.name=n.name),n.email&&(t.email=n.email),t.fields=n.fields,t},tm=function(e){return e.users.self.id},nm=function(e,t){var n=e.chats[t];return!!n&&n.active},rm=function(e){return"connected"===Xf(e)},am=function(e){var t=e.region;return"https://api"+(t?"-"+t:"")+function(e){var t=e.license,n=e.env;return 1520===t?".staging":"production"===n?"":"."+n}(e)+".livechatinc.com/v3.2/customer"},im=function(e){var t=e.license,n=e.group,r=void 0===n?null:n,a=e.customer,i=void 0===a?{}:a,o=e.env,c=e.page,s=void 0===c?null:c,u=e.region,l=e.referrer,d=void 0===l?null:l,p=e.uniqueGroups,f=void 0!==p&&p,m=e.mobile,h=void 0!==m&&m;return{license:t,env:o,group:r,chats:{},connection:{status:"disconnected"},page:s,region:u,referrer:d,requests:{},users:{self:{id:null,type:"customer",name:null,email:null,fields:{}},others:{}},customerUpdate:{name:i.name||null,email:i.email||null,fieldsToSet:i.fields||null,fieldsToUpdate:null},uniqueGroups:f,mobile:h}},om=function(e,t){var n=t.id,r=e.requests,a=(r[n],Object(K.a)(r,[n].map(Zf)));return Object(M.a)({},e,{requests:a})},cm=function(e,t){return Object(x.db)("connection.status",e,t)},sm=F(null,((cf={}).change_region=function(e,t){var n=t.region;return Object(M.a)({},e,{region:n})},cf.clear_customer_update=function(e){return Object(M.a)({},e,{customerUpdate:{name:null,email:null,fieldsToSet:null,fieldsToUpdate:null}})},cf.destroy=function(e){return cm("destroyed",e)},cf.login_success=function(e){return cm("connected",e)},cf.pause_connection=function(e){return cm("paused",e)},cf.request_failed=om,cf.response_received=om,cf.send_request=function(e,t){var n=t.action,r=t.promise,a=t.resolve,i=t.reject,o=t.id,c=t.data;return Object(x.db)("requests."+o,{promise:r,resolve:a,reject:i,action:n,data:c},e)},cf.set_chat_active=function(e,t){var n=t.id,r=t.active;return Object(x.db)("chats."+n+".active",r,e)},cf.set_customer_data=function(e,t){var n=em(e),r={};return n.name!==t.name&&(r.name=t.name),n.email!==t.email&&(r.email=t.email),Object(x.eb)(n.fields,t.fields)||(r.fields=t.fields),Object.keys(r).length?Object(M.a)({},e,{users:Object(M.a)({},e.users,{self:Object(M.a)({},e.users.self,r)})}):e},cf.set_customer_fields=function(e,t){var n=t.fields;return rm(e)?e:Object(M.a)({},e,{customerUpdate:Object(M.a)({},e.customerUpdate,{fieldsToSet:n,fieldsToUpdate:null})})},cf.set_self_id=function(e,t){return Object(x.db)("users.self.id",t,e)},cf.socket_disconnected=function(e){var t=Xf(e);var n=cm("disconnected"===t?"disconnected":"reconnecting",e);return Object(M.a)({},n,{requests:{}})},cf.update_customer=function(e,t){var n=t.name,r=t.email,a=t.fields;if(rm(e))return e;var i={};return"string"===typeof n&&(i.name=n),"string"===typeof r&&(i.email=r),Object(x.D)(a)&&(i.fieldsToUpdate=Object(M.a)({},e.customerUpdate.fieldsToUpdate,a)),Object.keys(i).length?Object(M.a)({},e,{customerUpdate:Object(M.a)({},e.customerUpdate,i)}):e},cf.update_customer_page=function(e,t){return Object(M.a)({},e,{page:Object(M.a)({},e.page,t)})},cf));var um="CONNECTION_LOST",lm="IDENTITY_MISMATCH",dm="MISDIRECTED_CONNECTION",pm="REQUEST_TIMEOUT";function fm(e){var t=e.message,n=e.code,r=new Error(t);return r.code=n,r}var mm=function(e){var t={type:e.type};switch(e.type){case"message":t.text=e.text;break;case"filled_form":t.form_id=e.formId,t.fields=e.fields;break;default:t=e}return"string"===typeof e.customId&&(t.custom_id=e.customId),e.postback&&(t.postback=e.postback),Object(x.D)(e.properties)&&(t.properties=e.properties),t},hm=function(e){var t=e.access,n=e.continuous,r=e.events,a=e.chatProperties,i=e.threadProperties,o={chat:{}};return"boolean"===typeof n&&(o.continuous=n),t&&t.groups&&(o.chat.access={group_ids:t.groups}),r&&(o.chat.thread={events:r.map(mm)}),a&&(o.chat.properties=a),i&&(o.chat.thread=o.chat.thread||{},o.chat.thread.properties=i),o},vm=hm,gm=function(){return{type:"clear_customer_update"}},bm=function(e){return{type:"destroy",payload:{reason:e}}},ym=function(e){return{type:"login_success",payload:e}},jm=function(e){return void 0===e&&(e=!1),{type:"prefetch_token",payload:{fresh:e}}},Om=function(e){return{type:"reconnect",payload:{delay:e}}},xm=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n={}),{type:"send_request",payload:{action:e,data:t},meta:n}},_m=function(e,t){return{type:"set_chat_active",payload:{id:e,active:t}}},Cm=function(e){return{type:"set_self_id",payload:e}},wm=function(e,t){t.payload.id=Object(x.t)(e.getState().requests);var n=D(),r=n.resolve,a=n.reject,i=n.promise;return t.payload.promise=i,t.payload.resolve=r,t.payload.reject=a,e.dispatch(t),i},Em=n(80),Im="AUTHENTICATION",Sm="CUSTOMER_BANNED",km="USERS_LIMIT_REACHED",Tm="WRONG_PRODUCT_VERSION",Am=function(e){var t=e.getState(),n=t.license,r=t.group;return"side_storage_"+n+(t.uniqueGroups?":"+r:"")},Pm=function(e){return Bf.getItem(Am(e)).catch(x.P).then((function(e){return void 0===e&&(e="{}"),JSON.parse(e)})).catch((function(){return{}}))},Nm=function(e,t,n){var r=e.slice(0),a=!1;return function e(i){var o=r.shift();Object(Em.a)((function(){return o(i)})).then((function(n){a||(r.length?e(n):t(n))}),(function(e){a||n(e)}))}(),{cancel:function(){a=!0}}},Mm=function(e,t,n){return wm(e,xm(t,n,{source:"login"}))},zm=function(e){return new Promise((function(t){setTimeout(t,e)}))},Rm=function(e){var t={};return e.name&&(t.name=e.name),e.email&&(t.email=e.email),t},Dm=function(e,t){return Object(M.a)({},Rm(t),{fields:Object(M.a)({},e.fields,t.fieldsToSet)})},Lm=function(e,t){var n=Rm(e);return(e.fieldsToUpdate||t)&&(n.fields=Object(M.a)({},t,e.fieldsToUpdate)),n};function Bm(e){var t,n,r=null,a=null,i=new Qo.a({min:300,max:6e4,jitter:.3}),o=function(){return t.dispatch(gm())},c=function(e){return t.dispatch(bm(e))},s=function(){return t.dispatch(Om(i.duration()))},u=function(){return Promise.all([e.getToken(),Pm(t)])},l=function(e){var n=e[0],r=e[1],a=tm(t.getState());if(null===a)t.dispatch(Cm(n.entityId));else if(a!==n.entityId){var i=new Error("Identity has changed.");throw i.code=lm,i}return[n,r]},d=function(e){var n=e[0],i=e[1],c=t.getState(),s=c.group,u=c.page,l=c.referrer,d=c.customerUpdate,p=c.mobile,f=Dm(em(c),d);r=d.fieldsToUpdate,o();var m={token:n.tokenType+" "+n.accessToken,customer:f,customer_side_storage:i,is_mobile:p};return"number"===typeof s&&(m.group_id=s),null!==u&&(a=u,m.customer_page=u),null!==l&&(m.referrer=l),Promise.race([Mm(t,Yf,m),zm(15e3).then((function(){return Promise.reject(fm({message:"Request timed out.",code:pm}))}))])};return function(p){t=p,n&&n.cancel(),n=Nm([u,l,d],(function(e){n=null,i.reset(),function(){var e=t.getState(),n=e.customerUpdate,i=e.page;a!==i&&Mm(t,Qf,i).catch(x.P);var c=n.fieldsToSet;c&&(r=null,Mm(t,Jf,{fields:c}).catch(x.P));var s=Lm(n,r);Object.keys(s).length&&Mm(t,Kf,s).catch(x.P),r=null,a=null,o()}(),t.dispatch(ym(e))}),(function(t){switch(t.code){case Im:return e.getFreshToken(),void s();case um:case dm:return;case"SSO_IDENTITY_EXCEPTION":case"SSO_OAUTH_EXCEPTION":return"server_error"===t.message||"temporarily_unavailable"===t.message?void s():void c(t.message);case lm:case Sm:case km:case Tm:return void c(t.code.toLowerCase());default:return void s()}}))}}var qm,Um,Fm,Vm=function(e,t){var n=e.getState,r=e.dispatch,a=function(e){return e.requests}(n());r({type:"fail_all_requests",payload:{rejects:Object.keys(a).map((function(e){return a[e].reject})),reason:t}})},Gm=function(e,t,n){var r=e.getState,a=e.dispatch,i=t.payload.id;a({type:"request_failed",payload:{id:i,reject:r().requests[i].reject,error:n}})},Hm=function(e){var t=e.getState,n=e.dispatch,r=t();n({type:"socket_disconnected",payload:{previousStatus:Xf(r)}})},Wm=((qm={})[um]="Connection lost.",qm[dm]="Connected to wrong region.",qm),Ym=function(e,t){var n=e.getState(),r=t.payload.action;if("push_received"===t.type){var a=t.payload.push;switch(r){case"incoming_chat_thread":return void e.dispatch(_m(a.data.chat,!0));case"thread_closed":return void e.dispatch(_m(a.chat,!1));case"customer_updated":return void e.dispatch({type:"set_customer_data",payload:a});default:return}}var i=t.payload.response;switch(r){case"close_thread":return void e.dispatch(_m(t.payload.data.chat_id,!1));case"get_chats_summary":return void i.chatsSummary.filter((function(e){var t=e.id,r=e.active;return nm(n,t)!==r})).forEach((function(t){var n=t.id,r=t.active;e.dispatch(_m(n,r))}));case"activate_chat":case"start_chat":return void e.dispatch(_m(i.data.chat,!0));default:return}},Jm=function(e,t){t.forEach((function(t){e("user_data",t)}))},Km=function(e,t){var n=e.emit,r=e.store,a=t.payload,i=a.action,o=a.push;switch(i){case"chat_properties_updated":case"chat_thread_properties_updated":case"events_marked_as_seen":case"thread_closed":return void n(i,o);case"customer_side_storage_updated":return void function(e,t){Bf.setItem(Am(e),JSON.stringify(t)).catch(x.P)}(r,o.customer_side_storage);case"chat_user_added":return Jm(n,[o.user]),void(o.joined&&n("user_joined_chat",{chat:o.chat,user:o.user.id}));case"chat_user_removed":return void n("user_left_chat",o);case"customer_disconnected":switch(o.reason){case"access_token_expired":r.dispatch(jm(!0)),n("disconnected",o);break;case"customer_banned":case"license_not_found":case"product_version_changed":case"too_many_connections":case"unsupported_version":r.dispatch(bm(o.reason));break;case"misdirected_connection":Vm(r,dm),r.dispatch({type:"change_region",payload:o.data});break;case"too_many_unauthorized_connections":Vm(r,"TOO_MANY_UNAUTHORIZED_CONNECTIONS");break;default:n("disconnected",o)}return;case"incoming_chat_thread":return Jm(n,o.users),void n("incoming_chat_thread",o.data);case"incoming_event":return void n("new_event",o);case"incoming_typing_indicator":return void n(o.isTyping?"user_is_typing":"user_stopped_typing",{chat:o.chat,user:o.user});default:return void n(i,o)}},Qm=function(e){var t=e.auth,n=e.emitter,r=e.socket,a=n.emit,i=Bm(t);return function(e,o){var c=e.type,s=e.payload;switch(c){case"change_region":return Hm(o),void r.reinitialize();case"check_goals":return void function(e,t){t.getToken().then((function(t){var n=e.getState();null===tm(n)&&e.dispatch(Cm(t.entityId));var r=n.page;if(r&&r.url){var a=Object(I.a)({license_id:n.license}),i={customer_fields:em(n).fields,group_id:n.group||0,page_url:r.url};Object(E.a)(am(n)+"/action/check_goals?"+a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:t.tokenType+" "+t.accessToken},body:JSON.stringify({payload:i})},x.P)}}))}(o,t);case"destroy":return r.destroy(),"manual"!==s.reason&&a("disconnected",s),void n.off();case"emit_events":return void e.payload.forEach((function(e){var t=e[0],n=e[1];a(t,n)}));case"fail_all_requests":var u=s.reason,l={message:Wm[u],code:u};return void s.rejects.forEach((function(e){e(fm(l))}));case"login_success":var d=s.dynamicConfig,p=s.chats,f={};return Object.defineProperty(f,"__unsafeDynamicConfig",{value:d}),Object.defineProperty(f,"__unsafeChats",{value:p}),void a("connected",f);case"pause_connection":return void r.disconnect();case"prefetch_token":return s.fresh?void t.getFreshToken().catch(x.P):void t.hasToken().then((function(e){return e?t.getToken().then((function(e){if(!(e.creationDate+e.expiresIn-Date.now()>36e5))return t.invalidate().then(t.getFreshToken)})):t.getToken()})).catch(x.P);case"push_received":return"customer_disconnected"===e.payload.action?void Km({emit:a,store:o},e):(Ym(o,e),void Km({emit:a,store:o},e));case"reconnect":return void r.reconnect(e.payload.delay);case"request_failed":return void s.reject(fm(s.error));case"response_received":return Ym(o,e),void function(e,t){var n=e.emit,r=t.payload,a=r.action,i=r.resolve,o=r.response;switch(a){case"get_chat_threads":return Jm(n,o.users),void i(o.threads);case"get_chats_summary":var c=o.chatsSummary,s=o.totalChats,u=o.users;return Jm(n,u),void i({chatsSummary:c,totalChats:s});case"send_event":return void i(o.event);case"activate_chat":case"start_chat":return Jm(n,o.users),void i(o.data);default:i(o)}}({emit:a,store:o},e);case"send_request":var m=o.getState();return function(e){return"destroyed"===Xf(e)}(m)?void Gm(o,e,{code:"SDK_DESTROYED",message:"SDK destroyed."}):rm(m)||"login"===e.meta.source?void function(e,t){var n=t.payload,r=n.id,a=n.action,i=n.data,o={};o.request_id=r,o.action=a,null!==i&&(o.payload=i),e.emit(o)}(r,e):void Gm(o,e,{code:"NO_CONNECTION",message:"No connection."});case"set_customer_fields":if(!rm(o.getState()))return;return void wm(o,xm(Jf,s)).catch(x.P);case"set_self_id":return void a("customer_id",s);case"socket_disconnected":return void("connected"===s.previousStatus&&a("connection_lost"));case"socket_connected":return void i(o);case"socket_recovered":if(!rm(o.getState()))return;return void a("connection_recovered");case"socket_unstable":if(!rm(o.getState()))return;return void a("connection_unstable");case"start_connection":return r.connect(),void o.dispatch(jm());case"update_customer":if(!rm(o.getState()))return;return void wm(o,xm(Kf,s)).catch(x.P);case"update_customer_page":if(!rm(o.getState()))return;return void wm(o,xm(Qf,s)).catch(x.P);default:return}}},Zm=function(e){var t=Object(x.gb)((function(e,t){var n=t+e.totalEvents;return[n>=25,n]}),0,e);return[t[0],t[1].map((function(e){return e.id}))]},Xm=function(e,t){var n=Zm(t.filter((function(t){return t.order<e.lastOrderFetched})));e.threadsSummary=n[0],e.threadsToFetch=n[1]},$m=function(e,t){var n={done:!1,idle:!0,lastOrderFetched:1/0,leftToFetch:1/0,queuedTasks:[],totalThreads:1/0,threadsSummary:null,threadsToFetch:[]},r=function(a,i){var o;n.done?a({value:void 0,done:!0}):n.idle?(n.idle=!1,n.threadsSummary?n.threadsToFetch.length>0?o=e.getChatThreads(t,n.threadsToFetch):n.threadsSummary.length>0?(Xm(n,n.threadsSummary),o=e.getChatThreads(t,n.threadsToFetch)):o=function(e,t,n){return e.getChatThreadsSummary(t,{offset:0}).then((function(r){var a=r.totalThreads-n.leftToFetch;return e.getChatThreadsSummary(t,{offset:a})}))}(e,t,n).then((function(r){var a=r.threadsSummary;return Xm(n,a),e.getChatThreads(t,n.threadsToFetch)})):o=function(e,t){return e.getChatThreadsSummary(t,{offset:0}).then((function(n){var r=n.threadsSummary,a=n.totalThreads,i=Zm(r),o=i[0],c=i[1];return Promise.all([{threadsSummary:o,totalThreads:a},c.length>0?e.getChatThreads(t,c):[]])}))}(e,t).then((function(e){var t=e[0],r=t.threadsSummary,a=t.totalThreads,i=e[1];return n.threadsSummary=r,n.totalThreads=n.leftToFetch=a,i})),o.then((function(e){a(function(e,t){return e.idle=!0,e.threadsToFetch=[],e.leftToFetch-=t.length,e.lastOrderFetched=0!==t.length?t[0].order:0,0===e.leftToFetch?(e.done=!0,{value:t,done:!0}):{value:t,done:!1}}(n,e));var t=n.queuedTasks.shift();t&&r(t.resolve,t.reject)}),(function(e){return i(function(e,t){return e.idle=!0,e.queuedTasks.forEach((function(e){return(0,e.reject)(t)})),t}(n,e))}))):n.queuedTasks.push({resolve:a,reject:i})};return{next:function(){return new Promise(r)}}},eh=n(208),th=n.n(eh),nh=function(e){var t=e.min,n=void 0===t?1e3:t,r=e.max,a=void 0===r?5e3:r,i=e.jitter,o=void 0===i?.5:i,c=0;return{duration:function(){var e=n*Math.pow(2,c++);if(o){var t=Math.random(),r=Math.floor(t*o*e);e=0===(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,a)},reset:function(){c=0}}},rh=function(e,t){var n,r=void 0===t?{}:t,a=r.query,i=r.transports,o=void 0===i?["websocket","xhr-polling"]:i,c=e+(a?"?"+Object(I.a)(a):""),s=Object(R.a)(),u=nh({min:1e3,max:5e3,jitter:.5}),l=3,d=null,p=function(){l=1,u.reset(),s.emit("connect")},f=function(){l=3,d=null,s.emit("disconnect"),b()},m=function(e){var t=e.data;s.emit("message",t)},h=function(){s.emit("heartbeat")},v=function(){var e;(l=3,d)&&((e=d).removeEventListener("open",p),e.removeEventListener("close",f),e.removeEventListener("message",m),e.removeEventListener("heartbeat",h),d.close(),d=null)},g=function(){var e;l=0,d=new th.a(c,void 0,{transports:o}),(e=d).addEventListener("open",p),e.addEventListener("close",f),e.addEventListener("message",m),e.addEventListener("heartbeat",h)},b=function(e){void 0===e&&(e=u.duration()),clearTimeout(n),0!==e?n=setTimeout(g,e):g()},y={connect:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){if(3!==l)throw new Error("Socket is already open or connecting.");clearTimeout(n),g()})),destroy:function(){y.off(),y.disconnect()},disconnect:function(){l=3,clearTimeout(n),v()},reconnect:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){v(),b(e)})),emit:function(e){if(1!==l)throw new Error("Socket is not connected.");d.send(e)},getReadyState:function(){return l},on:s.on,off:s.off};return y},ah=function(){var e,t=x.P;return{cancel:function(){clearTimeout(e),t=x.P},check:function(){var n=D();return t=n.resolve,e=setTimeout((function(){var e=new Error("Timeout.");e.code="TIMEOUT",n.reject(e)}),2e3),n.promise},resolve:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){clearTimeout(e),t()}))}},ih=function(e,t){var n,r,a,i=void 0===t?{}:t,o=i.query,c=void 0===o?{}:o,s=i.rescheduleTimeout,u=void 0===s?3e4:s,l=i.transports,d=i.emitter,p=void 0===d?Object(R.a)():d,f=rh(e,{query:Object(M.a)({bh:Object(x.s)()},c),transports:l}),m=ah(),h=function(){return 1===f.getReadyState()},v=function(e){f.emit(JSON.stringify(e)),b()},g=function(){v({action:"ping"})},b=function(){clearTimeout(n),n=setTimeout(g,u)},y=function(){m.cancel(),clearTimeout(n)};return r=f,a=p,["connect","disconnect"].forEach((function(e){r.on(e,(function(t){a.emit(e,t)}))})),f.on("connect",b),f.on("disconnect",y),f.on("heartbeat",g),f.on("message",(function(e){m.resolve();var t=JSON.parse(e);"ping"!==t.action&&p.emit("message",t)})),"undefined"!==typeof window&&(window.addEventListener("online",(function(){h()&&(m.check().then((function(){m.cancel(),p.emit("connection_recovered")}),(function(e){if(m.cancel(),"TIMEOUT"!==e.code)throw e;f.reconnect()})),g())})),window.addEventListener("offline",(function(){m.cancel(),h()&&p.emit("connection_unstable")}))),Object(M.a)({},f,{destroy:function(){y(),f.destroy()},disconnect:function(){y(),f.disconnect()},reconnect:function(e){y(),f.reconnect(e)},emit:v,on:p.on,off:p.off})},oh=function(e,t){var n=e.getState(),r=am(n)+"/rtm/sjs";return ih(r,{query:{license_id:n.license},emitter:t})},ch=function(e){var t=Object(R.a)(),n=oh(e,t);return Object(M.a)({},Object.keys(n).reduce((function(e,t){return e[t]=function(){var e;return(e=n)[t].apply(e,arguments)},e}),{}),{reinitialize:function(){n.disconnect(),(n=oh(e,t)).connect()}})},sh=Object.freeze({success:!0}),uh=function(e,t){var n={id:t.id,author:t.author_id,createdAt:t.created_at,thread:e,properties:void 0!==t.properties?vh(t.properties):{}};return void 0!==t.custom_id&&(n.customId=t.custom_id),n},lh=function(e,t){var n,r=t.height>t.width?["height","width"]:["width","height"],a=r[0],i=r[1],o=t[a],c=t[i],s=e/o;return(n={})[a]=Math.min(o,e),n[i]=Math.min(s*c,c),n},dh=function(e,t){return void 0!==t.width&&void 0!==t.height?function(e,t){var n=Object(M.a)({},uh(e,t),{type:"file",contentType:t.content_type,url:t.url,name:t.name,width:t.width,height:t.height});return t.thumbnail_url&&(n.thumbnails={default:Object(M.a)({url:t.thumbnail_url},Object(x.J)(Math.ceil,lh(300,t))),high:Object(M.a)({url:t.thumbnail2x_url},Object(x.J)(Math.ceil,lh(600,t)))}),n}(e,t):Object(M.a)({},uh(e,t),{type:"file",contentType:t.content_type,url:t.url,name:t.name})},ph=function(e){var t={};if("string"===typeof e.title&&(t.title=e.title),"string"===typeof e.subtitle&&(t.subtitle=e.subtitle),e.image){var n=e.image;t.image={url:n.url,name:n.name}}return e.buttons&&(t.buttons=e.buttons.map((function(e){var t=e.text,n=e.postback_id,r=e.user_ids,a=e.type,i=e.value,o={text:t,postback:n,users:r};return a&&(o.type=a,o.value=i,"webview"===a&&e.webview_height&&(o.webviewHeight=e.webview_height)),o}))),t},fh=function(e,t){switch(t.type){case"file":return dh(e,t);case"filled_form":return function(e,t){return Object(M.a)({},uh(e,t),{type:"filled_form",formId:t.form_id,fields:t.fields})}(e,t);case"message":return function(e,t){return Object(M.a)({},uh(e,t),{type:"message",text:t.text})}(e,t);case"rich_message":return function(e,t){return Object(M.a)({},uh(e,t),{type:"rich_message",template:t.template_id,elements:t.elements.map(ph)})}(e,t);case"system_message":return function(e,t){var n=Object(M.a)({},uh(e,Object(M.a)({},t,{author_id:"system"})),{type:"system_message",text:t.text,systemMessageType:t.system_message_type});return t.text_vars&&(n.textVars=t.text_vars),n}(e,t);default:return function(e,t){return Object(M.a)({},uh(e,t),Object(x.R)(["id","author_id","created_at","custom_id","order"],t))}(e,t)}},mh=function(e){return void 0===e&&(e={}),e.group_ids?{groups:e.group_ids}:{}},hh=function(e){return Object(x.J)((function(e){return e.events_seen_up_to?e.events_seen_up_to:null}),Object(x.F)("id",e))},vh=function(e){return Object(x.J)((function(e){return Object(x.J)((function(e){return Object(x.D)(e)?e.value:e}),e)}),e)},gh=function(e){return{id:e.id,type:"agent",name:e.name,avatar:e.avatar,jobTitle:e.job_title}},bh=function(e){var t={id:e.id,type:e.type,fields:e.fields||{}};return e.name&&(t.name=e.name),e.email&&(t.email=e.email),t},yh=function(e){return"customer"===e.type?bh(e):gh(e)},jh=function(e){var t=e.id,n=e.access,r=e.thread,a=e.users,i=e.properties,o=void 0===i?{}:i;return{data:{chat:t,access:mh(n),users:r.user_ids,thread:r.id,events:r.events.map((function(e){return fh(r.id,e)})),chatProperties:vh(o),threadProperties:vh(r.properties||{})},users:a.map(yh)}},Oh=function(e){var t=e.chat,n=t.threads,r=t.users,a=t.id;return{threads:Object(x.Q)("order",n).map((function(e){return function(e,t,n){return{id:n.id,chat:e,active:n.active,access:mh(n.access),order:n.order,users:n.user_ids,eventsSeenUpToMap:hh(t),events:n.events.map((function(e){return fh(n.id,e)})),properties:vh(n.properties||{})}}(a,r,e)})),users:r.map(yh)}},xh=function(e){return jh(e.chat)},_h=function(e){switch(e.action){case"chat_properties_deleted":return{chat:(t=e.payload).chat_id,properties:t.properties};case"chat_properties_updated":return function(e){return{chat:e.chat_id,properties:vh(e.properties)}}(e.payload);case"chat_thread_properties_deleted":return function(e){return{chat:e.chat_id,thread:e.thread_id,properties:e.properties}}(e.payload);case"chat_thread_properties_updated":return function(e){return{chat:e.chat_id,thread:e.thread_id,properties:vh(e.properties)}}(e.payload);case"chat_user_added":return function(e){var t=e.chat_id,n=e.user;return{chat:t,user:yh(n),joined:n.present}}(e.payload);case"chat_user_removed":return function(e){return{chat:e.chat_id,user:e.user_id}}(e.payload);case"customer_page_updated":return function(e){return{url:e.url,title:e.title,timestamp:1e3*e.timestamp}}(e.payload);case"customer_updated":return function(e){return bh(e.customer)}(e.payload);case"event_properties_deleted":return function(e){return{chat:e.chat_id,thread:e.thread_id,event:e.event_id,properties:e.properties}}(e.payload);case"event_updated":return function(e){var t=e.thread_id;return{chat:e.chat_id,thread:t,event:fh(t,e.event)}}(e.payload);case"events_marked_as_seen":return function(e){return{chat:e.chat_id,user:e.user_id,seenUpTo:e.seen_up_to}}(e.payload);case"incoming_chat_thread":return function(e){return jh(e.chat)}(e.payload);case"incoming_event":return function(e){return{chat:e.chat_id,event:fh(e.thread_id,e.event)}}(e.payload);case"incoming_typing_indicator":return function(e){var t=e.chat_id,n=e.typing_indicator;return{chat:t,user:n.author_id,isTyping:n.is_typing}}(e.payload);case"thread_closed":return{chat:e.payload.chat_id};default:return e.payload}var t},Ch=function(e,t){switch(e){case"activate_chat":return xh(t);case"close_thread":case"delete_chat_properties":case"delete_chat_thread_properties":case"delete_event_properties":return sh;case"get_chat_threads":return Oh(t);case"get_chat_threads_summary":return function(e){var t=e.threads_summary,n=e.total_threads;return{threadsSummary:Object(x.Q)("order",t.map((function(e){var t=e.total_events;return{id:e.id,active:e.active,order:e.order,totalEvents:t}}))),totalThreads:n}}(t);case"get_chats_summary":return function(e){var t=e.chats_summary.map((function(e){var t=e.id,n=e.active,r=e.access,a=e.order,i=e.last_thread_id,o=e.last_event_per_type,c=e.properties,s=void 0===c?{}:c,u=e.users,l={};if(l.id=t,l.active=n,l.access=mh(r),l.order=a,l.properties=vh(s),l.users=u.map((function(e){return e.id})),l.lastThread=i,l.eventsSeenUpToMap=hh(u),!o)return l;l.lastEventsPerType=Object(x.J)((function(e){var t=e.thread_id,n=e.event;return fh(t,n)}),o);var d=Object.keys(o).map((function(e){return o[e]})),p=Object(x.G)(d.sort((function(e,t){return e.thread_id===t.thread_id?e.event.order-t.event.order:e.thread_order-t.thread_order})));return p&&(l.lastEvent=Object(x.c)(l.lastEventsPerType[p.event.type]),l.lastThreadOrder=p.thread_order),l}));return{chatsSummary:Object(x.Q)((function(e){var t=e.lastEvent,n=e.order;return-1*(void 0!==t?t.timestamp:n)}),t),totalChats:e.total_chats,users:Object(x.e)((function(e){return e.map(yh)}),(function(e){return Object(x.pb)((function(e){return e.id}),e)}),(function(e){return Object(x.p)((function(e){return e.users}),e)}))(e.chats_summary)}}(t);case"get_customer":return bh(t);case"get_form":return function(e){return e.enabled?Object(M.a)({},e,{form:Object(M.a)({},e.form,{fields:e.form.fields.map((function(e){if("group_chooser"===e.type)return Object(M.a)({},e,{options:e.options.map((function(e){var t=e.group_id,n=Object(K.a)(e,["group_id"]);return Object(M.a)({},n,{group:t})}))});if("rating"===e.type){var t=e.comment_label,n=Object(K.a)(e,["comment_label"]);return Object(M.a)({},n,{commentLabel:t})}return e}))})}):e}(t);case"get_groups_status":return function(e){return e.groups_status}(t);case"get_predicted_agent":return function(e){var t=gh(e);return Object(M.a)({},t,{isBot:e.is_bot||!1})}(t);case"get_url_details":return function(e){return{title:e.title,description:e.description,url:e.url,image:{url:"https://"+e.image_url,width:e.image_width,height:e.image_height}}}(t);case Yf:return function(e){return{dynamicConfig:e.__priv_dynamic_config,chats:e.chats.map((function(t){return{id:t.chat_id,active:"has_active_thread"in t?t.has_active_thread:e.has_active_thread,hasUnreadEvents:t.has_unread_events}}))}}(t);case"mark_events_as_seen":return sh;case"send_event":return function(e){return{event:fh(e.thread_id,e.event)}}(t);case"send_sneak_peek":case Jf:return sh;case"start_chat":return xh(t);case"update_chat_properties":case"update_chat_thread_properties":case Kf:case Qf:return sh;default:return t}},wh=function(e,t){switch(t.type){case"authentication":case"customer_banned":case"group_unavailable":case"groups_offline":case"group_offline":case"group_not_found":case"internal":case"request_timeout":case"users_limit_reached":case"validation":case"wrong_product_version":return{code:t.type.toUpperCase(),message:t.message};default:return Object(M.a)({code:"REQUEST_FAILED"},t)}},Eh=function(e,t){var n=e.dispatch,r=e.getState,a=t.request_id,i=t.payload,o=$f(r(),a),c=o.promise,s=o.resolve,u=o.action;n({type:"response_received",payload:{id:a,action:u,data:o.data,promise:c,resolve:s,response:Ch(u,i)}})},Ih=((Um={}).activate_chat=!0,Um.close_thread=!0,Um.send_event=!0,Um.start_chat=!0,Um),Sh=((Fm={}).incoming_chat_thread=!0,Fm.incoming_event=!0,Fm.thread_closed=!0,Fm),kh=function(e,t){var n=e.dispatch;return t.on("connect",(function(){n({type:"socket_connected"})})),t.on("message",(function(t){if("response"===t.type)return t.success?void(Ih[t.action]||Eh(e,t)):void function(e,t){var n=e.dispatch,r=e.getState,a=t.request_id,i=t.payload,o=$f(r(),a),c=o.reject;o.action;n({type:"request_failed",payload:{id:a,reject:c,error:wh(0,i.error)}})}(e,t);"string"===typeof t.request_id&&Sh[t.action]?Eh(e,t):function(e,t){e.dispatch({type:"push_received",payload:{action:t.action,push:_h(t)}})}(e,t)})),t.on("disconnect",(function(){Vm(e,um),Hm(e)})),t.on("connection_unstable",(function(){n({type:"socket_unstable"})})),t.on("connection_recovered",(function(){n({type:"socket_recovered"})})),t.off},Th=function(e){var t,n=e.auth,r=e.chat,a=e.data,i=e.spec,o=e.store,c=!1,s=new Promise((function(e,s){!function(e){if(e.size>10485760){var t=new Error("The file is too big (max size is "+function(e,t){if(void 0===t&&(t=2),e<1024)return e+" b";var n=e/1024;if(e<1048576)return n.toFixed(t)+" kb";var r=n/1024;return e<1073741824?r.toFixed(t)+" MB":(r/1024).toFixed(t)+" GB"}(10485760)+").");throw t.code="TOO_BIG_FILE",t}}(a.file);var u=o.getState(),l=Object(I.a)({license_id:u.license}),d=am(u)+"/action/upload_file?"+l,p=function(e,t){var n={};return n.chat_id=e,n.file=t.file,t.customId&&(n.custom_id=t.customId),n}(r,a);n.getToken().then((function(n){c?s(new Error("Upload cancelled.")):(t=Cc(d,p,Object(M.a)({},i,{headers:{Authorization:n.tokenType+" "+n.accessToken}}))).then(e,(function(e){if(e.response){var t=e.response.error,n=t.type,r=t.message,a=new Error(r);a.code=n.toUpperCase(),s(a)}else s(e)}))}))}));return{then:function(e,t){return s.then(e,t)},catch:function(e){return s.catch(e)},cancel:function(){c||(c=!0,t&&t.cancel())}}},Ah=function(e,t){var n;void 0===t&&(t="production"),Gf(e);var r=e.autoConnect,a=void 0===r||r,i=Object(K.a)(e,["autoConnect"]),o=function(e){var t=x.y,n=J(),r=Object(z.d)(sm,im(e),t(Object(z.a)(n)));return r.addSideEffectsHandler=n.add,r}(Object(M.a)({},i,{env:t})),c=Object(R.a)(),s=ch(o),u=Hf(i,t);o.addSideEffectsHandler(Qm({emitter:c,socket:s,auth:u})),kh(o,s);var l=wm.bind(null,o),d=function(){o.dispatch({type:"start_connection"})},p=Object.freeze(((n={activateChat:function(e,t){return void 0===t&&(t={}),l(xm("activate_chat",function(e,t){return Object(x.N)(hm(t),{chat:{id:e}})}(e,t)))},auth:u,cancelRate:function(e,t){return void 0===t&&(t=["score"]),p.getChatThreadsSummary(e).then((function(n){var r=n.threadsSummary;return p.deleteChatThreadProperties(e,Object(x.G)(r).id,{rating:t})}))},closeThread:function(e){return l(xm("close_thread",{chat_id:e}))},connect:d,deleteChatProperties:function(e,t){return l(xm("delete_chat_properties",{chat_id:e,properties:t}))},deleteChatThreadProperties:function(e,t,n){return l(xm("delete_chat_thread_properties",{chat_id:e,thread_id:t,properties:n}))},deleteEventProperties:function(e,t,n,r){return l(xm("delete_chat_thread_properties",{chat_id:e,thread_id:t,event_id:n,properties:r}))},destroy:function(){o.dispatch(bm("manual"))},disconnect:function(){o.dispatch({type:"pause_connection"})},getChatHistory:function(e){return $m(p,e)},getChatsSummary:function(e){void 0===e&&(e={});var t=e,n=t.offset,r=void 0===n?0:n,a=t.limit,i=void 0===a?10:a;return i>25?Promise.reject(new Error("Specified limit is too high (max 25).")):l(xm("get_chats_summary",{offset:r,limit:i}))},getChatThreads:function(e,t){return l(xm("get_chat_threads",{chat_id:e,thread_ids:t}))},getChatThreadsSummary:function(e,t){void 0===t&&(t={});var n=t,r=n.offset,a=void 0===r?0:r,i=n.limit,o=void 0===i?25:i;return o>1e3?Promise.reject(new Error("Specified limit is too high (max 1000).")):l(xm("get_chat_threads_summary",{chat_id:e,offset:a,limit:o}))},getCustomer:function(){return l(xm("get_customer"))},getForm:function(e,t){return l(xm("get_form",{group_id:e,type:t}))},getGroupsStatus:function(e){return l(xm("get_groups_status",e?{groups:e,group_ids:e}:{all:!0}))},getPredictedAgent:function(e){return l(xm("get_predicted_agent","number"===typeof e?{group_id:e}:void 0))},getUrlDetails:function(e){return l(xm("get_url_details",{url:e}))},markEventsAsSeen:function(e,t){return l(xm("mark_events_as_seen",{chat_id:e,seen_up_to:t}))},on:c.on,once:c.once,off:c.off,rateChat:function(e,t){return p.getChatThreadsSummary(e).then((function(n){var r=n.threadsSummary;return p.updateChatThreadProperties(e,Object(x.G)(r).id,{rating:t})}))},sendEvent:function(e,t,n){return l(function(e,t,n){var r={chat_id:e,event:mm(t)};return n&&n.attachToLastThread&&(r.attach_to_last_thread=!0),xm("send_event",r)}(e,t,n))},sendPostback:function(e,t,n,r){var a=r.id,i=r.toggled;return l(xm("send_rich_message_postback",{chat_id:e,event_id:n,thread_id:t,postback:{id:a,toggled:void 0===i||i}}))},setCustomerFields:function(e){o.dispatch({type:"set_customer_fields",payload:{fields:e}})},setSneakPeek:function(e,t){var n=o.getState();nm(n,e)&&rm(n)&&l(xm("send_sneak_peek",{chat_id:e,sneak_peek_text:t})).catch(x.P)},startChat:function(e){return void 0===e&&(e={}),l(xm("start_chat",vm(e)))},updateChatProperties:function(e,t){return l(xm("update_chat_properties",{chat_id:e,properties:t}))},updateChatThreadProperties:function(e,t,n){return l(xm("update_chat_thread_properties",{chat_id:e,thread_id:t,properties:n}))},updateCustomer:function(e){o.dispatch({type:"update_customer",payload:e})},updateCustomerPage:function(e){o.dispatch({type:"update_customer_page",payload:Object(x.Z)(["title","url"],e)})},updateEventProperties:function(e,t,n,r){return l(xm("update_event_properties",{chat_id:e,event_id:n,thread_id:t,properties:r}))},uploadFile:function(e,t,n){return Th({auth:u,chat:e,data:t,spec:n,store:o})}})[Wf.default]=Object(x.U)((function(){return Object.freeze({subscribe:function(e){if(!Object(x.D)(e))throw new TypeError("Expected the observer to be an object.");var t=function(t,n){"function"===typeof e.next&&e.next([t,n])};return c.on("*",t),function(){c.off("*",t)}}})})),n));return a?d():o.dispatch({type:"check_goals"}),p},Ph=function(e){var t=Object(I.j)(e);return"https://"+(!Object(x.z)("cdn.livechatinc.com/cloud/?uri",t)&&!Object(x.z)(".livechat-static.com/",t)?"cdn.livechatinc.com/cloud/?"+Object(I.a)({uri:"https://"+t}):t)};function Nh(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var Mh={group_chooser:"select",header:"information",name:"text",question:"text",subject:"text",checkbox_for_email:"checkbox"},zh=function(e,t){return e.getSessionUser().serverId===t.author},Rh=function(e,t){return zh(e,t)?e.getSessionUser().id:t.author},Dh=function(e,t){if("file"===t.type)return t.id;if(zh(e,t))return"customId"in t&&e.hasEvent("liveChatChatId",t.customId)?t.customId:t.id;var n=e.getEventByServerId("liveChatChatId",t.id);return n?n.id:t.id},Lh=function(e){return e.groups?e.groups[0]:null},Bh=function(e){return"offline"===e?"offline":"online"},qh=function(e,t){var n=e.getSessionUser().serverId;return Object(x.G)(t.filter((function(e){return e!==n})))},Uh=function(e,t){var n=t.chat,r=t.access,a=t.thread,i=t.events,o=t.users,c=t.threadProperties;return{id:n,agent:qh(e,o),events:i.map((function(t){return Wh(e,Object(C.a)({},t,{seen:!1}))})).filter(Boolean),group:Lh(r),thread:a,properties:Kh(c)}},Fh=function(e,t){return Object(C.a)({},t,{type:e,fields:t.fields.reduce((function(e,t){var n=t.id,r=Object(w.a)(t,["id"]),a=Object(C.a)({},r,{type:Mh[r.type]||r.type,serverName:n,serverType:r.type});if("information"===a.type)a.value=a.label.replace(/<br(\s)?(\/)?>/gi,"\n");else if("checkbox_for_email"===r.type)a.meta="confirm_subscription",a.label="",a.options=[{label:r.label,checked:r.checked,value:"index0_0",originalValue:"0"}],r.checked&&(a.defaultValue=[a.options[0].value]);else if(r.options){var i="group_select"===r.type;i&&(a.meta="groupSelect"),a.options=a.options.map((function(e,t){var n=i?e.group:e.id,r=Object(C.a)({},Object(x.R)(["id","checked","group"],e),{value:"index"+t+"_"+n,originalValue:n});return i&&(r.groupNumber=e.group),r}))}return a.name=Object(x.z)(r.type,["name","email","rating"])?r.type:"name_"+n,"rating"===r.type?[].concat(e,[a,{name:"rateComment",type:"textarea",label:a.commentLabel,required:!1,dependOn:"rating"}]):[].concat(e,[a])}),[])})},Vh=function(e,t){return xc(Fh("offline",function(e){return Object(C.a)({},e,{fields:e.fields.map((function(e,t){return Object(C.a)({},e,{id:String(t)})}))})}(t)))},Gh=function(e,t){var n=t.id,r=t.active,a=t.events,i=t.access,o=t.users,c=t.eventsSeenUpToMap,s=t.properties,u=e.getSessionUser().serverId,l=c[u],d=Object(w.a)(c,[u].map(Nh)),p=Object(x.G)(Object(x.rb)(d).filter(Boolean).sort());return{id:n,active:r,agent:r?qh(e,o):null,events:a.map((function(t){var n=t.author===u?p>=t.createdAt:l>=t.createdAt;return Wh(e,Object(C.a)({},t,{seen:n}))})).filter(Boolean),group:Lh(i),properties:Kh(s)}},Hh=function(e){var t=e.properties,n=Object(w.a)(e,["properties"]);if("lc2"in t){var r=t.lc2;if("greeting_unique_id"in r)return function(e,t){return df(Object(C.a)({},e,{invitation:!0,greetingId:t.greeting_id,greetingUniqueId:t.greeting_unique_id}))}(n,r);if(r.welcome_message)return function(e){return df(Object(C.a)({},e,{welcomeMessage:!0}))}(n)}return function(e,t){return df(t.url_details?Object(C.a)({},e,{urlDetails:t.url_details}):e)}(n,t)},Wh=function(e,t){var n=Object(C.a)({},t,{id:Dh(e,t),serverId:t.id,author:Rh(e,t),timestamp:new Date(t.createdAt).getTime()});switch(n.type){case"filled_form":return Yh(n);case"message":return Hh(n);case"rich_message":return gf(n);case"file":return bf(n);case"system_message":return Jh(n);default:return null}},Yh=function(e){return Object(C.a)({},uf(e),{type:"form",properties:{answered:!0,formId:e.formId,formType:e.properties.lc2.form_type,fields:e.fields.filter((function(e){return"answer"in e||"answers"in e&&0!==e.answers.length})).map((function(e){if("string"===typeof e.answer)return e;if("answers"in e){var t=e.answers,n=Object(w.a)(e,["answers"]);return Object(C.a)({},n,{answer:t.map((function(e){return e.label}))})}return Object(C.a)({},e,{answer:e.answer.label})}))}})},Jh=function(e){switch(e.systemMessageType){case"archived_customer_disconnected":case"routing.archived_inactive":return yf(Object(C.a)({},e,{systemMessageType:"client_inactive"}));case"manual_archived_agent":return yf(Object(C.a)({},e,{systemMessageType:"operator_closed_session",textVars:{operator:e.textVars.agent}}));case"manual_archived_customer":return yf(Object(C.a)({},e,{systemMessageType:"chat_closed_by_customer"}));case"system_archived":case"customer_banned":case"routing.archived_deleted":case"routing.archived_disconnected":case"routing.archived_offline":case"routing.archived_other":case"routing.archived_remotely_signed_out":case"routing.archived_signed_out":return yf(Object(C.a)({},e,{systemMessageType:"chat_session_closed"}));case"routing.assigned_other":return yf(Object(C.a)({},e,{systemMessageType:"user_transfer",textVars:{operator:e.textVars.agent}}));case"routing.assigned_deleted":case"routing.assigned_disconnected":case"routing.assigned_inactive":case"routing.assigned_remotely_signed_out":case"routing.assigned_signed_out":return yf(Object(C.a)({},e,{systemMessageType:"user_transfer",textVars:{operator:e.textVars.agent_added}}));case"chat_transferred":return yf(Object(C.a)({},e,{systemMessageType:"user_transfer",textVars:{operator:e.textVars.targets}}));case"agent_joined":case"agent_added":return yf(Object(C.a)({},e,{systemMessageType:"operator_joined_conference",textVars:{operator:e.textVars.agent}}));case"agent_left":case"agent_removed":return yf(Object(C.a)({},e,{systemMessageType:"operator_left_conference",textVars:{operator:e.textVars.agent}}));case"rating.chat_rated":return yf(Object(C.a)({},e,{systemMessageType:"rate_me_confirmation_"+e.textVars.score}));case"rating.chat_commented":return yf(Object(C.a)({},e,{systemMessageType:"rate_me_comment_added",textVars:{comment:e.textVars.comment}}));case"rating.chat_rating_canceled":return yf(Object(C.a)({},e,{systemMessageType:"rate_me_cancel"}));default:return null}},Kh=function(e){var t={};if("rating"in e){var n=e.rating,r=n.score,a=n.comment;"number"===typeof r&&(t.rate=1===r?"good":"bad"),"string"===typeof a&&(t.rateComment=a)}if("lc2"in e){var i=e.lc2,o=i.queue_pos,c=i.queue_waiting_time;o>0&&c>0?t.queue={position:o,waitingTime:c}:-1===o&&-1===c&&(t.queue=null)}return t},Qh=function(e,t){var n=t.type,r=t.id;if("filled_form"===n)return t;if(Object(x.z)(n,["message","url_preview","emoji"])){var a=t.properties,i=a.text,o=a.triggeredBy,c={type:"message",customId:r,text:i};if(o){var s=e.getEvent("liveChatChatId",o.event);c.postback={id:o.button.postback,type:"message",value:o.button.value,event_id:s.serverId,thread_id:s.thread}}return c}},Zh=function(e,t){var n=jn(e,"liveChatChatId");return n?Object(C.a)({},t,{events:t.events.map((function(e){return e.properties.welcomeMessage||e.properties.invitation?Object(C.a)({},e,{id:n.id}):e}))}):t},Xh=function(e,t){var n=e.sdk,r=e.store,a=void 0===t?{}:t,i=a.group,o=a.customerStartingEvent,c=a.agentFakeEvent,s=r.getSessionUser();"Customer"!==s.name&&s.name||n.updateCustomer({name:r.localize("client")});var u=r.getChat("liveChatChatId").serverId,l=1520===r.getApplicationState().license,d=Object(C.a)({},!l&&{access:{groups:["number"===typeof i?i:r.getApplicationState("group")]}},o&&{events:[Qh(r,o)]},c&&function(e){return{threadProperties:{lc2:Object(C.a)({welcome_author_id:e.author,welcome_text:e.properties.originalText},e.properties.invitation&&{greeting_id:e.properties.greetingId,greeting_unique_id:e.properties.greetingUniqueId})}}}(c),dn(r)&&{continuous:!0});return u?n.activateChat(u,d).then((function(e){return Zh(r,Uh(r,e))}),(function(e){if("VALIDATION"===e.code&&"Chat is already active"===e.message){var t=new Error(e.message);throw t.code="CHAT_ALREADY_ACTIVE",t}throw e})):n.startChat(d).then((function(e){return Zh(r,Uh(r,e))}),(function(e){if("VALIDATION"===e.code&&"Customer chats limit reached"===e.message){var t=new Error(e.message);throw t.code="CHAT_ALREADY_ACTIVE",t}throw e}))},$h=function(e){return e.sdk.getChatsSummary().then((function(e){var t=e.chatsSummary,n=Object(x.G)(t);return n?function(e){var t=e.id,n=e.active,r=e.access;return{id:t,active:n,lastThreadId:e.lastThread,group:Lh(r)}}(n):null}))},ev=function(e,t){return e.sdk.getGroupsStatus(t).then((function(e){return t.reduce((function(t,n){var r=e[n];return t[n]=r?Bh(r):"not_found",t}),{})}))},tv=function(e,t){return Object(E.a)(t+"?acao=true").then((function(e){return e.json()})).then((function(e){var t=e.localization;return Object(x.I)((function(e){return e.toLowerCase()}),t)}))},nv=function(e,t,n,r){var a=e.sdk;return void 0===r&&(r=Fh),a.getForm(t,n).then((function(e){return e.enabled?{enabled:!0,form:r(n,e.form)}:e}))},rv=function(e,t){return nv(e,t,"postchat")},av=function(e,t){return nv(e,t,"ticket",Vh)},iv=function(e,t,n){var r=e.sdk,a=e.store;return r.getChatThreads(t,[n]).then((function(e){return Gh(a,e[0])}))},ov=function(e,t){var n=function(e,t){var n=e.sdk,r=e.store,a=n.getChatHistory(t);return{next:function(){return a.next().then((function(e){var t=e.value,n=e.done;return{value:t&&t.map((function(e){return Gh(r,e)})),done:n}}))}}}(e,t);return n.next().then((function(e){return{threads:e.value,hasMore:!e.done,iterator:n}}))},cv="SET",sv=function(e,t){switch(t.code){case"TOO_BIG_FILE":return e.localize("cannot_upload_a_file_over_10mb");case"VALIDATION":return"No active chat thread"===t.message?e.localize("closed_chat_upload_failed"):e.localize("upload_failed");default:return e.localize("upload_failed")}},uv=function(e){return xc(Oc(e))},lv=function(e){var t=e.localization_url;return"https://"+e.serv+t},dv=function(e){var t=e.getChat("liveChatChatId").properties,n=t.rate,r=t.rateComment,a=t.queued,i=e.getView("Chat/queue");return{rate:n,rateComment:r,queue:a?{position:i.numberInQueue,waitingTime:i.waitingTime}:null}},pv=function(e,t,n){var r=!t.getApplicationState("clientLimitExceeded"),a=function(e,t){var n=t.license,r=t.group,a=t.region,i=t.uniqueGroups,o=t.autoConnect,c=t.mobile,s=e.getSessionUser(),u=e.getApplicationState("page"),l={license:n,clientId:"c5e4f61e1a6c3b1521b541bc5c5a2ac5",mobile:c,customer:{name:s.name,email:s.email,fields:s.properties},region:a,page:Object(x.W)(["url","title"],u),referrer:u.referrer,autoConnect:o,uniqueGroups:i};return null!==r&&(l.group=r),Ah(l,"production")}(t,Object(C.a)({},e,{autoConnect:r})),i={sdk:a,store:t},o=D(),c=null,s={};n.pre_chat_survey&&t.updateView("Chat/prechat",_f("prechat",Oc(n.pre_chat_survey))),n.offline_form&&t.updateView("Chat/offline",_f("offline",uv(n.offline_form))),n.group_properties.chat_boosters&&function(e,t){try{var n=JSON.parse(t).filter((function(e){return"moment"===e.template_id}));if(Object(x.B)(n))return;ui(e,"boosters",{items:n.map((function(e){var t={type:"button",label:e.action.label,url:e.action.url};return e.action.webview_height&&(t.webviewHeight=e.action.webview_height),{id:e.id,template:e.template_id,title:e.title,description:e.description,icon:e.icon,action:t}}))})}catch(r){}}(t,n.group_properties.chat_boosters);var u=function(){(Cn("liveChatChatId",t)||t.getApplicationState().destroyed)&&t.updateView("minimized",{hidden:!0})},l=function(){a.destroy(),t.setApplicationState({destroyed:!0}),u()},d=function(){return t.getChat("liveChatChatId").serverId},p=function(e,n){pn(t)&&!c&&(c=n||a.getChatHistory(e))},f=function(e){var n=e.id,r=e.group,a=e.thread,i=e.agent,o=e.events,c=e.properties,s=!!c.queue;if(p(n),o.forEach(S),ei(t,{id:n,thread:a,group:r,queued:s,agent:i}),Yn(t)){var u=c.queue,l=u.position,d=u.waitingTime;t.updateView("Chat/queue",{numberInQueue:l,waitingTime:d}),Ei(t)}},m=function(){return t.getChat("liveChatChatId").properties.lastThread},h=function(e){return"good"===e?1:"bad"===e?0:null},v=function(e){return a.rateChat(d(),Object(x.d)({comment:e.rateComment,score:h(e.rating)})).then((function(){t.updateChat("liveChatChatId",{properties:Object(x.d)({rate:e.rating,rateComment:e.rateComment})})}),x.P)},g=function(e){return a.cancelRate(d(),e).then((function(){t.updateChat("liveChatChatId",{properties:e.reduce((function(e,t){return"comment"===t?e.rateComment=null:"score"===t&&(e.rate=null),e}),{})})}),x.P)},b=function(e){var n=t.getChat("liveChatChatId").properties,r=n.rate,a=n.rateComment,i={comment:"NOTHING",score:"NOTHING"};e.rating!==r&&(i.score=null===e.rating?"CANCEL":cv);var o="string"===typeof e.rateComment&&""!==e.rateComment;return a&&!o||"CANCEL"===i.score&&a?i.comment="CANCEL":!o||a&&e.rateComment===a||(i.comment=cv),i},y=function(){return av(i,t.getApplicationState("group")).then((function(e){e.enabled?(t.updateView("Chat/offline",e.form),pi(t),t.setCurrentView("Chat")):t.setCurrentView("Chat")}))},j=function(){var e=An("liveChatChatId",t),n=t.getEvents("liveChatChatId"),r=m(),a=Object(x.ib)((function(e){return e.thread===r}),n).some((function(e){var t=e.author;return!e.own&&"system"!==t}));Ka(t),e&&!a||rv(i,O()).then((function(e){var n=e.enabled,r=e.form;n&&ii(t,r)}),x.P)},O=function(){var e=t.getChat("liveChatChatId").properties.group,n=t.getApplicationState("group");return"number"===typeof e?e:n},_=function(e){var n=e.id,r=e.name,a=e.email,i=void 0===a?null:a;if(t.getSessionUser().serverId===n){var o={email:i,properties:e.fields};return"Customer"!==r&&(o.name=r),void t.updateUser(t.getSessionUserId(),o)}t.getUser(n)?"agent"===e.type&&e.isBot&&t.updateUser(n,{properties:{isBot:!0}}):t.addUser({id:n,type:"agent",name:r,avatar:"https://"+Object(I.j)(e.avatar),properties:{jobTitle:e.jobTitle,isBot:e.isBot||!1}})},E=function(e){var n=dv(t),r={};if(n.rate!==e.rate&&(r.rate=e.rate),n.rateComment!==e.rateComment&&(r.rateComment=e.rateComment),!Object(x.eb)(n.queue,e.queue)){var a=e.queue;!t.getChat("liveChatChatId").properties.ended&&a?function(e,t){var n=t.thread,r=t.numberInQueue,a=t.waitingTime,i={active:!0,properties:{queued:!0}};n&&(i.properties.lastThread=n),e.updateChat("liveChatChatId",i),e.updateView("Chat/queue",{numberInQueue:r,waitingTime:a})}(t,{numberInQueue:a.position,waitingTime:a.waitingTime}):r.queued=!1}t.updateChat("liveChatChatId",{properties:r}),Yn(t)?Ei(t):Jn(t)&&_i(t),!Fn(t)&&Kn(t)&&Ci(t)},S=function(e){Wa(t,"liveChatChatId",e),"message"===e.properties.serverType&&t.getApplicationState("ready")&&wf(t,e.id)},k=function(e){var n=Wh(t,e);n&&S(n)},T=function(e){var n=function(e){var t=e.id,n=e.unique_id,r=e.displayed_first_time,a=e.agent,i=e.text;return{author:{id:a.id,name:a.name,avatar:Ph(a.avatar),type:"agent",jobTitle:a.job_title,isBot:a.is_bot},event:{authorId:a.id,text:i,receivedFirstTime:r,properties:{greetingId:t,greetingUniqueId:n}}}}(e),r=n.author,a=n.event;_(r);var i=t.getChat("liveChatChatId"),o=i.serverId;i.properties.ended&&oi(t,"liveChatChatId",{chatId:o}),vi(t),di(t,a)},A=function(e){xn(t)&&(qn(t,"postchat")?t.updateChat("liveChatChatId",{properties:{postponedInvitation:e}}):_n("liveChatChatId",t)&&T(e))},P=function(e){return!!e&&-1!==e.indexOf(t.getApplicationState("group"))};a.on("chat_thread_properties_deleted",(function(e){var n=e.thread,r=e.properties;n===m()&&"rating"in r&&Object(x.z)("score",r.rating)&&E(Object(C.a)({},dv(t),{rate:null}))})),a.on("chat_thread_properties_updated",(function(e){var n=e.thread,r=e.properties;n===m()&&E(Object(C.a)({},dv(t),Kh(r)))})),a.on("chat_transferred",(function(e){if("group"===e.type){var n=e.ids[0];t.updateChat("liveChatChatId",{properties:{group:n}})}})),a.on("customer_updated",(function(e){t.updateUser(t.getSessionUserId(),Object(C.a)({},Object(x.Z)(["name","email"],e),{properties:e.fields})),t.emit("customer_updated")})),a.on("event_updated",(function(e){var n=e.chat,r=e.thread,a=e.event;if(n===d()&&r===m()&&Object(x.u)("properties.lc2.welcome_message",a)){var i=t.getEventByServerId("liveChatChatId",a.id);a.author!==i.author&&(t.setEventData("liveChatChatId",i.id,{author:a.author}),t.recalculateTimeline("liveChatChatId")),a.text!==i.properties.text&&t.updateEvent("liveChatChatId",i.id,{properties:{text:a.text}})}})),t.on("set_application_state",(function(e){var n=e.pageFocused;En(t)&&n&&(t.setConnectionState(sn),a.connect())})),a.on("disconnected",(function(e){var n=e.reason;switch(n){case"product_version_changed":case"wrong_product_version":return void t.emit("protocol_upgraded",{version:"2"});case"identity_mismatch":case"too_many_connections":return or(n),void l();case"customer_banned":case"license_not_found":case"unsupported_version":case"users_limit_reached":return void l();case"inactivity_timeout":return void(t.getApplicationState("pageFocused")||(t.setConnectionState(cn),a.disconnect()));default:return}})),a.on("user_joined_chat",(function(e){var n=e.chat,r=e.user;n===d()&&t.getSessionUser().serverId!==r&&un("liveChatChatId",t)!==r&&ri(t,r)})),a.on("user_left_chat",(function(e){var n=e.chat,r=e.user;n===d()&&(t.removeParticipant("liveChatChatId",r),t.getSessionUser().serverId!==r&&un("liveChatChatId",t)===r&&ri(t,null))})),a.on("user_data",_);var N=function(){Cn("liveChatChatId",t)&&$a(t),t.setApplicationState({ready:!0})},M=function(e){var t=e.dynamicConfig,r=e.chatId,a=function(e,t){var n=e.monitoring,r=e.chats,a=Object.keys(r).find((function(e){return Object(x.z)(t,r[e].chat_ids)}));if(a!==n.id)return r[a].language_config_url?r[a].language_config_url:void 0}(t.customer_groups,r);if(a){var i=lv({localization_url:a,serv:n.serv});return{queueTemplate:tv(0,i).then((function(e){return e.user_in_queue}))}}},z=function(e){var n=e.active,r=e.chatId,a=e.lastThreadId,o=e.becameInactive;if(pn(t))return{fetchedHistory:ov(i,r)};if(o){var c=t.getChat("liveChatChatId");return{fetchedThread:iv(i,r,c.properties.lastThread)}}return n?{fetchedThread:iv(i,r,a)}:void 0},R=function(e){e.filter((function(e){return!t.hasEvent("liveChatChatId",e.id)})).forEach(S)},L=function(e,n){var r=e.eagerFetchingMode,a=n.id,i=n.active,o=n.agent,c=n.group,s=n.events,u=n.properties,l=t.getChat("liveChatChatId"),d=!i&&l.active;t.updateChat("liveChatChatId",{active:i,properties:Object(C.a)({ended:l.properties.ended,lastThread:a,group:c},d&&{ended:!0,queued:!1,agentIsTyping:!1})}),i&&ri(t,o),E(Object(C.a)({rate:null},u,{queue:i?u.queue:null},!r&&!i&&{rate:null,rateComment:null})),i&&vi(t),R(s)},B=function(e){var t=e.online_groups_ids,n=e.customer_groups;if(!t)return"offline";var r=n.monitoring.id;return Object(x.z)(r,t)?"online":"offline"},q=function(e){null===yn(t,"liveChatChatId")&&t.updateChat("liveChatChatId",{properties:{hasMoreHistory:e}})};a.on("connected",(function(e){var n,r=e.__unsafeDynamicConfig,c=e.__unsafeChats,l=t.getSessionUser();_({id:l.serverId,name:r.customer_data.name,email:l.email}),"boolean"!==typeof t.getApplicationState().isReturning&&t.setApplicationState({isReturning:r.customer_data.visits_count>1}),t.setApplicationState({clientChatNumber:r.customer_data.chats_count||0,clientVisitNumber:r.customer_data.visits_count||0}),s={availability:B(r),greeting:r.greeting},Promise.resolve().then((function(){if(c.length){var e=c[0],a=e.id,o=e.active,s=e.hasUnreadEvents;t.setApplicationState({hasUnseenEvents:s});var u=!o&&t.getChat("liveChatChatId").active;n={active:o,chatId:a,becameInactive:u,dynamicConfig:r},null===t.getChat("liveChatChatId").serverId&&t.setChatServerId("liveChatChatId",a);var l=t.getApplicationState(),d=l.maximized,p=l.eagerFetchingMode;if(o||d||p)return $h(i)}})).then((function(e){return e?(n.group=e.group,n.lastThreadId=e.lastThreadId,n.becameInactive?sf(Object(C.a)({chatSummary:e},function(e){var n=e.group,r=pn(t)?n:O();return{postchatForm:rv(i,r).catch((function(){return{enabled:!1}}))}}(n),z(n))):e.active?sf(Object(C.a)({chatSummary:e},M(n),z(n))):sf(Object(C.a)({chatSummary:e},z(n)))):sf({})})).then((function(e){return!!e.chatSummary&&e.chatSummary.active?e:sf(Object(C.a)({},e,{maximizedDecisionActions:ce()?oe({active:!1,availability:s.availability,connected:!0,hasFakeAgentMessage:On(t,"liveChatChatId")||!!s.greeting}).then((function(e){var t=e.filter((function(e){return"nothing"!==e.type}));return t.length>0?t:null})):null}))})).then((function(e){var n=e.queueTemplate,r=e.chatSummary,a=e.postchatForm,i=e.maximizedDecisionActions,o=Object(w.a)(e,["queueTemplate","chatSummary","postchatForm","maximizedDecisionActions"]),c=s;if(s={},n&&t.setLocalization({user_in_queue:n}),t.setApplicationState({availability:c.availability}),!r)return i&&(vi(t),fe(i)),void(c.greeting&&A(c.greeting));var u={chatId:r.id,eagerFetchingMode:t.getApplicationState().eagerFetchingMode};t.setApplicationState({eagerFetchingMode:!0});var l=m()&&r.lastThreadId!==m();if(pn(t)){var d=o.fetchedHistory;(function(e,t){var n=e.getChat("liveChatChatId").properties.lastThread;return n&&!t.some((function(e){var t=e.id;return n===t}))})(t,d.threads)&&or("threads_gap",null,{meta:JSON.stringify({stateLastThreadId:t.getChat("liveChatChatId").properties.lastThread,fetchedThreads:d.threads.map((function(e){return e.id}))})}),l&&oi(t,"liveChatChatId",{chatId:t.getChat("liveChatChatId").serverId}),function(e,t){p(e.chatId,t.iterator),q(t.hasMore);var n=Object(x.fb)(-1,t.threads),r=n[0],a=n[1][0];R(Object(x.p)((function(e){return e.events}),r)),L(e,a)}(u,d)}else o.fetchedThread&&(l&&r.active&&oi(t,"liveChatChatId",{chatId:t.getChat("liveChatChatId").serverId}),L(u,o.fetchedThread));i&&(vi(t),fe(i)),r.active||(a&&a.enabled?ii(t,a.form):c.greeting&&A(c.greeting))})).then((function(){Jn(t)&&(_i(t),Yn(t)&&Ei(t)),Kn(t)&&(Ci(t),Fn(t)&&Ii(t))})).then((function(){t.setDefaultView("Chat","timeline"),t.setConnectionState(on),u(),t.getChat("liveChatChatId").active&&t.setApplicationState({hidden:!1}),o.resolve()})).catch((function(e){switch(s={},e.code){case"CONNECTION_LOST":return;case"REQUEST_TIMEOUT":return a.disconnect(),void a.connect();case"INTERNAL":return void ir("Notice","connection_fetcher_internal_error");default:return void or("connection_fetcher_error",e)}}))})),ci(gs(n),t),a.once("customer_id",(function(e){return yi(t,e)}));var U=ta(t),F=function(e){return Pr()(U,Dr(e))},V=Pr()(ea(t,(function(e){return e.application.maximized})),jr()(Boolean),Rr()((function(){return{type:"maximized"}})),Hr.a),G=Pr()(ea(t,(function(){return t.getSessionUser().serverId})),jr()(Boolean),Qr()(1),$r.a);r?(t.setApplicationState({clientLimitExceededLifted:!0}),tv(0,lv(n)).then(t.setLocalization).then((function(){return o.promise})).then(N)):Promise.all([tv(0,lv(n)),G]).then((function(e){var r,i=e[0];t.setLocalization(i),r=n.skills_online,t.setApplicationState({availability:P(r)?"online":"offline"}),t.setConnectionState("fakely_connected"),u(),N();var o,c,s=(o=document,c=["click","touchstart"],Er.a.apply(void 0,c.map((function(e){return Object(Cr.a)(o,e)}))));Pr()(Er()(s,V),Qr()(1),_r()((function(){t.setApplicationState({clientLimitExceededLifted:!0}),a.connect()})))})),"ononline"in window&&(a.on("connection_unstable",(function(){t.setConnectionState(sn)})),a.on("connection_recovered",(function(){t.setConnectionState(on)}))),a.on("connection_lost",(function(){t.setConnectionState(sn)})),a.on("incoming_greeting",(function(e){wn(t)?A(e):s.greeting=e})),a.on("incoming_multicast",(function(e){var n=e.type,r=e.content;if("lc2"===n)if("groups_update"===r.name&&"groups"in r){var a=t.getApplicationState("group"),i=Object(x.k)((function(e){return e.id===a}),r.groups);if(!i)return;var o=Bh(i.status);wn(t)?t.setApplicationState({availability:o}):s.availability=o}else if("greeting"in r){var c=r.greeting;wn(t)?A(c):s.greeting=c}else;})),a.on("events_marked_as_seen",(function(e){var n=e.chat,r=e.user,a=e.seenUpTo;if(n===d()){var i=new Date(a).getTime();(t.getSessionUser().serverId===r?hn:mn)("liveChatChatId",i,t).forEach((function(e){t.updateEvent("liveChatChatId",e.id,{seen:!0})}))}})),a.on("new_event",(function(e){var n=e.chat,r=e.event;n===d()&&("postchat"===Object(x.u)("properties.lc2.form_type",r)&&(!function(e){ji(e,"postchat")}(t),t.setDefaultView("Chat","timeline")),Pn("liveChatChatId",t)&&or("received_event_during_chat_starting"),k(r))})),a.on("thread_closed",(function(e){e.chat===d()&&j()})),a.on("incoming_chat_thread",(function(e){oi(t,"liveChatChatId",{chatId:t.getChat("liveChatChatId").serverId});var n=Uh(t,e);f(n)}));var H=function(e){var n=e.user;if(e.chat!==d())return!1;var r=un("liveChatChatId",t);return!!r&&r.id===n},W=Pr()(Ir(a,"user_is_typing"),jr()(H),Rr()((function(){return!0}))),Y=Pr()(Ir(a,"user_stopped_typing"),jr()(H),Rr()((function(){return!1}))),J=Pr()(Ir(a,"new_event"),jr()((function(e){var n=e.chat,r=e.event.author;return n===d()&&t.getSessionUser().serverId!==r&&"system"!==r})));Pr()(Er()(Pr()(W,jr()((function(){return!t.getChat("liveChatChatId").properties.messageDraft}))),Y,Pr()(J,Rr()((function(){return!1})))),Dr((function(e){return e?Object(dr.a)(Object(Vr.a)(!0),Pr()(Object(Xr.a)(1e4),Rr()((function(){return!1})))):Object(Vr.a)(!1)})),Object(vr.a)(),_r()((function(e){t.updateChat("liveChatChatId",{properties:{agentIsTyping:e}})})));Pr()(ea(t,(function(){return t.getChat("liveChatChatId").properties.loadingHistory})),jr()(Boolean),_r()((function e(){c.next().then((function(n){var r=n.value,a=n.done,i=t.getTimeline("liveChatChatId").length,o=Object(x.p)((function(e){return e.events.map((function(e){return Object(C.a)({},e,{seen:!0})}))}),r).filter((function(e){return!t.hasEvent("liveChatChatId",e.id)}));o.length>0&&t.addHistoryEvents("liveChatChatId",o),i!==t.getTimeline("liveChatChatId").length||a?t.updateChat("liveChatChatId",{properties:{loadingHistory:!1,hasMoreHistory:!a}}):e()}),(function(){t.updateChat("liveChatChatId",{properties:{loadingHistory:!1}})}))}))),t.on("request_update_chat",(function(e){var n=e.resolve,r=e.reject,i=e.data,o=i.properties,c=void 0===o?{}:o,s=Object(w.a)(i,["properties"]);if(c.rateComment){var u=c.rateComment;kf(t,u),a.rateChat(d(),{comment:u}).then(n,r)}else if("undefined"!==typeof c.rate){Tf(t,c.rate);var l=t.getApplicationState().testGroup;if(sr({testGroup:l,chatRating:null===c.rate?"canceled":c.rate,chatRatingSource:"other"}),null===c.rate)return void a.cancelRate(d()).then((function(){t.updateChat("liveChatChatId",{properties:{rateComment:null}}),n()}),r);a.rateChat(d(),{score:h(c.rate)}).then(n,r)}else c.transcriptSentTo?a.updateChatThreadProperties(d(),m(),{routing:{transcript_email:c.transcriptSentTo}}).then(n,r):!1===s.active?a.closeThread(d()).then((function(){j(),n()}),r):"string"===typeof c.messageDraft&&(t.getChat("liveChatChatId").active&&a.setSneakPeek(d(),c.messageDraft),n())}));var K=function(e){return"name"===e.name?"name":"text"===e.type?"question":e.type},Q=function(e,t){var n=e.id,r=e.properties,a=r.formType,i=r.formId,o=r.fields,c=xf(o,t),s=c.fields,u={filledForm:{customId:n,type:"filled_form",formId:i,fields:o.filter((function(e){return void 0!==e.serverName&&"rating"!==e.type&&"information"!==e.type})).map((function(e){if("groupSelect"===e.meta)return{type:"group_chooser",id:e.serverName,label:mc(e.label),answer:{id:String(c.choosenGroupIndex),group_id:c.choosenGroup,label:e.options[c.choosenGroupIndex].label}};if("confirm_subscription"===e.meta){var t=s[e.serverName];return{type:"checkbox_for_email",id:e.serverName,label:e.options[0].label,answer:!!t&&Object(x.z)(e.options[0].originalValue,t)}}if(Object(x.A)(e.options)){var n={type:K(e),id:e.serverName,label:mc(e.label)},r=Object(x.x)(e.serverName,s)?Object(x.i)(s[e.serverName]):[],a=e.options.filter((function(e){return Object(x.z)(e.originalValue,r)})).map((function(e){return{label:e.label,value:e.originalValue}}));if("checkbox"===n.type)n.answers=a.map((function(e){return{label:e.label,id:e.value}}));else if(a.length){var i=a[0];n.answer={id:i.value,label:i.label}}return n}return Object(x.x)(e.serverName,s)?{type:K(e),id:e.serverName,label:mc(e.label),answer:s[e.serverName]}:{type:K(e),id:e.serverName,label:mc(e.label)}})),properties:{lc2:{form_type:a}}}};return void 0!==c.choosenGroup&&(u.choosenGroup=c.choosenGroup),u},Z=0,X=Object(x.mb)(300,(function(e){var t=new Date(e).toISOString().replace(/Z$/,"999Z");a.markEventsAsSeen(d(),t).catch(x.P)}));t.on("request_update_event",(function(e){var n,r,o=t.getEvent("liveChatChatId",e.id);if(e.data.seen)e.resolve(),Z=Math.max(Z,t.getEvent("liveChatChatId",e.id).timestamp),X(Z);else if("offline"===o.properties.formType){var c=e.data.properties.answers,s=o.properties.fields,u=xf(s,c).fields,p=t.getApplicationState(),f=t.getSessionUser(),m=o,h=Ws({license:p.license,group:p.group,visitorId:f.serverId,visitorData:{pageUrl:p.page.url},defaultValues:{name:t.localize("client")}},uv(m.properties),u);Ac("v2/tickets/new",{environment:"production",license:p.license,body:h}).then((function(n){var r=o.properties.fields;Pf(t,r,u,Ys(n.id,h)),e.resolve(),li(t,e.id),t.setCurrentView("Chat")}),(function(n){wi(n,t.localize,e.reject)}))}else if("prechat"===o.properties.formType){var j=e.data.properties.answers,O=o.properties.fields;If(t,O,xf(O,j).fields);var _=Object(x.Z)(["name","email"],j);Object(x.B)(_)||a.updateCustomer(_);var w=Q(o,j),E=w.filledForm,I=w.choosenGroup,S=function(n){re(Object(C.a)({customerStartingEvent:E,agentFakeEvent:jn(t,"liveChatChatId")},n)).then((function(n){ne(n),e.resolve(),t.setDefaultView("Chat","timeline")}),(function(t){switch(t.code){case"GROUPS_OFFLINE":return void y().then(e.resolve,e.reject);case"CUSTOMER_BANNED":case"GROUP_NOT_FOUND":return void l();default:e.reject()}}))};if(void 0!==I)return void(n=i,r=I,ev(n,[r]).then((function(e){return e[r]}))).then((function(e){if("not_found"===e){var t=new Error('Group "'+I+'" not found (most likely it has been removed).');throw t.code="GROUP_NOT_FOUND",t}return e})).then((function(n){t.setApplicationState({group:I}),"online"===n?S({group:I}):av(i,t.getApplicationState("group")).then((function(e){e.enabled?(ui(t,"offlineForm"),t.updateView("Chat/offline",e.form)):function(e,t){si(e,t,{enabled:!1})}(t,"offlineForm"),t.setApplicationState({availability:"offline"})}),(function(t){"CONNECTION_LOST"!==t.code?l():e.reject()}))}),(function(t){"CONNECTION_LOST"!==t.code?l():e.reject()}));S()}else if("postchat"===o.properties.formType){var k=e.data.properties.answers,A=o.properties.fields;Sf(t,A,xf(A,k).fields);var P=Q(o,k).filledForm;a.sendEvent(d(),P,{attachToLastThread:!0}).then((function(n){e.resolve(),li(t,e.id,Wh(t,n));var r=t.getApplicationState().availability,a=t.getChat("liveChatChatId").properties.postponedInvitation;"online"===r&&a?Promise.resolve().then((function(){t.updateChat("liveChatChatId",{properties:{postponedInvitation:void 0}}),T(a),t.setDefaultView("Chat","timeline")})):t.setDefaultView("Chat","timeline"),"rating"in k&&function(e,t){var n=b(t),r=e.getApplicationState().testGroup;if("NOTHING"!==n.score||"NOTHING"!==n.comment){sr({testGroup:r,chatRating:"CANCEL"===n.score?"canceled":t.rating,chatRatingSource:"postchat"});var a=[];n.score===cv&&n.comment===cv?(a.push(v(t)),Tf(e,t.rating),kf(e,t.rateComment)):"CANCEL"===n.score&&"CANCEL"===n.comment?a.push(g(["comment","score"])):("CANCEL"===n.score?a.push(g(["score"])):n.score===cv&&(a.push(v({rating:t.rating})),Tf(e,t.rating)),"CANCEL"===n.comment?a.push(g(["comment"])):n.comment===cv&&(a.push(v({rateComment:t.rateComment})),kf(e,t.rateComment))),Promise.all(a.map((function(e){return e.catch(x.P)})))}}(t,k)}))}})),t.on("request_update_user",(function(e){var n=e.resolve,r=e.id,i=e.data,o=i.properties,c=Object(w.a)(i,["properties"]);if(t.getSessionUserId()===r){var s=Object(x.d)({name:c.name,email:c.email,fields:o});a.updateCustomer(s),n()}})),t.on("update_event",(function(e){var n=e.event;"file"===n.type&&n.properties.canceled&&Ja(t,n.id)})),t.on("request_set_user_properties",(function(e){var n=e.resolve,r=e.id,i=e.properties;t.getSessionUserId()===r&&(a.setCustomerFields(i),n())}));var $=function(e,n){var r=n.id,a=n.timestamp,i=n.thread;Af(t,e,a),t.setEventServerId("liveChatChatId",e.id,r),t.updateEvent("liveChatChatId",e.id,{delivered:!0,serverTimestamp:a,thread:i})},ee=function(e){t.updateEvent("liveChatChatId",e.id,{failed:!0})},te=function(e){var n=e.event,r=e.meta;if("file"===n.type)return Ya(t,n.id),a.uploadFile(d(),{customId:n.id,file:r.file},{onProgress:function(e){t.updateEvent("liveChatChatId",n.id,{properties:{progress:e}})}}).then((function(e){var t=e.url;return a.sendEvent(d(),{type:"file",url:t})})).then((function(e){t.updateEvent("liveChatChatId",n.id,{delivered:!0,properties:{url:e.url}}),Ja(t,n.id),k(e)}),(function(e){var r={failed:!0,failReason:sv(t,e)};t.updateEvent("liveChatChatId",n.id,{properties:r})}));if("message"===n.type||"emoji"===n.type)return a.sendEvent(d(),Qh(t,n)).then((function(e){$(n,e)}),(function(){ee(n)}));if("rich_message_postback"===n.type){var i=n.properties,o=i.eventId,c=Object(w.a)(i,["eventId"]),s=t.getEvent("liveChatChatId",o),u=s.id,l=s.thread;return a.sendPostback(d(),l,u,c).catch(x.P)}if("url_preview"===n.type){var p=a.getUrlDetails(n.properties.url).catch((function(){return null}));return a.sendEvent(d(),Qh(t,n)).then((function(e){$(n,e),p.then((function(r){if(null!==r){var i=r.title,o=r.description,c=r.image,s=c.url,u=c.width,l=c.height,p=r.url;return t.updateEvent("liveChatChatId",n.id,{properties:{title:i,description:o,image:{url:s,link:p}}}),a.updateEventProperties(d(),e.thread,e.id,{url_details:{title:i,description:o,url:p,image_url:s,image_width:u,image_height:l}})}})).catch(x.P)}),(function(){ee(n)}))}},ne=function(e){var n=e.events,r=Object(w.a)(e,["events"]),a=t.getSessionUser().id;n.forEach((function(e){e.author===a?function(e,t){var n=new Date(t.createdAt).getTime();"message"===t.properties.serverType&&Af(e,t,n),e.setEventServerId("liveChatChatId",t.id,t.serverId);var r={delivered:!0,serverTimestamp:n,thread:t.thread};"form"===t.type&&(r.properties={answered:!0,fields:t.properties.fields}),e.updateEvent("liveChatChatId",t.id,r)}(t,e):(e.properties.welcomeMessage||e.properties.invitation)&&t.hasEvent("liveChatChatId",e.id)?function(e,t){var n=t.serverId,r=t.author,a=t.properties.text,i=jn(e,"liveChatChatId");e.setEventServerId("liveChatChatId",i.id,n);var o=i.author!==r;o&&e.setEventData("liveChatChatId",i.id,{author:r}),i.properties.text!==a&&e.updateEvent("liveChatChatId",i.id,{properties:{text:a}}),o&&(ri(e,r),e.recalculateTimeline("liveChatChatId"))}(t,e):S(e)})),f(Object(C.a)({},r,{events:[]}))},re=function(e){return t.updateChat("liveChatChatId",{properties:{starting:!0}}),Xh(i,e).then((function(e){return t.updateChat("liveChatChatId",{properties:{starting:!1}}),e}),(function(e){throw t.updateChat("liveChatChatId",{properties:{starting:!1}}),e}))},ae=[];t.on("send_event",(function(e){if(Pn("liveChatChatId",t))ae.push(e);else{var n=function(){(function(e){var t=e.getChat("liveChatChatId").properties,n=t.lastThread,r=t.currentAgent;return!(!dn(e)||r)&&!!!Object(x.n)((function(e){var t=e.type,r=e.thread;return"email_prompt"===t&&r===n}),e.getEvents("liveChatChatId"))})(t)&&function(e){var t=Object(x.t)(e.getEvents("liveChatChatId")),n=e.getChat("liveChatChatId").properties.lastThread;e.addEvent("liveChatChatId",{id:t,serverId:null,seen:!0,type:"email_prompt",author:"system",thread:n})}(t)};t.getChat("liveChatChatId").active?te(e).then(n):re({customerStartingEvent:e.event,agentFakeEvent:jn(t,"liveChatChatId")}).then((function(e){ne(e);var t=ae;ae=[],t.forEach(te),n()}),(function(n){t.updateEvent("liveChatChatId",e.event.id,{failed:!0});var r=ae;switch(ae=[],r.forEach((function(e){t.updateEvent("liveChatChatId",e.id,{failed:!0})})),n.code){case"CUSTOMER_BANNED":return void l();case"GROUPS_OFFLINE":return void y();default:return}}))}}));var ie=function(e){return re({agentFakeEvent:e}).then((function(e){return[{type:"hide_offline_form"},{type:"chat_activated",payload:e}]}),(function(e){switch(e.code){case"WIDGET_DESTROYED":case"CHAT_ALREADY_ACTIVE":return{type:"nothing"};case"GROUPS_OFFLINE":return av(i,t.getApplicationState("group")).then((function(e){return e.enabled?{type:"nothing"}:{type:"show_offline_form",payload:e.form}}));case"CUSTOMER_BANNED":default:return{type:"panic"}}}))},oe=function(e){var n=e.active,r=e.availability,a=e.connected,o=e.hasFakeAgentMessage;return Object(Em.a)((function(){return n?{type:"nothing"}:"offline"===r?Bn(t)?Hn(t)||dn(t)?{type:"nothing"}:{type:"show_offline_form"}:{type:"hide_prechat_form"}:o?{type:"hide_offline_form"}:t.getApplicationState().maximized?Ln(t)?{type:"show_prechat"}:a?function(e){var t=e.sdk,n=e.store,r=1520===n.getApplicationState().license;return t.getPredictedAgent(r?void 0:n.getApplicationState("group")).then((function(e){var t,r=n.localize("welcome_to_chat");return{agent:e,message:df((t={id:Object(x.t)(n.getIndexedEvents("liveChatChatId")),type:"message",author:e.id,text:tr(n,r,{agent:e.name}),originalText:r,welcomeMessage:!0},Object(C.a)({},t,{serverId:null,timestamp:Date.now(),seen:!0,properties:t.properties||{}})))}}))}(i).then((function(e){var t=e.agent,n=e.message;return t.isBot?ie(n):[{type:"hide_offline_form"},{type:"predicted_welcome_message",payload:{agent:t,message:n}}]}),(function(e){if("offline"===t.getApplicationState("availability"))return{type:"nothing"};switch(e.code){case"GROUP_UNAVAILABLE":return ie();case"GROUP_OFFLINE":return{type:"nothing"};default:return{type:"panic"}}})):{type:"nothing"}:{type:"nothing"}})).then(x.i)},ce=function(){var e=t.getChat("liveChatChatId");return(!e.active||e.properties.queued)&&!e.properties.starting&&!e.properties.ended},se=function(){t.updateView("minimized",{hidden:!1})},ue=Pr()(ea(t,(function(e){return e.application.destroyed})),jr()(Boolean),Qr()(1),Hr.a);Pr()(V,_r()(se));var le=Pr()(ea(t,(function(e){return e.application.availability})),Jr()(1),Wr.a,Rr()((function(e){return{type:e}})),Object(Gr.a)((function(e){return"online"===e.type}))),de=le[0],pe=le[1];Pr()(pe,jr()(ce),_r()((function(){dn(t)&&_i(t),Fn(t)&&(!dn(t)&&qn(t,"prechat")&&Oi(t),Ii(t)),u()}))),Pr()(de,jr()(ce),_r()((function(){t.getView("minimized").hidden&&se(),Kn(t)&&Ci(t),!Jn(t)&&Yn(t)&&Ei(t)}))),Pr()(F((function(){if(!Ln(t))return Fr.a;var e=ea(t,(function(){return qn(t,"prechat")}));return Pr()(Er()(V,e),jr()((function(){return qn(t,"prechat")})),Dr((function(){var e=t.getLastEvent("liveChatChatId");return Pr()(Object(Tr.a)(function(e,t){var n=Object(x.l)((function(e){return"groupSelect"===e.meta}),t);if(-1===n)return Promise.resolve(null);var r=t[n],a=r.options.map((function(e){return parseInt(e.groupNumber,10)}));return a.length>20?Promise.resolve(null):ev(e,a).then((function(e){return Object(x.qb)(n,Object(C.a)({},r,{options:r.options.map((function(t){return Object(C.a)({},t,{meta:{online:"online"===e[parseInt(t.groupNumber,10)]}})}))}),t)}))}(i,e.properties.fields)),Ur)})))})),jr()((function(e){return e&&qn(t,"prechat")})),_r()((function(e){var n=t.getLastEvent("liveChatChatId").id;return t.updateEvent("liveChatChatId",n,{properties:{fields:e}})})));var fe=function(e){return e.forEach((function(e){switch(e.type){case"panic":return void l();case"chat_activated":return void ne(e.payload);case"predicted_welcome_message":var n=e.payload,r=n.agent,a=n.message;return _(r),ri(t,r.id),S(a),void t.updateChat("liveChatChatId",{properties:{fakeAgentMessageId:a.id}});case"show_offline_form":return e.payload&&t.updateView("Chat/offline",e.payload),void pi(t);case"hide_prechat_form":return void Oi(t);case"hide_offline_form":return void(qn(t,"offline")&&(xi(t),t.setDefaultView("Chat","timeline")));case"show_prechat":return void ai(t);default:return}}))},me=function(){return{active:t.getChat("liveChatChatId").active,availability:t.getApplicationState("availability"),connected:wn(t),hasFakeAgentMessage:On(t,"liveChatChatId")}};Pr()(F((function(){return Pr()(ea(t,(function(){return t.getChat("liveChatChatId").properties.startChatAgainPending})),jr()(Boolean))})),Dr((function(){return Object(Tr.a)(oe(me()))})),_r()((function(e){oi(t,"liveChatChatId",{chatId:t.getChat("liveChatChatId").serverId}),fe(e)}))),Pr()(F((function(){return Pr()(Er()(V,de,pe),jr()((function(){return ce()&&t.getApplicationState().eagerFetchingMode})))})),Object(br.a)((function(){return Object(Tr.a)(oe(me()))})),Object(Zr.a)(ue),_r()(fe)),Pr()(F((function(){return Pr()(V,jr()((function(){return!t.getApplicationState().eagerFetchingMode})))})),Dr((function(){var e=t.getChat("liveChatChatId").serverId;return Object(Tr.a)(Promise.all([oe(me()),pn(t)&&e&&ov(i,e)].filter(Boolean)))})),Object(Zr.a)(ue),_r()((function(e){var n=e[0],r=e[1];if(vi(t),r){p(t.getChat("liveChatChatId").serverId,r.iterator),q(r.hasMore);var a=Object(x.p)((function(e){return e.events}),r.threads).filter((function(e){return!t.hasEvent("liveChatChatId",e.id)}));a.length>0&&t.addHistoryEvents("liveChatChatId",a),t.updateChat("liveChatChatId",{properties:{lastThread:r.threads.length?Object(x.G)(r.threads).id:null}})}t.setApplicationState({eagerFetchingMode:!0}),fe(n)}))),Pr()(ea(t,(function(e){return e.application.page})),Jr()(1),Object(Zr.a)(ue),_r()((function(e){var t=e.url,n=e.title;a.updateCustomerPage({url:t,title:n})})))},fv=function(e){return e.some(x.y)},mv=function(e,t){var n=Pr()(function(){var e=Object(Br.a)((function(){return!!document.hasFocus&&document.hasFocus()})),t=Rr()((function(){return!0}))(Object(Cr.a)(window,"focus")),n=Rr()((function(){return!1}))(Object(Cr.a)(window,"blur"));return Er()(e,t,n)}(),Hr.a);if(t){var r,a=(r=t,Pr()(Object(hr.a)((function(){return Object(Tr.a)(Promise.race([r.call("isFocused"),new Promise((function(e){return Lr(r,"focus",e)}))]))})),Dr((function(e){return Pr()(Ir(r,"focus"),Mr()(e))}))));Pr()(n,_r()((function(n){e.setApplicationState({applicationFocused:n}),t.emit("focus",n)}))),Pr()(lr()(n,a),Object(mr.a)(50),Rr()(fv),Object(vr.a)(),_r()((function(t){e.setApplicationState({pageFocused:t})})))}else Pr()(n,_r()((function(t){e.setApplicationState({pageFocused:t,applicationFocused:t})})))},hv=function(e){Pr()(ea(e,(function(){return e.localize("welcome_title")})),_r()((function(e){document.title=e})))},vv=/\.(\w+)$/i,gv=new Audio,bv={mp3:"audio/mpeg",ogg:"audio/ogg"},yv=function(e){var t=function(e){var t=e.match(vv);return t?t[1].toLowerCase():""}(e);if(t in bv){if(""!==gv.canPlayType(bv[t]))return!0}else 0;return!1},jv=function(e){return new Promise((function(t,n){var r=new Audio(e);r.onloadeddata=function(){t(r)},r.onerror=n}))},Ov=function(e){var t=e.play();return Object(x.E)(t)?t:Promise.resolve()},xv=function(e){return"function"===typeof e.start&&"function"===typeof e.stop},_v=function(e){xv(e)?e.start(0):e.noteOn(0)},Cv=function(){var e=new(window.AudioContext||window.webkitAudioContext),t=!0,n=[],r=function(t){return new Promise((function(n,r){e.decodeAudioData(t,n,r)}))},a=function(t){return{play:function(){var n=e.createBufferSource();return n.connect(e.destination),n.buffer=t,{playback:new Promise((function(t,r){if(n.onended=function(){return t()},_v(n),"running"!==e.state){var a=new Error("Playback failed, AudioContext is in incorrect state '"+e.state+"'");a.name="PlaybackError",r(a)}})),stop:function(){!function(e){xv(e)?e.stop(0):e.noteOff(0)}(n)}}}}};return{preload:function(e){return function(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.onload=function(){t(r.response)},r.onerror=n,r.open("GET",e),r.responseType="arraybuffer",r.send()}))}(e).then(r).then(a)},playSound:function(e){var r=e.play();return t&&n.push(r),r.playback},resumeOnInteraction:function(){var r=function r(){document.removeEventListener("click",r,!0),document.removeEventListener("touchend",r,!0),t&&(n.forEach((function(e){e.stop()})),n=[],t=!1),e.resume(),function(){var t=e.createBuffer(1,1,22050),n=e.createBufferSource();n.buffer=t,n.connect(e.destination),_v(n)}()};document.addEventListener("click",r,!0),document.addEventListener("touchend",r,!0)}}},wv=function(){return"function"===typeof window.webkitAudioContext?function(){var e=Cv(),t=Object(x.L)((function(t){var n=e.preload(t);return n.catch(x.P),n}));return{play:function(n){var r=t(n).then(e.playSound);return r.catch(x.P),r},preload:t,unlock:function(){return e.resumeOnInteraction()}}}():function(){var e=Object(x.L)(jv);return{play:function(t){return e(t).then(Ov)},preload:e,unlock:x.P}}()},Ev=function(e){var t=wv(),n=function(e){return Object.keys(e).reduce((function(t,n){var r=Object(x.k)((function(e){return yv(e)}),Object(x.i)(e[n]));return t[n]=r,t}),{})}(e);return{play:function(e){var r=n[e];t.play(r).then(x.P,x.P)},preload:function(e){var r=n[e];t.preload(r).then(x.P,x.P)},resumeOnInteraction:function(){return t.unlock()}}},Iv=n(209),Sv=n.n(Iv),kv=n(210),Tv=n.n(kv),Av=function(){var e,t=Ev(((e={}).new_message=[Tv.a,Sv.a],e));return t.resumeOnInteraction(),t.preload("new_message"),Object(x.H)(2e3,(function(e){t.play(e)}))},Pv=function(e,t){return"system"!==e.author&&!e.properties.welcomeMessage&&e.author!==t},Nv=function(e){var t=Av();e.on("add_event",(function(n){var r=n.event;if(!e.getApplicationState().muted){var a=e.getSessionUserId();Pv(r,a)&&t("new_message")}}))},Mv="init",zv="invitation",Rv="chatStarted",Dv=n(81),Lv=n.n(Dv),Bv=n(119),qv=function(e){var t=e.amplitudeKey,n=e.children;return t?Zt.createElement(Bv.AmplitudeProvider,{amplitudeInstance:Lv.a.getInstance(),apiKey:t},n):n},Uv=n(211),Fv=n(17),Vv=n(2),Gv=new(function(){function e(){this.storage=new Map}var t=e.prototype;return t.get=function(e,t){var n=this.storage.get(t);if(n&&n.formId===e)return n.value},t.set=function(e,t,n){var r={formId:e,value:n};return this.storage.set(t,r),this},t.delete=function(e){return this.storage.delete(e)},e}()),Hv=Zt.createContext(Gv),Wv=function(e){var t=e.children;return Zt.createElement(Hv.Provider,{value:Gv},t)},Yv=Hv,Jv=n(8),Kv=n(95),Qv=n(78),Zv=n(79),Xv=n(204),$v=n(93),eg=n(113),tg=n(112);var ng=function(e,t){Zt.useEffect((function(){var n=t.current;if(n){var r=function(e){e.preventDefault()};return n.addEventListener(e,r,{passive:!1}),function(){return n.removeEventListener("touchmove",r)}}}),[e,t])},rg=0,ag=null,ig=function(){ag="keyboard"},og=function(){ag="click"},cg=function(){return Zt.useEffect((function(){return 0===rg&&(document.addEventListener("keydown",ig,!0),document.addEventListener("mousedown",og,!0),document.addEventListener("touchstart",og,!0)),rg++,function(){--rg>0||(ag=null,document.removeEventListener("keydown",ig,!0),document.removeEventListener("mousedown",og,!0),document.removeEventListener("touchstart",og,!0))}}),[]),Zt.useCallback((function(){return ag}),[])},sg=function(e){return Object(Qv.a)((function(){var t=e,n=[];return{subscribe:function(e){return n.push(e),function(){n.splice(n.indexOf(e),1)}},next:function(e){t=e,n.forEach((function(t){return t(e)}))},get:function(){return t}}}))},ug=function(e){return Object(tg.useSubscription)({getCurrentValue:e.get,subscribe:e.subscribe})},lg=function(e){var t=Zt.useRef(!1),n=Object(Zv.a)(e);return Zt.useEffect((function(){t.current&&(t.current=!1,n.current())})),Zt.useCallback((function(){t.current=!0}),[])},dg=n(120);var pg={duration:0},fg=Object(dg.a)(),mg=["End","Home","Space","PageUp","PageDown","ArrowUp","ArrowDown"];var hg=function(e,t){void 0===t&&(t={});var n=t,r=n.firstItemKey,a=n.lastItemKey,i=n.topThreshold,o=void 0===i?20:i,c=n.bottomThreshold,s=void 0===c?20:c,u=n.initialScrollTop,l=n.onIsUserScrollingChanged,d=n.onIsScrolledToTopChanged,p=n.onIsScrolledToBottomChanged,f=n.onScrollDeltaChanged,m=n.isScrollingChangedTimeout,h=void 0===m?300:m,v=Zt.useRef(0),g=Zt.useRef(0),b=Zt.useRef(!1),y=Zt.useRef(!1),j=Zt.useRef(!1),O=Zt.useRef(!1),_=Zt.useRef(null),C=Zt.useRef({timeout:0,value:!1}),w=Zt.useRef("none"),E=Object(eg.a)("y",e),I=Zt.useCallback((function(){O.current=!0,E.apply(void 0,arguments)}),[E]),S=Object($v.a)(r),k=Object($v.a)(a),T=Zt.useCallback((function(){O.current=!1}),[]),A=Zt.useCallback((function(){return y.current}),[]),P=Zt.useCallback((function(){return j.current}),[]),N=Zt.useCallback((function(e){return I(0,e)}),[E]),M=Zt.useCallback((function(t){if(e.current){var n=e.current,r=n.scrollHeight,a=n.clientHeight;I(r-a,t),w.current=t&&0===t.duration?"instant":"animated"}}),[e,I]),z=Zt.useCallback((function(e){return _.current=e}),[]),R=Zt.useCallback((function(){return!!e.current&&e.current.scrollHeight>e.current.clientHeight}),[e]),D=Zt.useCallback((function(){C.current.value||(C.current.value=!0,l&&l(C.current.value)),clearTimeout(C.current.timeout),C.current.timeout=window.setTimeout((function(){C.current.value&&(C.current.value=!1,l&&l(C.current.value))}),h)}),[h]),L=Zt.useCallback((function(){var t=e.current,n=t.scrollTop,r=t.scrollHeight,a=v.current>n,i=v.current<n,c=v.current===n,u=r<g.current,l=r>g.current,m=v.current-n,h=r>1.5*window.innerHeight;if(v.current=n,g.current=r,R()&&!O.current&&D(),!c||!b.current){("instant"===w.current||"animated"===w.current&&j.current)&&requestAnimationFrame((function(){M({duration:0}),w.current="none"}));var x=y.current&&a,_=j.current&&(i||u||l),E=x||Object(Ai.e)(t,o),I=_||Object(Ai.d)(t,s);d&&(!y.current&&E?d(!0):y.current&&!E&&d(!1)),p&&(!j.current&&I?p(!0):j.current&&!I&&p(!1)),y.current=E,j.current=I,!l&&!y.current&&f&&!j.current&&b.current&&C.current&&fg&&!O.current&&h&&f({deltaX:0,deltaY:m/2})}}),[d,p,D]),B=Zt.useCallback((function(e){Object(x.z)(e.key,mg)&&T()}),[T]),q=function(){I(_.current.offsetTop,pg),_.current=null},U=function(){_.current?q():(S!==r&&function(){var t=e.current.scrollHeight,n=g.current-v.current;I(t-n,pg)}(),k!==a&&j.current&&M())};return function(e,t,n){Zt.useEffect((function(){return document.addEventListener(e,t,n),function(){return document.removeEventListener(e,t,n)}}),[e,t,n])}("keydown",B),Zt.useEffect((function(){!1===b.current?(_.current?q():I("number"===typeof u?u:e.current.scrollHeight,pg),L(),b.current=!0):U()})),Zt.useEffect((function(){if(e.current){var t=e.current;return t.addEventListener("scroll",L,fg?{passive:!0}:void 0),function(){return t.removeEventListener("scroll",L)}}}),[e,L]),{scrollTo:I,scrollToTop:N,scrollToBottom:M,getIsOnTop:A,getIsOnBottom:P,getIsScrollable:R,setScrollTargetNode:z,onWheel:T,onTouchStart:T}};var vg=function(e){Zt.useEffect(e,[])},gg=function(e,t){var n=Zt.useRef(!1);Zt.useEffect((function(){n.current?e():n.current=!0}),t)};function bg(e){return e<0?-1:1}function yg(e,t){var n,r,a;return n=0,r=1,a=t+e/100,Math.min(Math.max(a,n),r)}var jg=function(e,t){var n=Object(Zv.a)(t);vg((function(){var t=0,r=0,a=1,i=1,o=0,c=0,s=0,u=function(e,a){t=yg(e,t),r=yg(a,r),n.current({x:t,y:r})},l=function e(n){var o=("x"===n||"xy"===n)&&t>0&&t<1,c=("y"===n||"xy"===n)&&r>0&&r<1;(o||c)&&(u(o?5*a:0,c?5*i:0),s=requestAnimationFrame((function(){return e(n)})))},d=e.subscribe((function(e){var t=e.deltaX,n=e.deltaY;Math.abs(t)>8&&(u(t,0),a=bg(t),clearTimeout(o),o=window.setTimeout((function(){return l("x")}),50)),Math.abs(n)>8&&(u(0,n),i=bg(n),clearTimeout(c),c=window.setTimeout((function(){return l("y")}),50))}));return function(){d(),clearTimeout(o),clearTimeout(c),cancelAnimationFrame(s)}}))};var Og=function(e){return e/16+"rem"},xg=function(e){return Object(Vv.y)("display:inline-block;flex-shrink:0;width:1em;height:1em;font-size:",e?Og(e):"inherit",";user-select:none;fill:currentColor;")},_g=function(e){var t=e.className,n=e.size,r=e.color,a=void 0===r?"inherit":r,i=Object(w.a)(e,["className","size","color"]);return Zt.createElement("svg",Object(C.a)({color:a,className:Object(Vv.z)(xg(n),t)},i))},Cg=function(e,t){return Zt.memo((function(n){return Zt.createElement(_g,Object(C.a)({},t,n),e)}))},wg=Object(Vv.B)("to{stroke-dashoffset:0;}"),Eg=Object(Vv.y)("fill:none;stroke:currentColor;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;animation-fill-mode:forwards;animation-name:",wg,";animation-duration:0.5s;animation-iteration-count:1;animation-timing-function:cubic-bezier(0,0,1,1);stroke-dasharray:9.7;stroke-dashoffset:9.7;"),Ig=Cg(Zt.createElement("polyline",{className:Eg,points:"4.3,8.1 5.3,9.1 6.8,10.5 9,8.2 11.1,6.1 "}),{size:16,viewBox:"0 0 16 16"}),Sg=Ig,kg=Cg(Zt.createElement("path",{d:"M23.7,16.7l-6,6c-0.4,0.4-1,0.4-1.4,0c-0.4-0.4-0.4-0.9-0.1-1.3l0.1-0.1l4.3-4.3H10c-0.5,0-0.9-0.4-1-0.9L9,16 c0-0.5,0.4-0.9,0.9-1l0.1,0h10.6l-4.3-4.3c-0.4-0.4-0.4-0.9-0.1-1.3l0.1-0.1c0.4-0.4,0.9-0.4,1.3-0.1l0.1,0.1l6,6 C24.1,15.7,24.1,16.2,23.7,16.7L23.7,16.7z"}),{size:32,viewBox:"0 0 32 32"}),Tg=Cg(Zt.createElement("path",{d:"M18,10c0.6,0,1,0.4,1,1v9c0,1.6-1.2,3-2.7,3h-0.6c-1.5,0-2.7-1.4-2.7-3V9c0-2.2,2.1-4,4.5-4h1C20.9,5,23,6.8,23,9\tv12c0,3.9-3.1,7-7,7s-7-3.1-7-7v-8c0-0.6,0.4-1,1-1c0.6,0,1,0.4,1,1v8c0,2.8,2.2,5,5,5s5-2.2,5-5V9c0-1.1-1.1-2-2.5-2h-1\tC16.1,7,15,7.9,15,9v11c0,0.6,0.4,1,0.7,1h0.6c0.4,0,0.7-0.4,0.7-1v-9c0-0.3,0.1-0.5,0.3-0.7C17.5,10.1,17.7,10,18,10z"}),{size:32,viewBox:"0 0 32 32"}),Ag=Object(Vv.y)("fill-rule:evenodd;clip-rule:evenodd;"),Pg=Object(Vv.y)("fill-rule:evenodd;clip-rule:evenodd;fill:#fff;"),Ng=Cg(Zt.createElement(Zt.Fragment,null,Zt.createElement("circle",{className:Ag,cx:"12",cy:"12",r:"10"}),Zt.createElement("path",{className:Pg,d:"M12,18c-0.6,0-1-0.4-1-1c0-0.6,0.4-1,1-1s1,0.4,1,1C13,17.6,12.6,18,12,18z M10.5,7.1 C10.5,6.5,11.2,6,12,6s1.5,0.5,1.5,1.1c0.1,5.2-0.4,7.9-1.5,7.9S10.4,12.4,10.5,7.1z"})),{size:32,viewBox:"0 0 24 24"}),Mg=Cg(Zt.createElement("path",{d:"M21.3331175,12.2868932 C21.7144399,11.9043689 22.3326857,11.9043689 22.7140082,12.2868932 C23.0953306,12.6694174 23.0953306,13.2896117 22.7140082,13.6721359 L17.1904454,19.2131068 C16.8091229,19.5956311 16.1908771,19.5956311 15.8095546,19.2131068 L10.2859918,13.6721359 C9.90466939,13.2896117 9.90466939,12.6694174 10.2859918,12.2868932 C10.6673143,11.9043689 11.2855601,11.9043689 11.6668825,12.2868932 L16.5,17.1352427 L21.3331175,12.2868932 Z"}),{size:32,viewBox:"0 0 32 32",fill:"none",stroke:"none",strokeWidth:1,fillRule:"evenodd"}),zg=Cg(Zt.createElement("path",{d:"M17.4,16l5.3,5.3c0.4,0.4,0.4,1,0,1.4c-0.4,0.4-1,0.4-1.4,0L16,17.4l-5.3,5.3c-0.4,0.4-1,0.4-1.4,0\tc-0.4-0.4-0.4-1,0-1.4l5.3-5.3l-5.3-5.3c-0.4-0.4-0.4-1,0-1.4c0.4-0.4,1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0\tc0.4,0.4,0.4,1,0,1.4L17.4,16z"}),{size:32,viewBox:"0 0 32 32"}),Rg=Cg(Zt.createElement("path",{d:"M8,18c-1.1,0-2-0.9-2-2s0.9-2,2-2s2,0.9,2,2S9.1,18,8,18z M16,18c-1.1,0-2-0.9-2-2s0.9-2,2-2\ns2,0.9,2,2S17.1,18,16,18z M24,18c-1.1,0-2-0.9-2-2s0.9-2,2-2s2,0.9,2,2S25.1,18,24,18z"}),{size:32,viewBox:"0 0 32 32"}),Dg=Cg(Zt.createElement("path",{d:"M8,25h16c0.6,0,1,0.4,1,1c0,0.5-0.4,0.9-0.9,1L24,27H8c-0.6,0-1-0.4-1-1c0-0.5,0.4-0.9,0.9-1L8,25z M20.6,5.2  L20.6,5.2l4.1,4.1c0.4,0.4,0.4,0.9,0.1,1.3l-0.1,0.1l-12,12c-0.2,0.2-0.4,0.3-0.6,0.3L12,23H8c-0.5,0-0.9-0.4-1-0.9L7,22v-4  c0-0.2,0.1-0.4,0.2-0.6l0.1-0.1l12-12C19.7,4.9,20.2,4.9,20.6,5.2z M17,10.4l-8,8V21h2.6l8-8L17,10.4z M20,7.4L18.4,9l2.6,2.6  l1.6-1.6L20,7.4z"}),{size:32,viewBox:"0 0 32 32"}),Lg=Cg(Zt.createElement("path",{d:"M17.6,17H7c-0.6,0-1-0.4-1-1s0.4-1,1-1h10.6l-2.3-2.3c-0.4-0.4-0.4-1,0-1.4c0.4-0.4,1-0.4,1.4,0l4,4 c0.4,0.4,0.4,1,0,1.4l-4,4c-0.4,0.4-1,0.4-1.4,0c-0.4-0.4-0.4-1,0-1.4L17.6,17L17.6,17z M8,12c0,0.6-0.4,1-1,1s-1-0.4-1-1V8.1 C6,7,7,6,8.1,6h15.8C25,6,26,7,26,8.1v15.8c0,1.2-1,2.1-2.1,2.1H8.1C7,26,6,25,6,23.9V20c0-0.6,0.4-1,1-1s1,0.4,1,1v3.9 C8,23.9,8.1,24,8.1,24h15.8c0.1,0,0.1-0.1,0.1-0.1V8.1C24,8.1,23.9,8,23.9,8H8.1C8.1,8,8,8.1,8,8.1V12z"}),{size:32,viewBox:"0 0 32 32"}),Bg=Object(Vv.C)((function(e){return Zt.createElement(Vv.h,Object(C.a)({type:"button"},e))}),{target:"e1mwfyk10"})("padding:0;border-radius:",(function(e){return e.theme.borderRadius}),";"),qg=Object(Vv.C)("div",{target:"e1ykiqc40"})("display:inline-block;",(function(e){var t=e.size;return{width:t,height:t}})," &:hover{background-color:#ebebeb;border-radius:4px;}"),Ug=Cg(Zt.createElement("path",{d:"M6.1,22.1l5.3-4.8c0.4-0.3,1-0.3,1.3,0l3.2,2.8l6.5-5.8c0.4-0.3,1-0.3,1.3,0l2.3,2.1V9c0-0.6-0.4-1-1-1h-18 c-0.6,0-1,0.4-1,1L6.1,22.1C6.1,22,6.1,22,6.1,22.1z M8,23h8.1l-4.1-3.7L8,23z M19.1,23h5.9c0.6,0,1-0.4,1-1v-3l-3-2.7l-5.7,5.1 L19.1,23z M7.1,6h18c1.7,0,3,1.3,3,3v13c0,1.7-1.3,3-3,3h-18c-1.7,0-3-1.3-3-3V9C4.1,7.3,5.4,6,7.1,6z M15.1,16c-1.7,0-3-1.3-3-3 s1.3-3,3-3s3,1.3,3,3S16.8,16,15.1,16z M15.1,14c0.6,0,1-0.4,1-1s-0.4-1-1-1c-0.6,0-1,0.4-1,1S14.5,14,15.1,14z"}),{size:32,viewBox:"0 0 32 32"}),Fg=Cg(Zt.createElement("path",{d:"M5.5,6l6.5,5.7L18.5,6H5.5z M20,7.3l-7.3,6.4c-0.4,0.3-0.9,0.3-1.3,0L4,7.3V17c0,0.6,0.4,1,1,1h14 c0.6,0,1-0.4,1-1V7.3z M5,4h14c1.7,0,3,1.3,3,3v10c0,1.7-1.3,3-3,3H5c-1.7,0-3-1.3-3-3V7C2,5.3,3.3,4,5,4z"}),{size:24,viewBox:"0 0 24 24"}),Vg=Cg(Zt.createElement("path",{d:"M11,22c-0.6,0-1-0.4-1-1s0.4-1,1-1h15c0.6,0,1,0.4,1,1s-0.4,1-1,1H11z"}),{size:32,viewBox:"0 0 32 32"}),Gg=Cg(Zt.createElement("path",{d:"M18,10.6l1.3-1.3c0.4-0.4,1-0.4,1.4,0c0.4,0.4,0.4,1,0,1.4L19.4,12l1.3,1.3c0.4,0.4,0.4,1,0,1.4 c-0.4,0.4-1,0.4-1.4,0L18,13.4l-1.3,1.3c-0.4,0.4-1,0.4-1.4,0c-0.4-0.4-0.4-1,0-1.4l1.3-1.3l-1.3-1.3c-0.4-0.4-0.4-1,0-1.4 c0.4-0.4,1-0.4,1.4,0L18,10.6L18,10.6z M7,8l4.3-3.7C11.9,3.7,13,4.1,13,5v14c0,0.9-1.1,1.3-1.7,0.7L7.2,16H4c-0.6,0-1-0.4-1-1V9 c0-0.6,0.4-1,1-1H7z M11,7.4L8.3,9.7C8.1,9.9,7.9,10,7.6,10H5v4h2.6c0.3,0,0.5,0.1,0.7,0.3l2.7,2.3V7.4z"}),{size:24,viewBox:"0 0 24 24"}),Hg=Cg(Zt.createElement("path",{d:"M18.8,16.3C17.9,16.8,17,17,16,17c-1,0-1.9-0.2-2.8-0.7c-3.2,0.8-5.2,2.8-5.2,5c0,0.8,0,0.9,0,2c0,0,0,0,0.1,0\tc0.4,0.1,1,0.3,1.9,0.4c1.6,0.2,3.8,0.3,6.1,0.3s4.5-0.1,6.1-0.3c0.8-0.1,1.4-0.2,1.9-0.4c0,0,0.1,0,0.1,0v-2\tC24,19.2,21.9,17.1,18.8,16.3z M20.6,14.8c3.2,1.2,5.4,3.7,5.4,6.5v2.4c0,1.8-3.7,2.2-10,2.2S6,25.5,6,23.8c0-1.5,0-1.5,0-2.4\tc0-2.9,2.2-5.3,5.4-6.5c-0.9-1-1.4-2.4-1.4-3.8c0-3.3,2.7-6,6-6s6,2.7,6,6C22,12.5,21.5,13.8,20.6,14.8z M16,15c2.2,0,4-1.8,4-4\ts-1.8-4-4-4s-4,1.8-4,4S13.8,15,16,15z"}),{size:32,viewBox:"0 0 32 32"}),Wg=Cg(Zt.createElement("path",{d:"M6.4,5.6l21,9.5c0.5,0.2,0.7,0.8,0.5,1.3c-0.1,0.2-0.3,0.4-0.5,0.5l-21,9.5\tc-0.5,0.2-1.1,0-1.3-0.5c-0.1-0.3-0.1-0.6,0-0.8L8.6,18L20.5,16L8.6,14.1L5.1,6.9c-0.2-0.5,0-1.1,0.5-1.3C5.8,5.5,6.1,5.5,6.4,5.6z"}),{size:32,viewBox:"0 0 32 32"}),Yg=Cg(Zt.createElement("path",{d:"M16.5,21.1l-6.3,3.8C9,25.5,7.6,24.3,8.1,23l2.2-5.7l-3.8-3.7c-1-0.9-0.4-2.6,1-2.6h5.3l2.3-5.1 c0.5-1.2,2.2-1.2,2.8,0l2.3,5.1h5.4c1.4,0,2,1.7,1,2.6l-3.9,3.7l2.2,5.7c0.5,1.3-0.9,2.5-2.2,1.8L16.5,21.1z M10.5,22.3l5.3-3.1l0,0 c0.4-0.2,1-0.2,1.5,0l5.3,3.1l-1.8-4.7c-0.2-0.6,0-1.2,0.4-1.6l3.2-3h-4.4c-0.6,0-1.1-0.4-1.4-0.9l-2-4.4l-2,4.4 c-0.2,0.6-0.8,0.9-1.4,0.9H8.8l3.1,3c0.4,0.4,0.6,1,0.4,1.6L10.5,22.3z"}),{size:32,viewBox:"0 0 32 32"}),Jg=Cg(Zt.createElement("path",{d:"M20,19H18.56c-.35.5-.91,1.35-1.64,2.53a3.75,3.75,0,0,0-.24.44,6.74,6.74,0,0,0-.52,2.42C16,26.18,15.49,27,14,27c-1.66,0-2.74-1.2-3-3V19H8c-3,0-3.64-2.26-2.4-6.65S7.58,7,11,7h6a1.11,1.11,0,0,1,.75.3L19.48,9H20V9a1,1,0,0,1,1-1h4a1,1,0,0,1,1,1V19a1,1,0,0,1-1,1H21a1,1,0,0,1-1-1Zm0-2V11h-.94a1,1,0,0,1-.71-.3L16.65,9H11c-2.38,0-2.45.15-3.51,3.9C6.58,16.21,6.75,17,8,17h4a1,1,0,0,1,1,1v5.92c.12.81.46,1.07,1,1.08a4.54,4.54,0,0,0,.12-.81,8.39,8.39,0,0,1,.69-3.06q.17-.33.36-.66a34.1,34.1,0,0,1,2.07-3.11,1,1,0,0,1,.76-.36Zm4,1V10H22v8Z"}),{size:32,viewBox:"0 0 32 32"}),Kg=Cg(Zt.createElement("path",{d:"M11,14h1.47c.35-.5.9-1.35,1.64-2.53a3.68,3.68,0,0,0,.23-.44,6.34,6.34,0,0,0,.52-2.42C15.05,6.82,15.51,6,17,6c1.66,0,2.65,1.06,2.92,2.86V14h3c3,0,3.76,2.26,2.51,6.65S23.35,26,19.93,26H14a1,1,0,0,1-.71-.3L11.55,24H11v0a1,1,0,0,1-1,1H6a1,1,0,0,1-1-1V14a1,1,0,0,1,1-1h4a1,1,0,0,1,1,1Zm0,2v6h1a1,1,0,0,1,.7.3L14.37,24H20c2.37,0,2.44-.15,3.51-3.9.94-3.31.68-4.1-.6-4.1h-4A1,1,0,0,1,18,15V9.08C17.87,8.27,17.54,8,17,8a5.27,5.27,0,0,0-.13.81,8.19,8.19,0,0,1-.69,3.06,5.37,5.37,0,0,1-.36.66,34.81,34.81,0,0,1-2.06,3.11A1,1,0,0,1,13,16ZM7,15v8H9V15Z"}),{size:32,viewBox:"0 0 32 32"}),Qg=Cg(Zt.createElement("path",{d:"M8.7,15.2c-0.4-0.4-1-0.4-1.4,0c-0.4,0.4-0.4,1,0,1.4l5.7,5.7c0.4,0.4,1,0.4,1.4,0l9.9-9.9 c0.4-0.4,0.4-1,0-1.4c-0.4-0.4-1-0.4-1.4,0l-9.2,9.2L8.7,15.2z"}),{size:32,viewBox:"0 0 32 32"}),Zg=Cg(Zt.createElement("path",{d:"M15,19v-2c2.8,0,5-2.2,5-5s-2.2-5-5-5V5c3.9,0,7,3.1,7,7S18.9,19,15,19z M15,16v-2c1.1,0,2-0.9,2-2s-0.9-2-2-2 V8c2.2,0,4,1.8,4,4S17.2,16,15,16z M7,8l4.3-3.7C11.9,3.7,13,4.1,13,5v14c0,0.9-1.1,1.3-1.7,0.7L7.2,16H4c-0.6,0-1-0.4-1-1V9 c0-0.6,0.4-1,1-1H7z M11,7.4L8.3,9.7C8.1,9.9,7.9,10,7.6,10H5v4h2.6c0.3,0,0.5,0.1,0.7,0.3l2.7,2.3V7.4z"}),{size:24,viewBox:"0 0 24 24"}),Xg=Object(Vv.C)(Vv.h,{target:"eed86ay0"})("padding:0;flex-shrink:0;display:flex;align-items:center;justify-content:center;",(function(e){var t=e.size;return{width:t,height:t}})),$g=function(e){var t=e.buttonSize,n=void 0===t?32:t,r=e.iconSize,a=void 0===r?24:r,i=Object(w.a)(e,["buttonSize","iconSize"]);return Zt.createElement(Xg,Object(C.a)({size:n},i),Zt.createElement(qg,{size:a},Zt.createElement(zg,{size:a})))},eb=Object(Vv.C)("div",{target:"e1viqdiv0"})("margin:8px 16px;background:#fff;box-shadow:0 0 16px 0px rgba(0,0,0,0.25);",(function(e){var t=e.stickToEdge,n=void 0!==t&&t;return{marginBottom:n?"0":"8px",borderRadius:n?"6px 6px 0 0":"6px","@media (orientation: landscape)":{maxWidth:"50%",margin:n?"0 auto":"0 auto 8px"}}})),tb=Object(Vv.C)("div",{target:"eyqxlol0"})("display:flex;align-items:center;justify-content:center;width:auto;min-width:1.5em;border-radius:10px;padding:0 4px;flex-shrink:0;background-color:#e92660;color:#fff;height:1.5em;line-height:1.5em;text-align:center;font-size:0.8em;box-shadow:0 0.2em 0.2em rgba(0,0,0,0.2);font-weight:bold;animation-name:",(function(e){return function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1.3),Object(Vv.B)("0%{transform:scale(",e,");}25%{transform:scale(",e,");}50%{transform:scale(",t,");}100%{transform:scale(1.0);}")}(e.minScale,e.maxScale)}),";animation-duration:0.625s;animation-timing-function:cubic-bezier(0.175,0.885,0.32,1.275);"),nb=Object(Vv.C)("span",{target:"e1tnd1n30"})("flex-grow:1;flex-shrink:1;"),rb=Object(Vv.C)("div",{target:"e1tnd1n31"})("display:flex;cursor:pointer;justify-content:flex-start;align-items:center;",(function(e){return e.theme.typography.basic})),ab=Object(Vv.C)(tb,{target:"e1tnd1n32"})("margin:0 6px;flex-shrink:0;box-shadow:none;"),ib=function(e){var t=e.unseenCount,n=e.text,r=e.stickToEdge,a=e.onClose,i=e.onClick,o=Object(w.a)(e,["unseenCount","text","stickToEdge","onClose","onClick"]);return Zt.createElement(eb,Object(C.a)({stickToEdge:r},o),Zt.createElement(rb,{onClick:i},Zt.createElement(ab,null,t<100?t:"99+"),Zt.createElement(nb,{ellipsis:!0},n),Zt.createElement($g,{onClick:function(e){e.stopPropagation(),a()}})))},ob=Object(Vv.C)("p",{target:"ejp8d810"})("margin:1em 0;"),cb=n(317),sb=Object(Vv.C)(Bg,{target:"e1bjcwou0"})("width:",Og(24),";height:",Og(24),";border-radius:50%;background:rgba(255,255,255,0.5);margin-bottom:",(function(e){return.5*e.theme.spaceBase}),"px;visibility:",(function(e){var t=e.mobile;return function(e){return e&&/native code/.test(e.toString())}(window.matchMedia)&&window.matchMedia("(hover: none)").matches||t?"visible":"hidden"}),";"),ub=Object(Vv.y)("font-size:",Og(24),";"),lb=function(e){var t=e.mobile,n=void 0!==t&&t,r=e.onClick;return Zt.createElement(sb,{onClick:r,mobile:n},Zt.createElement(zg,{className:ub}))},db=Object(Vv.C)(Vv.g,{displayName:"Invitation",section:!0,target:"e18yipk00"})("margin-bottom:8px;&:hover{",sb,"{visibility:visible;}}",Vv.c,"{color:#424d57;box-shadow:0 4px 12px rgba(0,0,0,0.3);}"),pb=Object(Vv.y)("max-width:255px;cursor:pointer;"),fb=function(e){var t=e.onClick,n=e.children;return Zt.createElement(Vv.c,{className:pb,onClick:t},Zt.createElement(Vv.m,null,n))},mb=n(316),hb=function(e){return Object(Vv.y)("transition-delay:",e,"ms;")},vb=Object(Vv.y)("&-enter,&-appear{opacity:0;transform:translateY(8px);}&-enter-active,&-appear-active{opacity:1;transform:translateY(0);transition:opacity 100ms ease-in,transform 200ms ease-in;}&-exit{opacity:1;transform:translateY(0);}&-exit-active{opacity:0;transform:translateY(8px);transition:opacity 100ms ease-in,transform 200ms ease-in;}"),gb=function(e){var t=e.delay,n=void 0===t?0:t,r=Object(w.a)(e,["delay"]);return Zt.createElement(mb.a,Object(C.a)({},r,{timeout:200+n,classNames:vb,className:hb(n)}))},bb=function(e){return void 0===e&&(e=0),Object(Vv.y)("transition-delay:",e,"ms;&-enter,&-appear{opacity:0;}&-enter-active,&-appear-active{opacity:1;transition:opacity 200ms ease-out;}&-exit{opacity:1;}&-exit-active{opacity:0;transition:opacity 200ms ease-out;}")},yb=function(e){var t=e.delay,n=void 0===t?0:t,r=Object(w.a)(e,["delay"]);return Zt.createElement(mb.a,Object(C.a)({},r,{timeout:200+n,classNames:bb(n)}))},jb=function(e){var t=e.slideDuration,n=e.opacityDuration,r=e.opacityDelay;return Object(Vv.y)("&-exit{opacity:1;}&-exit-active,&-exit-done{opacity:0;transform:translateX(100%);transition:transform ",t,"ms ","cubic-bezier(0.14, 0, 0, 1)",",opacity ",n,"ms linear ",r,"ms;}")},Ob=function(e){var t=e.transitionDuration,n=e.onTransitionStart,r=e.onTransitionEnd,a=Object(w.a)(e,["transitionDuration","onTransitionStart","onTransitionEnd"]),i=t,o=Math.floor(2/3*t),c=t-o;return Zt.createElement(mb.a,Object(C.a)({},a,{timeout:t,onExited:r,onEntered:r,onExiting:n,onEntering:n,classNames:jb({slideDuration:i,opacityDuration:o,opacityDelay:c})}))},xb=function(e){return Object(Vv.y)("&-enter{height:0;}&-enter-active{height:",e,"px;transition:height ",600,"ms ","cubic-bezier(0.14, 0, 0, 1)",";}&-exit{height:",e,"px;}&-exit-active,&-exit-done{height:0;transition:height ",600,"ms ","cubic-bezier(0.14, 0, 0, 1)",";}")},_b=function(e){var t=e.onTransitionStart,n=e.onTransitionEnd,r=e.contentHeight,a=Object(w.a)(e,["onTransitionStart","onTransitionEnd","contentHeight"]);return Zt.createElement(mb.a,Object(C.a)({},a,{timeout:600,onExited:n,onEntered:n,onExiting:t,onEntering:t,classNames:xb(r)}))},Cb=Object(Vv.C)(Vv.q,{target:"e46npph0"})("margin-bottom:",(function(e){return e.noMargin?0:8}),"px;"),wb=function(e){var t=e.reverse,n=e.noMargin,r=e.children,a=Object(w.a)(e,["reverse","noMargin","children"]);return Zt.createElement(gb,a,Zt.createElement(Cb,{reverse:t,noMargin:n},r))},Eb=Object(Vv.y)("max-width:255px;margin-bottom:10px;cursor:pointer;"),Ib=Object(Vv.C)("div",{displayName:"Invitation",section:!0,target:"e2lb6850"})("display:flex;flex-direction:column;align-items:",(function(e){return e.alignToRight?"flex-end":"flex-start"}),";&:hover{*{visibility:visible;}}",Vv.c,"{box-shadow:0 0.1em 1.2em rgba(0,0,0,0.3);}"),Sb=function(e){var t=e.screenPosition,n=e.mobile,r=e.onClose,a=e.onClick,i=e.text,o=e.onShow;return vg(o),Zt.createElement(Ib,{alignToRight:"right"===t},Zt.createElement(Vv.q,{reverse:"right"===t},Zt.createElement(lb,{mobile:n,onClick:r})),Zt.createElement(Vv.c,{className:Eb,onClick:a},Zt.createElement(Vv.m,null,i)))},kb=["0px, 0px","0px, -8px","0px, -10px","0px, -6px","0px, -2px","0px, 3px","0px, 2px","0px, -1px"],Tb=function(e){return Object(Vv.B)(e.map((function(e,t){return e+" { transform: translate("+kb[t]+"); }"})))},Ab=Tb(["0%, 66.67%, 100%","6.67%","13.33%, 20%","26.67%","33.33%","40%","46.67%","53.33%"]),Pb=Tb(["0%, 6.67%, 73.33%, 100%","13.33%","20%, 26.67%","33.33%","40%","46.67%","53.33%","60%"]),Nb=Tb(["0%, 13.33%, 80%, 100%","20%","26.67%, 33.33%","40%","46.67%","53.33%","60%","66.67%"]),Mb=Object(Vv.C)("circle",{target:"epoxe490"})("transform-box:fill-box;transform-origin:50% 50%;animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(0,0,1,1);animation-name:",(function(e){return e.animationName}),";"),zb=function(e){var t=e.height,n=e.width,r=e.color,a=void 0===r?"#424d57":r;return Zt.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 60 40",height:t,width:n,fill:a},Zt.createElement(Mb,{cx:"9",cy:"20",r:"6",animationName:Ab}),Zt.createElement(Mb,{cx:"30",cy:"20",r:"6",animationName:Pb}),Zt.createElement(Mb,{cx:"51",cy:"20",r:"6",animationName:Nb}))},Rb=n(19),Db=Object(Vv.y)("overflow:hidden;margin-bottom:0;"),Lb=Object(Rb.b)((function(e){var t=e.avatar,n=e.theme;return Zt.createElement(Vv.j,{avatar:t,className:Db},Zt.createElement(Vv.i,null,Zt.createElement(Vv.c,null,Zt.createElement(Vv.m,null,Zt.createElement(zb,{height:"16px",width:"24px",color:n.colors.agentMessageText})))))})),Bb=function(e){var t=e.text,n=e.mobile,r=e.onClose,a=e.onShow,i=e.onMaximize,o=e.onResize,c=e.screenPosition,s=e.defaultShowIndicator,u="right"===c,l=Zt.useState(s),d=l[0],p=l[1];return vg((function(){if(a(),s){var e=setTimeout((function(){return p(!1)}),2e3);return function(){return clearTimeout(e)}}})),Zt.createElement(db,null,Zt.createElement(cb.a,{appear:!0,component:null},d&&Zt.createElement(wb,{noMargin:!0,reverse:u,onExited:o},Zt.createElement(Vv.g,null,Zt.createElement(wb,{noMargin:!0,reverse:u},Zt.createElement(lb,{mobile:n,onClick:r})),Zt.createElement(fb,{onClick:i},Zt.createElement(zb,{width:"32px",height:"21px"})))),!d&&Zt.createElement(wb,{reverse:u,delay:400,onEnter:o},Zt.createElement(Vv.g,null,Zt.createElement(wb,{noMargin:!0,reverse:u},Zt.createElement(lb,{mobile:n,onClick:r})),Zt.createElement(fb,{onClick:i},t)))))},qb=Qt((function(e){return{testGroup:Nn(e),isNonProduction:zn(e)}}))((function(e){var t=e.children,n=e.testGroup,r=e.isNonProduction,a=e.includeProduction,i="A"===n;return t(void 0!==a&&a?i:r&&i)})),Ub=Qt((function(e){var t=function(){var t;(t=e).setApplicationState({invitation:Object(C.a)({},t.getApplicationState().invitation,{displayed:!0})})},n=function(){Za(e)};return function(e){var r=jn(e,"liveChatChatId"),a=e.getApplicationState(),i=a.mobile,o=a.availability,c=a.invitation;return{handleInvitationDisplayed:t,hideInvitation:n,screenPosition:bn(e),invitation:r&&r.properties.invitation?r:null,invitationHidden:c.hidden||"offline"===o,invitationDisplayed:!!c.displayed,mobile:i}}}))((function(e){var t=e.handleInvitationDisplayed,n=e.hideInvitation,r=e.invitation,a=e.invitationDisplayed,i=e.invitationHidden,o=e.mobile,c=e.onMaximize,s=e.onResize,u=e.screenPosition,l=Boolean(r&&!i);if(gg(s,[l]),!l)return null;var d=function(e,t){var n=t.split(" "),r=0,a=!1,i=n.map((function(t){return!a&&t.length+r<e?(r+=t.length+1,t):(a=!0,null)})).filter((function(e){return"string"===typeof e})).join(" ");return a?i+"...":i}(o?70:200,r.properties.text);return Zt.createElement(qb,{includeProduction:!0},(function(e){return e?Zt.createElement(Bb,{mobile:o,onShow:t,onResize:s,onClick:c,onMaximize:c,onClose:n,text:d,screenPosition:u,defaultShowIndicator:r.properties.receivedFirstTime&&!a}):Zt.createElement(Sb,{mobile:o,onClick:c,onClose:n,text:d,screenPosition:u,onShow:t})}))})),Fb=Object(Vv.C)("div",{displayName:"Minimized",section:!0,target:"eqd5v0k0"})("padding:",(function(e){return"circle"===e.minimizedType?"0.5em 0.5em 1em 1em":"0.8em 0.8em 0 0.8em"}),";position:absolute;bottom:0;z-index:2;will-change:tranform,opacity;backface-visibility:hidden;",(function(e){return e.position}),":0;"),Vb=Object(Vv.C)("div",{displayName:"MinimizedBubble",section:!0,target:"eqd5v0k1"})("background:#427fe1;display:flex;width:60px;height:60px;box-shadow:0 4px 8px rgba(0,0,0,0.3);border-radius:50%;justify-content:center;&:hover{cursor:pointer;}"),Gb=Object(Vv.C)("div",{displayName:"MinimizedBar",section:!0,target:"eqd5v0k2"})("width:255px;height:50px;box-shadow:0 0 12px rgba(0,0,0,0.3);background:#fff;border-radius:8px 8px 0 0;display:flex;padding:0 0.9em;align-items:center;&:hover{cursor:pointer;}"),Hb=Object(Vv.C)("div",{target:"eqd5v0k3"})("background-color:#fff;width:5px;height:5px;border-radius:50%;"),Wb=Object(Vv.C)(ob,{target:"eqd5v0k4"})("flex-grow:1;font-weight:700;font-size:0.9em;"),Yb=Object(Vv.y)("padding:0;"),Jb=Object(Vv.y)("position:absolute;right:0;top:0;"),Kb=Object(Vv.y)("align-items:flex-end;"),Qb=Qt((function(e){var t=e.getApplicationState(),n=t.availability,r=t.eagerFetchingMode,a="online"===n,i=e.getChat("liveChatChatId").active;return{avatar:!!(ln("agentAvatar",e).enabled&&(a||i))&&Object(x.v)(!1,"avatar",un("liveChatChatId",e)),minimizedType:gn(e),minimizedText:kn("liveChatChatId",e),hasUnseenEvents:r?e.getUnseenCount("liveChatChatId")>0:t.hasUnseenEvents,screenPosition:bn(e)}}))((function(e){var t=e.dir,n=e.avatar,r=e.minimizedType,a=e.minimizedText,i=e.innerRef,o=void 0===i?x.P:i,c=e.onMaximize,s=e.hasUnseenEvents,u=e.screenPosition,l=e.onResize,d=void 0===l?x.P:l;return Zt.createElement(Fb,{dir:t,innerRef:o,minimizedType:r,position:u},Zt.createElement(Vv.g,null,Zt.createElement(Vv.q,{reverse:"right"===u},Zt.createElement(Ub,{onMaximize:c,onResize:d})),Zt.createElement(Vv.q,{reverse:"right"===u,className:Kb,dir:"circle"===r?"ltr":t},"circle"===r&&Zt.createElement(Zt.Fragment,null,Zt.createElement(Vb,{hasAvatar:Boolean(n),onClick:c},s?Zt.createElement(tb,{className:Jb},Zt.createElement(Hb,null)):null,Zt.createElement(Vv.h,{className:Yb},n?Zt.createElement(Vv.b,{imgUrl:n,size:"60px"}):Zt.createElement(Vv.f,null)))),"bar"===r&&Zt.createElement(Gb,{onClick:c},s?Zt.createElement(tb,{className:Jb},Zt.createElement(Hb,null)):null,Zt.createElement(Wb,{ellipsis:!0},a),Zt.createElement(Vv.f,{noShrink:!0})))))})),Zb=function(e,t){var n=new Date(e);return n.toLocaleDateString()===(new Date).toLocaleDateString()?t.today(n):function(e){var t=new Date;return t.setDate(t.getDate()-1),e.toLocaleDateString()===t.toLocaleDateString()}(n)?t.yesterday(n):n.toLocaleDateString([],{year:"numeric",month:"2-digit",day:"2-digit"})},Xb=function(){return"IntersectionObserver"in window&&"IntersectionObserverEntry"in window},$b=function(e,t,n){var r=Object(x.rb)(t).sort((function(e,t){return e.timestamp-t.timestamp})),a=Object(x.l)((function(t){return t.node===e}),r);if(a>-1)return{currentTimestamp:r[a].timestamp,previousTimestamp:a>0?r[a-1].timestamp:n}},ey=function(e,t){var n=Zt.useRef({beginingOfTime:t,currentTimestamp:0,subscribers:[],dividers:{}}),r=function(e){var t=e.rootRef,n=e.rootMargin,r=e.threshold,a=e.intersectionHandler;if(Xb()){var i=Zt.useRef(null),o=Zt.useRef([]),c=Object(Zv.a)(a);return Zt.useEffect((function(){return i.current=new IntersectionObserver((function(e,t){c.current&&c.current(e,t)}),{root:t.current,rootMargin:n,threshold:r}),o.current.forEach((function(e){return i.current.observe(e)})),o.current=[],function(){return i.current.disconnect()}}),[n,r,t,c]),Object(Qv.a)((function(){return{add:function(e){i.current?i.current.observe(e):o.current.push(e)},remove:function(e){i.current?i.current.unobserve(e):o.current=o.current.filter((function(t){return t!==e}))}}}))}}({rootRef:e,intersectionHandler:function(e){var t=function(e,t,n){var r=e.filter((function(e){return e.isIntersecting})).sort((function(e,t){return e.boundingClientRect.top-t.boundingClientRect.top}))[0];if(r){var a=$b(r.target,t,n);return a&&a.previousTimestamp}var i=e.filter((function(e){return e.boundingClientRect.top<=e.rootBounds.top})).sort((function(e,t){return e.boundingClientRect.top-t.boundingClientRect.top})).reverse()[0];if(i){var o=$b(i.target,t,n);return o&&o.currentTimestamp}}(e,n.current.dividers,n.current.beginingOfTime);if(t){var r={timestamp:t,direction:t>n.current.currentTimestamp?"down":"up"};n.current.currentTimestamp=t,n.current.subscribers.forEach((function(e){return e(r)}))}},threshold:.2});return Zt.useEffect((function(){var e=Object(x.rb)(n.current.dividers).map((function(e){return e.timestamp})),t=Math.max.apply(Math,e.concat([n.current.beginingOfTime]));n.current.currentTimestamp=t,n.current.subscribers.forEach((function(e){return e({timestamp:t,direction:"up"})}))}),[]),Object(Qv.a)((function(){return{add:function(e){n.current.dividers[e.timestamp]=e,r&&r.add(e.node)},remove:function(e){r&&r.remove(e.node),delete n.current.dividers[e.timestamp]},subscribe:function(e){n.current.subscribers.push(e)},unsubscribe:function(e){n.current.subscribers=n.current.subscribers.filter((function(t){return t!==e}))},setBeginingOfTime:function(e){n.current.beginingOfTime=e},currentTimestamp:function(){return n.current.currentTimestamp}}}))},ty=Zt.createContext(null),ny=function(){return Zt.useContext(ty)},ry=function(e){var t=e.children,n=e.rootRef,r=e.beginingOfTime,a=ey(n,r);return Zt.useEffect((function(){a.setBeginingOfTime(r)})),Zt.createElement(ty.Provider,{value:a},t)},ay=Object(Vv.C)("span",{displayName:"DividerLabel",target:"eceo2x80"})("padding:4px 8px;font-size:12px;position:relative;padding:0 8px;&:before,&:after{content:'';width:50vw;height:0;border-top:1px solid;border-top-color:inherit;position:absolute;top:50%;}&:before{right:100%;}&:after{left:100%;}"),iy=Object(Vv.C)("div",{target:"e1g4em790"})("position:relative;"),oy=Object(Vv.C)(ay,{target:"e1g4em791"})("color:#424d57;overflow:hidden;border:1px solid #e7e7e7;background-color:#fcfcfc;border-radius:6px;padding:2px 6px;transition:opacity 150ms linear;",(function(e){return!e.visible&&Object(Vv.y)("opacity:0;pointer-events:none;")})),cy=Object(Vv.C)("span",{target:"e1g4em792"})(),sy=function(e){return Object(Vv.y)("&-enter ",cy,",&-exit ",cy,"{position:relative;}&-enter ",cy,"{top:","up"===e?"-2em":"2em",";}&-enter-active ",cy,"{top:0;transition:top ",200,"ms ease-out;}&-exit{opacity:1;}&-exit-active{opacity:0;transition:opacity ",200,"ms ease-out;}&-exit ",cy,"{top:0;position:relative;}&-exit-active ",cy,"{top:","up"===e?"2em":"-2em",";transition:top ",200,"ms ease-out;}")};var uy=Xb()?function(e){var t=e.isUserScrollingSource,n=Object(w.a)(e,["isUserScrollingSource"]),r=ug(t),a=ny(),i=Zt.useState({direction:"up",timestamp:a.currentTimestamp()}),o=i[0],c=i[1];return Zt.useEffect((function(){a.subscribe(c);var e=a.currentTimestamp();return e!==o.timestamp&&c({direction:"up",timestamp:e}),function(){return a.unsubscribe(c)}}),[a]),o.timestamp?Zt.createElement(rn,null,(function(e){var t=Zb(o.timestamp,{today:function(){return e("today")},yesterday:function(){return e("yesterday")}});return Zt.createElement(iy,null,Zt.createElement(cb.a,{component:null,childFactory:function(e){return Zt.cloneElement(e,{classNames:sy(o.direction)})}},Zt.createElement(mb.a,{key:t,classNames:sy(o.direction),timeout:200},Zt.createElement(oy,Object(C.a)({},n,{visible:r}),Zt.createElement(cy,null,t)))))})):null}:function(){return null},ly=function(e){var t=ny();Zt.useEffect((function(){var n={timestamp:e.timestamp,node:e.nodeRef.current};return t.add(n),function(){t.remove(n)}}),[])},dy=Object(Vv.C)("div",{target:"ehmqpie0"})("height:20px;margin:16px -0.5em;text-align:center;overflow:hidden;"),py=function(e){var t=e.timestamp,n=Zt.useRef(null);return ly({timestamp:t,nodeRef:n}),Zt.createElement(rn,null,(function(e){return Zt.createElement(dy,{innerRef:n},Zt.createElement(ay,null,Zb(t,{today:function(e){return e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},yesterday:function(){return e("yesterday")}})))}))},fy=Object(Vv.C)("div",{displayName:"NewMessageHorizontalDivider",target:"eacid5n0"})("height:27px;margin:16px -0.5em;text-align:center;overflow:hidden;"),my=Object(Vv.C)(tb,{target:"eacid5n1"})("display:inline-flex;padding:2px 12px;font-weight:normal;box-shadow:none;height:auto;&:before,&:after{border-top:0;}"),hy=function(e){var t=e.unseenCount,n=e.setScrollTargetNode,r=Zt.useRef(null);return vg((function(){r.current&&n(r.current)})),Zt.createElement(rn,null,(function(e){return Zt.createElement(fy,{innerRef:r},Zt.createElement(my,{minScale:.9,maxScale:1.05},e(1===t?"new_message":"new_messages")))}))},vy=function(){return!0},gy=Qt((function(e,t){var n=t.name,r=t.condition,a=void 0===r?vy:r;return function(e){var t=ln(n,e),r=t.enabled,i=Object(w.a)(t,["enabled"]);return{shouldRender:r&&a(i)}}}))((function(e){var t=e.shouldRender,n=e.children;return t?n:null})),by=function(e){return document.getElementById(e)},yy=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={portal:by(t.props.portalId)},t}Object(Fv.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.state.portal||this.setState({portal:by(this.props.portalId)})},n.render=function(){var e=this.state.portal;return e?Ui.createPortal(this.props.children,e):null},t}(Zt.Component);yy.defaultProps={portalId:"app-portal"};var jy=function(e){return{enter:300,exit:e+300}},Oy=function(e){return Object(Vv.y)("&-enter{background-color:rgba(0,0,0,0);}&-enter-active,&-enter-done{background-color:rgba(0,0,0,0.5);transition:background-color ",300,"ms ","cubic-bezier(0.33, 0, 0.67, 1)",";}&-exit{background-color:rgba(0,0,0,0.5);}&-exit-active,&-exit-done{background-color:rgba(0,0,0,0);transition:background-color ",300,"ms ","cubic-bezier(0.33, 0, 0.67, 1)",";transition-delay:",e,"ms;}")},xy=Object(Vv.y)("z-index:999;position:absolute;top:0;left:0;right:0;bottom:0;border-radius:inherit;"),_y=function(e){var t=Zt.useRef(null);return ng("touchmove",t),Zt.createElement("div",Object(C.a)({ref:t,className:xy},e))},Cy=Zt.memo((function(e){var t=e.shown,n=e.exitDelay,r=void 0===n?100:n,a=e.onClick;return Zt.createElement(cb.a,{component:null},t&&Zt.createElement(mb.a,{classNames:Oy(r),timeout:jy(r)},Zt.createElement(_y,{onClick:a})))})),wy=27,Ey=Object(Vv.y)("margin:0;background:transparent;"),Iy=Object(Vv.C)("div",{target:"e37ga8f0"})("position:absolute;z-index:1500;width:calc(100% - 2rem);max-width:290px;top:1em;left:50%;background:#fff;box-shadow:0 0.2em 0.8em rgba(0,0,0,0.2);padding:",(function(e){return 1*e.theme.spaceBase}),"px;border-radius:6px;"),Sy=Object(Vv.C)("div",{target:"e37ga8f1"})("display:flex;flex-direction:row-reverse;"),ky=Object(Vv.C)("div",{target:"e37ga8f2"})("padding:",(function(e){return 1*e.theme.spaceBase}),"px;padding-top:0;"),Ty={enter:300,exit:300},Ay=Object(Vv.y)("&-enter{transform:translate(-50%,20%);opacity:0;}&-enter-active,&-enter-done{transition:transform ",300,"ms ","cubic-bezier(0.14, 0, 0, 1)",",opacity ",300,"ms ","cubic-bezier(0.14, 0, 0, 1)",";transform:translate(-50%,0%);opacity:1;}&-exit{transform:translate(-50%,0%);opacity:1;}&-exit-active,&-exit-done{transform:translate(-50%,20%);opacity:0;transition:transform ",300,"ms ","cubic-bezier(0.14, 0, 0, 1)",",opacity ",150,"ms ease-out 50ms;}"),Py=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleKeyDown=function(e){e.keyCode===wy&&t.props.onClose()},t}Object(Fv.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){document.addEventListener("keydown",this.handleKeyDown)},n.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown)},n.render=function(){var e=this.props,t=e.onClose,n=e.shown,r=e.children;return Zt.createElement(yy,null,Zt.createElement(Cy,{shown:n,onClick:t,exitDelay:25}),Zt.createElement(cb.a,{component:null},n&&Zt.createElement(mb.a,{classNames:Ay,timeout:Ty},Zt.createElement(Iy,null,Zt.createElement(Sy,null,Zt.createElement(Bg,{className:Ey,onClick:t},Zt.createElement(zg,null))),Zt.createElement(ky,null,r)))))},t}(Zt.Component);Py.defaultProps={onClose:x.P};var Ny=Py,My=n(21),zy=n(121),Ry=Object(Vv.C)("form",{displayName:"Form",section:!0,target:"e1nyj5rz0"})(),Dy=Object(Vv.C)(ob,{target:"exlwksr0"})("margin:0;transition:height 100ms cubic-bezier(0,0,1,1);overflow:hidden;",(function(e){return e.theme.typography.errorCaption})),Ly=function(e){var t=Zt.useRef(null);return Zt.useLayoutEffect((function(){var e=t.current,n=getComputedStyle(e).height;e.style.height="0",function(e){e.scrollTop}(e),e.style.height=n}),[]),Zt.createElement(Dy,Object(C.a)({innerRef:t,role:"alert"},e))},By=Object(Vv.C)("label",{target:"e2zxkge0"})("width:100%;display:inline-block;a{color:inherit;}",(function(e){var t=e.theme,n=e.isRequired,r=void 0!==n&&n;return[t.typography.basic,r&&Object(Vv.y)("&::after{display:inline;content:'\\00a0*';",t.typography.errorCaption,"}")]}));By.defaultProps={textWrap:!0};var qy=By,Uy=Object(Vv.C)("legend",{target:"e1kph7ea0"})("padding:0;display:inline-block;width:100%;a{color:inherit;}",(function(e){var t=e.theme,n=e.isRequired,r=void 0!==n&&n;return[t.typography.basic,r&&Object(Vv.y)("&::after{display:inline;content:'\\00a0*';",t.typography.errorCaption,"}")]}));Uy.defaultProps={textWrap:!0};var Fy=Uy,Vy=Object(Vv.C)("div",{target:"e1oy1v900"})((function(e){return{margin:.25*e.theme.spaceBase+"px 0"}})),Gy=Object(Vv.C)(Bg,{target:"e1oy1v901"})("width:40px;height:40px;"),Hy=Object(Vv.C)("div",{target:"e1oy1v902"})("width:",(function(e){return.75*e.theme.spaceBase}),"px;display:inline-block;"),Wy=function(e){var t=e.input,n=e.meta,r=function(e){return function(n){var r=t.value===e;n.preventDefault(),t.onChange(r?null:e)}};return Zt.createElement(Vy,null,Zt.createElement(Gy,{active:"good"===t.value,onClick:r("good")},Zt.createElement(Kg,null)),Zt.createElement(Hy,null),Zt.createElement(Gy,{active:"bad"===t.value,onClick:r("bad")},Zt.createElement(Jg,null)),n.error&&n.touched&&Zt.createElement(Ly,null,n.error))},Yy=Object(Vv.C)("div",{target:"egtcv0s0"})("position:relative;border:1px solid #dde2e6;border-radius:4px;width:100%;background-color:#fff;transition:border-color 100ms linear;",(function(e){var t=e.focused,n=e.theme.spaceBase;return Object(C.a)({margin:.25*n+"px 0"},t?{borderColor:"#2200ff"}:{})})),Jy=Object(Vv.C)("select",{target:"egtcv0s1"})("width:100%;-webkit-appearance:none;font-family:inherit;background-color:transparent;border:none;:focus,:active{outline:none;border-color:#2200ff;}::-ms-expand{display:none;}",(function(e){var t=e.theme,n=t.spaceBase,r=t.typography;return Object(C.a)({},r.input,{padding:n+"px",paddingRight:"32px",":-moz-focusring":{color:"transparent",textShadow:"0 0 0 "+r.input.color}})})),Ky=Object(Vv.y)("position:absolute;pointer-events:none;right:0;top:calc(50% - ",16,"px);"),Qy=function(e){var t=e.onFocus,n=e.onBlur,r=Object(w.a)(e,["onFocus","onBlur"]),a=Zt.useState(!1),i=a[0],o=a[1];return Zt.createElement(Yy,{focused:i},Zt.createElement(Jy,Object(C.a)({},r,{onFocus:function(e){t&&t(e),o(!0)},onBlur:function(e){n&&n(e),o(!1)}})),Zt.createElement(Mg,{"aria-hidden":!0,focusable:"false",role:"presentation",className:Ky}))},Zy=function(e){var t=e.input,n=e.meta,r=Object(w.a)(e,["input","meta"]);return Zt.createElement(Zt.Fragment,null,Zt.createElement(Qy,Object(C.a)({},t,r)),n.error&&n.touched&&Zt.createElement(Ly,null,n.error))},Xy=Object(Vv.C)("input",{target:"e1xplv9i0"})("width:100%;border:1px solid #dddde6;-webkit-appearance:none;background-color:#fff;font-family:inherit;box-shadow:none;transition:border-color 100ms linear;:focus,:active{outline:none;border-color:#2200ff;}",(function(e){var t=e.theme,n=t.spaceBase,r=t.typography,a=t.borderRadius;return Object(C.a)({borderRadius:a},r.input,{padding:n+"px",margin:.25*n+"px 0"})})),$y=function(e){var t=e.input,n=e.meta,r=Object(w.a)(e,["input","meta"]),a=null;return n.submitError&&!n.dirtySinceLastSubmit?a=n.submitError:n.touched&&n.error&&(a=n.error),Zt.createElement(Zt.Fragment,null,Zt.createElement(Xy,Object(C.a)({},t,r,{value:t.value||""})),a&&Zt.createElement(Ly,null,a))},ej=Object(Vv.C)("textarea",{target:"edsifzp0"})("width:100%;border:1px solid #dddde6;-webkit-appearance:none;background-color:#fff;font-family:inherit;box-shadow:none;transition:border-color 100ms linear;resize:none;:focus,:active{outline:none;border-color:#2200ff;}",(function(e){var t=e.theme,n=t.spaceBase,r=t.typography,a=t.borderRadius;return Object(C.a)({borderRadius:a},r.input,{padding:n+"px",margin:.25*n+"px 0"})})),tj=function(e){var t=e.input,n=e.meta,r=Object(w.a)(e,["input","meta"]);return Zt.createElement(Zt.Fragment,null,Zt.createElement(ej,Object(C.a)({},t,r,{value:t.value||""})),n.error&&n.touched&&Zt.createElement(Ly,null,n.error))};function nj(){return Zt.createElement("path",{stroke:"#7a8289",d:"M4,0.5 C2.06700338,0.5 0.5,2.06700338 0.5,4 L0.5,12 C0.5,13.9329966 2.06700338,15.5 4,15.5 L12,15.5 C13.9329966,15.5 15.5,13.9329966 15.5,12 L15.5,4 C15.5,2.06700338 13.9329966,0.5 12,0.5 L4,0.5 Z"})}var rj=function(e){return Zt.createElement("path",Object(C.a)({fill:"#2200ff",d:"M4,0 L12,0 C14.209139,-4.4408921e-16 16,1.790861 16,4 L16,12 C16,14.209139 14.209139,16 12,16 L4,16 C1.790861,16 0,14.209139 0,12 L0,4 C-4.4408921e-16,1.790861 1.790861,0 4,0 Z"},e))},aj=function(e){return Zt.createElement("polyline",Object(C.a)({stroke:"#fff",strokeDasharray:"10",strokeLinecap:"round",strokeLinejoin:"round",points:"5 7.90626754 7.06606709 10 12 5"},e))},ij=Object(Vv.y)("animation-iteration-count:1;animation-timing-function:cubic-bezier(0,0,1,1);animation-fill-mode:forwards;animation-duration:300ms;"),oj=Object(Vv.B)("0%{opacity:0;}33.33%{opacity:1;}100%{opacity:1;}"),cj=Object(Vv.B)("0%{stroke-dashoffset:10;}33.33%{stroke-dashoffset:10;}77.78%{stroke-dashoffset:0;}100%{stroke-dashoffset:0;}"),sj=function(e){var t=e.className,n=e.checked,r=e.focused,a=Object(w.a)(e,["className","checked","focused"]);return Zt.createElement("svg",Object(C.a)({width:"100%",height:"100%",viewBox:"0 0 16 16",fill:"none",fillRule:"evenodd",className:Object(Vv.z)(Object(Vv.y)("border-radius:4px;background-color:#fff;"),r&&Object(Vv.y)("box-shadow:0px 0px 6px 1px ","#3b99fc",";"),t)},a),Zt.createElement(nj,null),n&&Zt.createElement(Zt.Fragment,null,Zt.createElement(rj,{className:Object(Vv.y)(ij," animation-name:",oj,";")}),Zt.createElement(aj,{className:Object(Vv.y)(ij," animation-name:",cj,";")})))},uj=Object(Vv.C)("input",{target:"e81sjne0"})("opacity:0;margin:0;padding:0;height:100%;width:100%;position:absolute;"),lj=function(e){var t=e.className,n=e.defaultChecked,r=void 0!==n&&n,a=e.checked,i=e.id,o=e.onBlur,c=void 0===o?x.P:o,s=e.onChange,u=void 0===s?x.P:s,l=e.onFocus,d=void 0===l?x.P:l,p=Object(w.a)(e,["className","defaultChecked","checked","id","onBlur","onChange","onFocus"]),f=Zt.useState(void 0!==a?a:r),m=f[0],h=f[1],v=Zt.useState(!1),g=v[0],b=v[1],y=cg();void 0!==a&&m!==a&&h(a);return Zt.createElement("label",{className:Object(Vv.z)(Object(Vv.y)("display:inline-block;position:relative;height:16px;width:16px;"),t)},Zt.createElement(uj,Object(C.a)({type:"checkbox",checked:m,id:i,onChange:function(e){u(e),void 0===a&&h((function(e){return!e}))},onFocus:function(e){d(e),"keyboard"===y()&&b(!0)},onBlur:function(e){c(e),b(!1)}},p)),Zt.createElement(sj,{"aria-hidden":!0,checked:m,focused:g,focusable:"false",role:"presentation",className:Object(Vv.y)("vertical-align:middle;")}))},dj=function(e){var t=e.color,n=void 0===t?"#7a8289":t,r=Object(w.a)(e,["color"]);return Zt.createElement("circle",Object(C.a)({fillRule:"nonzero",fill:n,cx:"8",cy:"8",r:"3.5"},r))},pj=function(e){var t=e.color,n=void 0===t?"#7a8289":t,r=Object(w.a)(e,["color"]);return Zt.createElement("circle",Object(C.a)({fillRule:"nonzero",cx:"8",cy:"8",r:"7.5",stroke:n,strokeWidth:"1"},r))},fj=Object(Vv.B)("0%{transform:scale(0,0);}50%{transform:scale(1.1,1.1);}66.67%{transform:scale(1.1,1.1);}83.33%{transform:scale(0.95,0.95);}100%{transform:scale(1,1);}"),mj=Object(Vv.B)("0%{opacity:0;}83.33%{opacity:1;}100%{opacity:1;}"),hj=Object(Vv.y)("animation-duration:200ms;animation-iteration-count:1;animation-fill-mode:forwards;animation-timing-function:cubic-bezier(0,0,0.58,1);"),vj=function(e){var t=e.className,n=e.checked,r=e.focused,a=Object(w.a)(e,["className","checked","focused"]);return Zt.createElement("svg",Object(C.a)({width:"100%",height:"100%",viewBox:"0 0 16 16",fill:"none",fillRule:"evenodd",className:Object(Vv.z)(Object(Vv.y)("border-radius:50%;background-color:#fff;"),r&&Object(Vv.y)("box-shadow:0px 0px 6px 1px ","#3b99fc",";"),t)},a),Zt.createElement(pj,null),n&&Zt.createElement(Zt.Fragment,null,Zt.createElement(pj,{color:"#2200ff",className:Object(Vv.y)(hj," animation-name:",mj,";")}),Zt.createElement(dj,{color:"#2200ff",className:Object(Vv.y)(hj," animation-name:",fj,";transform-origin:50% 50%;")})))},gj=Object(Vv.C)("input",{target:"e12lg4gr0"})("opacity:0;margin:0;padding:0;height:100%;width:100%;position:absolute;"),bj=function(e){var t=e.className,n=e.defaultChecked,r=void 0!==n&&n,a=e.checked,i=e.id,o=e.onBlur,c=void 0===o?x.P:o,s=e.onChange,u=void 0===s?x.P:s,l=e.onFocus,d=void 0===l?x.P:l,p=Object(w.a)(e,["className","defaultChecked","checked","id","onBlur","onChange","onFocus"]),f=Zt.useState(void 0!==a?a:r),m=f[0],h=f[1],v=Zt.useState(!1),g=v[0],b=v[1],y=cg();void 0!==a&&m!==a&&h(a);return Zt.createElement("label",{className:Object(Vv.z)(Object(Vv.y)("display:inline-block;position:relative;height:16px;width:16px;"),t)},Zt.createElement(gj,Object(C.a)({type:"radio",checked:m,id:i,onChange:function(e){u(e),void 0===a&&h((function(e){return!e}))},onBlur:function(e){c(e),b(!1)},onFocus:function(e){d(e),"keyboard"===y()&&b(!0)}},p)),Zt.createElement(vj,{"aria-hidden":!0,checked:m,focused:g,focusable:"false",role:"presentation",className:Object(Vv.y)("vertical-align:middle;")}))},yj=Object(Vv.y)("top:-1px;"),jj=function(e){var t=e.input,n=t.type,r=Object(w.a)(t,["type"]),a=e.id,i="checkbox"===n?lj:bj;return Zt.createElement(i,Object(C.a)({id:a,className:Object(Vv.y)(yj," flex-shrink:0;")},r))},Oj=Object(Vv.B)("0%{transform:rotate(-90deg);}100%{transform:rotate(270deg);}"),xj=Object(Vv.C)("circle",{target:"e5pj4iq0"})("animation-duration:1s;transform-origin:center;animation-name:",(function(e){return t=e.animationFactor,Object(Vv.B)("0%{stroke-dasharray:",22*t," ",1e3*t,";}50%{stroke-dasharray:",88*t," ",1e3*t,";}100%{stroke-dasharray:",22*t," ",1e3*t,";}");var t}),",",Oj,";animation-iteration-count:infinite;animation-timing-function:linear;"),_j={r:"28",cx:"32",cy:"32",fill:"none",strokeLinecap:"round"},Cj={small:{sideLength:16,strokeWidth:2},medium:{sideLength:24,strokeWidth:3},large:{sideLength:32,strokeWidth:4},xlarge:{sideLength:56,strokeWidth:4}},wj=Object(Rb.b)((function(e){var t=e.size,n=e.adjustToColor,r=void 0===n?"#ffffff":n,a=e.theme,i=Object(w.a)(e,["size","adjustToColor","theme"]),o=nr(r)?"rgba(0, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)",c=nr(r)?a.colors.cta:"#fff",s=Cj[t],u=s.sideLength,l=s.strokeWidth;return Zt.createElement("svg",Object(C.a)({height:u+"px",width:u+"px",viewBox:"0 0 64 64"},i),Zt.createElement("circle",Object(C.a)({},_j,{strokeWidth:l,stroke:o,vectorEffect:"non-scaling-stroke"})),Zt.createElement(xj,Object(C.a)({},_j,{strokeWidth:l,stroke:c,vectorEffect:"non-scaling-stroke",animationFactor:u/56})))})),Ej=Object(Vv.C)("button",{displayType:"Button",target:"esv0owm0"})("color:#fff;font-size:inherit;font-weight:bold;border:0;font-family:inherit;width:100%;max-width:320px;flex-shrink:0;cursor:pointer;display:flex;justify-content:center;align-items:center;",(function(e){var t=e.capitalize,n=e.color,r=e.disabled,a=e.dark,i=e.theme,o=i.spaceBase,c=i.typography,s=i.borderRadius;return Object(C.a)({borderRadius:s},c.basicContrast,{padding:1.5*o+"px",backgroundColor:""+(a?Object(k.a)(.2,n):n)},r?{":hover":{cursor:"default"}}:{},t?{textTransform:"capitalize"}:{})})),Ij=Object(Vv.C)("div",{target:"esv0owm1"})("display:flex;margin-left:0.5em;"),Sj=Object(Vv.C)("div",{target:"esv0owm2"})(),kj=Object(Rb.b)((function(e){var t=e.children,n=e.destructive,r=e.disabled,a=void 0!==r&&r,i=e.pending,o=void 0!==i&&i,c=e.theme,s=Object(w.a)(e,["children","destructive","disabled","pending","theme"]),u=n?c.colors.destructiveColor:c.colors.cta;return Zt.createElement(Ej,Object(C.a)({},s,{disabled:a,dark:o||a,color:u}),Zt.createElement(Sj,{ellipsis:!0},t),o&&Zt.createElement(Ij,null,Zt.createElement(wj,{size:"small",adjustToColor:u})))}));var Tj=function(e){var t=e.label,n=e.submitting,r=Object(w.a)(e,["label","submitting"]);return Zt.createElement(kj,Object(C.a)({pending:n,disabled:n,type:"submit"},r),Zt.createElement("span",null,t))},Aj={},Pj={errors:!0,touched:!0},Nj={submitError:!0},Mj={submitting:!0},zj={values:!0},Rj=Object(zy.a)(),Dj={format:function(e){return Object(x.nb)(e||"")},formatOnBlur:!0},Lj=function(){return Zt.createElement(My.c,{subscription:Nj},(function(e){var t=e.submitError;return t?Zt.createElement(Ly,null,t):null}))},Bj=document.hasFocus?function(){return document.hasFocus()}:function(){return!1},qj=function(e){return void 0===e&&(e=/mobile/gi.test(navigator.userAgent)),!e&&Bj()},Uj=Object(Vv.C)("div",{target:"e1n7ru1l0"})("text-align:center;"),Fj=function(e){var t=e.id,n=e.children,r=e.mobile,a=e.initialValues,i=e.submitLabel,o=e.validate,c=e.onSubmit,s="form_"+t;return vg((function(){qj(r)&&function(e){var t=Object(zy.b)(e)();if(t.length){var n=t[0],r=n.tagName;("INPUT"===r&&!Object(x.z)(n.type,["checkbox","radio"])||"TEXTAREA"===r)&&n.focus({preventScroll:!0})}}(s)})),Zt.createElement(My.b,{decorators:[Rj],initialValues:a,onSubmit:c,subscription:Aj,validate:o},(function(e){var t=e.handleSubmit;return Zt.createElement(Ry,{name:s,onSubmit:t},n,Zt.createElement(Lj,null),Zt.createElement(Uj,null,Zt.createElement(My.c,{subscription:Mj},(function(e){var t=e.submitting;return Zt.createElement(Tj,{submitting:t,label:i})}))))}))},Vj=Object(Vv.C)("div",{target:"eptvlbh0"})("display:flex;flex-direction:column;width:100%;margin-bottom:",(function(e){return e.theme.spaceBase+"px"}),";"),Gj=n(27),Hj=n.n(Gj),Wj=function(e){return e.stopPropagation()},Yj=Object(Vv.C)("a",{target:"e153l5x70"})("color:inherit;"),Jj=function(e){return Zt.createElement(Yj,Object(C.a)({},e,{onClick:Wj,rel:"nofollow noopener",target:"_blank",textWrap:!0}))},Kj=function(e){var t=e.children,n=e.htmlFor,r=e.showRequiredMark,a=void 0!==r&&r;return Zt.createElement(qy,{htmlFor:n,isRequired:a},"string"===typeof t?Zt.createElement(gc,{preserveLists:!0,template:t,root:{component:Hj.a,props:{component:Jj}}}):t)},Qj=function(e){var t=e.label,n=e.name,r=e.required;return Zt.createElement(Vj,null,t&&Zt.createElement(Kj,{showRequiredMark:r,htmlFor:n},t),Zt.createElement(My.a,Object(C.a)({},Dj,{component:tj,name:n,id:n})))},Zj=Object(Vv.C)("div",{target:"e1mnxbjv0"})("display:flex;justify-content:center;"),Xj=Object(Vv.C)("div",{target:"e1mnxbjv1"})("background-color:#dde2e6;border-radius:50%;display:flex;justify-content:center;align-items:center;",(function(e){return{width:e.size,height:e.size}}),";"),$j=function(e){var t=e.size,n=void 0===t?"64px":t,r=e.children,a=Object(w.a)(e,["size","children"]);return Zt.createElement(Zj,null,Zt.createElement(Xj,Object(C.a)({size:n},a),r))},eO="DISABLE_PERMANENTLY",tO="TOOLTIP_HOVER_START",nO="TOOLTIP_HOVER_END",rO="TRIGGER_HOVER_START",aO="TRIGGER_HOVER_END",iO=Object(Vv.C)("div",{displayName:"Tooltip",target:"ezqijrk0"})("display:inline-block;background-color:#424d57;color:#fff;padding:1em;position:fixed;border-radius:8px;z-index:9;font-size:0.8em;white-space:nowrap;font-weight:normal;margin-top:0.5em;border-bottom:1px solid #000;",(function(e){var t=e.position;return{left:t.left?t.left-10+"px":"auto",right:t.right?t.right-10+"px":"auto",top:t.top+"px"||!1}}),";"),oO=Object(Vv.C)("svg",{displayName:"TooltipArrow",target:"ezqijrk1"})("position:absolute;fill:#424d57;margin-top:-1.5em;",(function(e){var t=e.position,n=e.horizontalFactor;return{left:t.left?n-10+"px":"auto",right:t.right?n-10+"px":"auto",top:"0"}}),";"),cO=Object(Vv.C)("div",{target:"ezqijrk2"})("position:relative;"),sO=function(e){var t=e.getBoundingClientRect(),n=t.left,r=t.right,a=t.bottom,i=window,o=i.innerWidth,c=i.pageXOffset,s=a+i.pageYOffset;return n+c>o/2?{top:s,right:o-(r+c)}:{top:s,left:n+c}},uO={permanentlyDisabled:!1,triggerHovered:!1,tooltipHovered:!1,triggerData:null},lO=function(e,t){switch(t.type){case eO:return Object(C.a)({},uO,{permanentlyDisabled:!0});case tO:return Object(C.a)({},e,{tooltipHovered:!0});case nO:return Object(C.a)({},e,{tooltipHovered:!1});case rO:return Object(C.a)({},e,{triggerHovered:!0,triggerData:{position:t.position,targetWidth:t.targetWidth}});case aO:return Object(C.a)({},e,{triggerHovered:!1});default:return e}};var dO=function(e){var t=e.children,n=e.label,r=e.disabled,a=void 0!==r&&r,i=Object(w.a)(e,["children","label","disabled"]),o=Zt.useReducer(lO,uO),c=o[0],s=c.tooltipHovered,u=c.triggerHovered,l=c.triggerData,d=c.permanentlyDisabled,p=o[1];return a&&u&&p({type:aO}),Zt.createElement(Zt.Fragment,null,Zt.createElement("div",Object(C.a)({className:Object(Vv.y)("display:flex;align-items:stretch;flex-shrink:0;"),onMouseEnter:function(e){var t=e.currentTarget;a||d||p({type:rO,position:sO(t),targetWidth:t.offsetWidth})},onMouseLeave:function(){return p({type:aO})},onTouchStart:function(){return p({type:eO})}},i),t),(u||s)&&l&&Zt.createElement(yy,{portalId:"tooltip-portal"},Zt.createElement(iO,{onMouseEnter:function(){return p({type:tO})},onMouseLeave:function(){return p({type:nO})},position:l.position},Zt.createElement(cO,null,Zt.createElement(oO,{horizontalFactor:l.targetWidth/2,height:"10",position:l.position,width:"16"},Zt.createElement("polygon",{points:"0,10 16,10 8,0"})),n))))},pO=Object(Vv.y)("text-align:center;"),fO=Object(Vv.y)("font-size:inherit;"),mO=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={opened:!1,selectedRate:t.props.chatRate},t.handleRate=Object(x.L)((function(e){return function(){var n=t.state.selectedRate===e,r=n?null:e;t.rateChat(r),t.setState({selectedRate:r,opened:!n})}})),t.closeModal=function(){t.setState({opened:!1})},t.validate=function(e){if(!e.comment)return{comment:t.props.localize("survey_fill_in_required_fields")}},t.handleSubmit=function(e){t.props.rateChat({comment:e.comment}),t.closeModal()},t.getRateButtonProps=function(e){var n=t.props,r=n.chatRate;return{disabled:n.disabled,active:r===e,onClick:t.handleRate(e)}},t}Object(Fv.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){e.chatRate!==this.props.chatRate&&this.setState({selectedRate:this.props.chatRate})},n.rateChat=function(e){var t=this;this.props.rateChat({rate:e}).catch((function(){return t.setState({selectedRate:t.props.chatRate})}))},n.render=function(){var e=this.state,t=e.opened,n=e.selectedRate,r=this.props,a=r.disabled,i=r.chatRate,o=r.mobile,c=r.localize;return Zt.createElement(Zt.Fragment,null,Zt.createElement(dO,{disabled:a,label:c("good"===i?"rate_me_cancel_tooltip":"rate_me_good_tooltip")},Zt.createElement(Bg,this.getRateButtonProps("good"),Zt.createElement(Kg,{className:fO}))),Zt.createElement(dO,{disabled:a,label:c("bad"===i?"rate_me_cancel_tooltip":"rate_me_bad_tooltip")},Zt.createElement(Bg,this.getRateButtonProps("bad"),Zt.createElement(Jg,{className:fO}))),Zt.createElement(Ny,{shown:t,onClose:this.closeModal},Zt.createElement($j,null,"good"===n?Zt.createElement(Kg,null):Zt.createElement(Jg,null)),Zt.createElement("p",{className:pO},c("rate_me_add_comment")),Zt.createElement(Fj,{id:"rate_comment",mobile:o,onSubmit:this.handleSubmit,submitLabel:c("button_add_feedback"),validate:this.validate},Zt.createElement(Vv.q,null,Zt.createElement(Qj,{name:"comment",required:!0,mobile:o})))))},t}(Zt.Component),hO=Qt((function(e,t){var n=t.chatId,r=function(t){var r=t.rate,a=t.comment,i={};return void 0!==r&&(i.rate=r),void 0!==a&&(i.rateComment=a),e.requestUpdateChat(n,{properties:i})};return function(e){var t=e.getChat(n),a=t.active,i=t.properties,o=i.ended;return{chatRate:i.rate,disabled:!o&&!a,iconTheme:e.getApplicationState("config").theme.iconTheme,mobile:e.getApplicationState("mobile"),rateChat:r,localize:e.localize}}}))(mO),vO=Object(Vv.C)("div",{displayName:"Divider",target:"evqzb400"})("border-top:1px solid rgba(0,0,0,0.05);margin:0 1em;margin-bottom:-1px;z-index:10;position:relative;"),gO=Object(Vv.C)(Vv.a,{target:"e1ac7kkx0"})("position:relative;box-shadow:0 0.15em 0.3em rgba(0,0,0,0.05);"),bO=Object(Vv.C)("div",{target:"e1ac7kkx1"})("display:flex;align-items:center;position:relative;margin-right:0.5em;"),yO=Object(Vv.y)("flex:1;justify-content:center;"),jO=Object(Vv.C)("div",{target:"e1ac7kkx2"})("width:12px;height:12px;background:#70d526;border:2px solid #fff;position:absolute;border-radius:50%;right:0;top:0;"),OO=Object(Vv.y)("margin-right:0;"),xO=Object(Vv.y)("justify-content:center;"),_O=Object(Vv.y)(xO," min-width:auto;"),CO=Object(Vv.C)("img",{target:"e1ac7kkx3"})("height:auto;max-height:50px;"),wO=Object(Vv.C)("div",{displayName:"TopBar",target:"e1ac7kkx4"})("position:relative;z-index:1;height:auto;bottom:0;@media (max-height:330px){display:none;}"),EO=Object(x.L)((function(e){return function(t){return t.position===e}})),IO=Qt((function(e,t){var n=t.chatId;return function(e){return{agent:un(n,e),chatActive:e.getChat(n).active,showAvatar:ln("agentAvatar",e).enabled,logoPath:(t=ln("logo",e).path,"https://"+Object(I.j)(t)),showLogo:ln("logo",e).enabled&&"modern"===Dn(e),showAgentBar:Vn(e)};var t}}))(Object(Rb.b)((function(e){var t=e.theme,n=e.agent,r=e.chatId,a=e.showAvatar,i=e.logoPath,o=e.showLogo,c=e.showAgentBar,s=e.scrollingDeltaSource,u=e.isOnBottomSource,l=Zt.useRef(),d=Zt.useRef(),p=t.TopBar.css.height,f=Zt.useCallback((function(){l.current&&(l.current.style.bottom=0,l.current.style.height="auto"),d.current&&(d.current.style.opacity=1)}),[]);return jg(s,(function(e){var t=e.y;c&&(l.current&&(l.current.style.bottom=t*p+"px",l.current.style.height=p-t*p+"px"),d.current&&(d.current.style.opacity=1-2*t))})),Zt.useEffect((function(){c||f()}),[c,f]),Zt.useEffect((function(){if(u)return u.subscribe((function(e){e&&f()}))}),[u,f]),Zt.createElement(wO,{innerRef:l},c&&Zt.createElement(Zt.Fragment,null,Zt.createElement(vO,null),Zt.createElement(gO,{noShrink:!0},Zt.createElement(Vv.q,{flexFill:!0,innerRef:d},a&&n.avatar&&Zt.createElement(bO,null,Zt.createElement(Vv.b,{className:OO,imgUrl:n.avatar}),Zt.createElement(jO,null)),Zt.createElement(Vv.q,{flexFill:!0},Zt.createElement(Vv.g,{className:yO,flexFill:!0},Zt.createElement(Vv.w,{ellipsis:!0},n.name),n.properties.jobTitle&&Zt.createElement(Vv.s,{ellipsis:!0},n.properties.jobTitle),Zt.createElement(gy,{condition:EO("bottom"),name:"rating"},Zt.createElement(Vv.q,null,Zt.createElement(hO,{chatId:r})))),Zt.createElement(gy,{condition:EO("right"),name:"rating"},Zt.createElement(Vv.g,{className:xO,noShrink:!0},Zt.createElement(Vv.q,null,Zt.createElement(hO,{chatId:r})))),o&&Zt.createElement(Vv.g,{className:_O},Zt.createElement(CO,{alt:"",src:i})))))))}))),SO=function(e){return e.buttons?Object(C.a)({},e,{buttons:e.buttons.map((function(e){switch(e.type){case"phone":e.type;var t=e.value,n=Object(w.a)(e,["type","value"]);return Object(C.a)({},n,{href:"tel:"+t,target:"_parent"});case"url":e.type;var r=e.value,a=Object(w.a)(e,["type","value"]);return Object(C.a)({},a,{href:r,target:"_blank"});default:if("value"in e){e.type,e.value;var i=Object(w.a)(e,["type","value"]);return Object(C.a)({},i)}e.type;var o=Object(w.a)(e,["type"]);return Object(C.a)({},o)}}))}):e},kO=function(e){var t=e.card,n=e.onButtonClick;return Zt.createElement(Vv.d,{card:SO(t),onButtonClick:n})},TO=function(e,t,n){return void 0===n&&(n=[]),e.buttons?Object(C.a)({},e,{buttons:e.buttons.map((function(e){return Object(C.a)({},e,{disabled:t||!!Object(x.k)((function(t){return t===e.type}),n)})}))}):e},AO=function(e){var t=e.card,n=e.disabledButtons,r=e.eventId,a=e.onActionButtonClick,i=Zt.useState(!1),o=i[0],c=i[1];return Zt.useEffect((function(){if(o){var e=setTimeout((function(){c(!1)}),1e3);return function(){return clearTimeout(e)}}}),[o]),Zt.createElement(kO,{card:TO(t,o,n),onButtonClick:function(e,n){c(!0),a({button:t.buttons[n],event:r})}})},PO=function(e){return e.stopPropagation()},NO=Object(Vv.y)("color:inherit;"),MO=function(e){var t=e.children,n=Object(w.a)(e,["children"]);return Zt.createElement("a",Object(C.a)({},n,{onClick:PO,className:NO,rel:"nofollow noopener",target:"_blank"}),t)},zO=function(e){var t=e.text,n=e.url;return Zt.createElement(Vv.m,null,n?Zt.createElement(MO,{href:n},t):Zt.createElement(Hj.a,{component:MO},t))},RO=function(e){var t=e.text,n=e.url,r=e.radiusType,a=void 0===r?"single":r;return Zt.createElement(Vv.c,{radiusType:a},Zt.createElement(zO,{text:t,url:n}))},DO=Object(Vv.C)("img",{target:"e1f2pv4c0"})("width:100%;height:100%;object-fit:",(function(e){return e.scaleImage?"cover":"fill"}),";display:",(function(e){return e.isLoaded?"block":"none"}),";"),LO=Object(Vv.C)("div",{displayName:"ImagePreview",target:"e1f2pv4c1"})("margin:0 auto;overflow:hidden;background:#fff;display:flex;align-items:center;justify-content:center;",(function(e){var t=e.dimensions;return{width:t.width,height:t.height}})),BO=function(e){return e.stopPropagation()},qO=function(e){var t=e.children,n=Object(w.a)(e,["children"]);return Zt.createElement("a",Object(C.a)({},n,{onClick:BO,rel:"noopener noreferrer nofollow",target:"_blank"}),t)},UO=function(e){var t=e.link,n=e.url,r=e.width,a=e.height,i=e.maxWidth,o=e.maxHeight,c=Object(w.a)(e,["link","url","width","height","maxWidth","maxHeight"]),s=Zt.useState(!1),u=s[0],l=s[1],d=!!r||!!a,p=function(e){var t=void 0===e?{}:e,n=t.width,r=void 0===n?230:n,a=t.height,i=void 0===a?150:a,o=t.maxWidth,c=void 0===o?200:o,s=t.maxHeight,u=void 0===s?300:s,l=r/i;return r>c&&(i=(r=c)/l),i>u&&(r=(i=u)*l),{width:r,height:i}}({width:r,height:a,maxWidth:i,maxHeight:o});return Zt.createElement(qO,{href:t||n},Zt.createElement(LO,{dimensions:p},Zt.createElement(DO,Object(C.a)({},c,{src:n,isLoaded:u,scaleImage:!d,onLoad:function(){return l(!0)}})),!u&&Zt.createElement(Ug,{color:"#9c9c9f"})))},FO=function(e){function t(){return e.apply(this,arguments)||this}Object(Fv.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e,t,n){n&&this._messageListContext.scrollToBottom()},n.getSnapshotBeforeUpdate=function(e){return!this.shouldRenderPreview(e)&&this.shouldRenderPreview()&&this._messageListContext.isScrollOnBottom()},n.shouldRenderPreview=function(e){return void 0===e&&(e=this.props),Boolean(e.urlPreview.properties.title)},n.render=function(){var e=this;return Zt.createElement(Vv.l,null,(function(t){e._messageListContext=t;var n=e.props,r=n.urlPreview.properties,a=n.radiusType;return e.shouldRenderPreview()?Zt.createElement(Vv.c,{radiusType:a},Zt.createElement(UO,{image:r.image}),Zt.createElement(Vv.n,{subtitle:r.description,title:r.title})):Zt.createElement(Vv.c,{radiusType:a},Zt.createElement(zO,{text:r.text}))}))},t}(Zt.Component),VO=Object(Vv.C)("div",{target:"erkouar0"})("max-width:300px;max-height:300px;"),GO=Object(Vv.C)("img",{target:"erkouar1"})("display:block;width:auto;height:auto;max-width:100%;max-height:100%;"),HO=function(e){var t=e.url,n=e.name;return Zt.createElement(VO,null,Zt.createElement(GO,{alt:n,src:t}))},WO=function(e){var t=e.children;return Zt.createElement(Vv.i,{date:"",showMetaOnClick:!1,system:!0},Zt.createElement(Vv.c,null,Zt.createElement(zO,{text:t})))},YO=Object(Vv.C)("span",{target:"e1vbunaw0"})("font-size:2.5em;"),JO=function(e){var t=e.emoji,n=e.radiusType;return Zt.createElement(Vv.c,{radiusType:n},Zt.createElement(Vv.m,null,Zt.createElement(YO,null,t.properties.text)))},KO=Object(Vv.C)("div",{target:"e7yhn050"})("background-color:#fff;border-radius:6px;"),QO=Object(Vv.C)(KO,{displayName:"SystemCard",target:"e1r9cm3y0"})("padding:8px;margin:2px 0;width:100%;max-width:270px;position:relative;"),ZO=Object(Vv.C)("div",{target:"e1q4zsg90"})("display:flex;flex-direction:row;position:absolute;top:-21px;left:0;right:0;color:white;"),XO=Object(Vv.C)("div",{target:"e1q4zsg91"})("display:flex;justify-content:center;align-items:center;overflow:hidden;margin:0 auto;border-radius:50%;width:",42,"px;height:",42,"px;background-color:",(function(e){var t=e.theme;return e.backgroundColor||t.colors.cta}),";"),$O=function(e){var t=e.children,n=e.backgroundColor;return Zt.createElement(ZO,null,Zt.createElement(XO,{backgroundColor:n},t))},ex=function(e){return Object(Vv.y)("margin-left:4px;margin-top:3px;fill:currentColor;transform:","scaleY("+("up"===e?-1:1)+")",";")},tx=function(e){var t=e.direction,n=void 0===t?"down":t;return Zt.createElement("svg",{viewBox:"0 0 7 4",width:"7px",height:"4px",className:ex(n)},Zt.createElement("path",{d:"M1.1,0.2C0.9,0,0.5,0,0.4,0.2s-0.2,0.5,0,0.7l2.8,2.8c0.2,0.2,0.5,0.2,0.7,0l2.8-2.8c0.2-0.2,0.2-0.5,0-0.7S6.2,0,6,0.2 L3.5,2.7L1.1,0.2z"}))},nx=Object(Vv.C)("div",{target:"eentevd0"})("display:flex;flex-direction:row;align-items:center;justify-content:center;margin-top:8px;font-size:12px;text-align:center;cursor:pointer;color:",(function(e){return e.theme.colors.cta}),";"),rx=Object(Vv.C)("div",{target:"e1g195pu0"})("position:absolute;top:50%;bottom:0;left:0;right:0;pointer-events:none;background:linear-gradient(rgba(255,255,255,0),rgba(255,255,255,0.9));"),ax=Object(Vv.C)("div",{target:"e9s6ynt0"})("position:relative;overflow:hidden;height:auto;transition:max-height 300ms cubic-bezier(0.14,0,0,1);"),ix=Object(Vv.C)("div",{target:"e1cdxu9o0"})("overflow:auto;height:auto;padding:8px;"),ox=Qt((function(e,t){var n=t.icon,r=e.getApplicationState("config").theme;return{showIcon:!!n&&"modern"!==r.name,rtl:e.getApplicationState("rtl"),localize:e.localize}}))((function(e){var t,n,r=e.icon,a=e.showIcon,i=e.children,o=e.collapsible,c=void 0!==o&&o,s=e.defaultCollapsed,u=void 0!==s&&s,l=e.collapsedHeight,d=void 0===l?100:l,p=e.collapseThreshold,f=void 0===p?20:p,m=e.rtl,h=e.localize,v=Zt.useRef(0),g=Zt.useRef(!1),b=Zt.useRef(null),y=Zt.useRef(null),j=Zt.useState(!1),O=j[0],x=j[1],_=Zt.useState(c),C=_[0],w=_[1],E=Object(Qv.a)((function(){return c&&u?(e=d+"px",Object(Vv.y)("max-height:",e,";")):null;var e})),I=Zt.useCallback((function(e){y.current.style.maxHeight="number"===typeof e?e+"px":e}),[]),S=Zt.useCallback((function(){x(!O)}),[O]),k=Zt.useCallback((function(){O||I("none")}),[O,I]);return Zt.useEffect((function(){return function(){return cancelAnimationFrame(v.current)}}),[]),Zt.useEffect((function(){var e=b.current.offsetHeight,t=e>d&&e-d>f;w(t&&c),!g.current&&c&&x(t&&u),g.current=c}),[c,u,d,f]),Zt.useEffect((function(){C?(I(b.current.offsetHeight),O&&(cancelAnimationFrame(v.current),v.current=requestAnimationFrame((function(){return I(d)})))):I("none")}),[C,O,d,I]),Zt.createElement("div",{className:Object(Vv.z)(a&&(n="21px",Object(Vv.y)("padding-top:",n,";")))},Zt.createElement(QO,{rtl:m},a?r:null,Zt.createElement(ax,{innerRef:y,onTransitionEnd:k,className:Object(Vv.z)(a&&(t="12px",Object(Vv.y)("margin-top:",t,";")),E)},Zt.createElement(ix,{innerRef:b},i),O&&Zt.createElement(rx,null)),C&&Zt.createElement(nx,{onClick:S},Zt.createElement("span",null,h(O?"show_more":"show_less")),Zt.createElement(tx,{direction:O?"down":"up"}))))})),cx=Object(Vv.C)("div",{target:"e1fikopb0"})("padding-bottom:12px;",(function(e){return e.theme.typography.basic})),sx=Object(Vv.C)(Bg,{target:"e1fikopb1"})("margin:0;padding:0;display:flex;width:40px;cursor:pointer;border:1px solid;align-items:center;justify-content:center;"),ux=Object(Vv.C)(sx,{target:"e1fikopb2"})("border-radius:0;",(function(e){var t,n=e.rtl?"Left":"Right";return Object(Vv.y)(((t={})["borderTop"+n+"Radius"]=6,t["borderBottom"+n+"Radius"]=6,t))})," color:white;border:1px solid ",(function(e){var t=e.theme;return e.disabled?"rgb(170, 170, 170)":t.colors.cta}),";background-color:",(function(e){var t=e.theme;return e.disabled?"rgb(170, 170, 170)":t.colors.cta}),";"),lx=Object(Vv.C)(sx,{target:"e1fikopb3"})("color:#424d57;border:none;background-color:transparent;"),dx=Object(Vv.C)("span",{target:"e1fikopb4"})("width:100%;align-items:center;padding:8px;margin:1px;",(function(e){return e.theme.typography.input})," ",(function(e){var t=e.active,n=e.theme;return t&&Object(Vv.y)("color:",n.colors.cta,";")})),px=Object(Vv.C)("form",{target:"e1fikopb5"})("display:flex;flex-direction:row;"),fx=function(e){var t,n=e?"Left":"Right";return Object(Vv.y)(((t={margin:0})["border"+n]="none",t["borderTop"+n+"Radius"]=0,t["borderBottom"+n+"Radius"]=0,t))},mx=Qt((function(e,t){var n=t.id,r=t.chatId,a=function(t){return bi(e,{email:t}),new Promise((function(t){return e.once("customer_updated",t)}))};return function(e){var t=e.getSessionUser().email,i=e.getApplicationState(),o=i.rtl,c=i.mobile,s=e.getEvent(r,n).thread,u=e.getChat(r).properties;return{rtl:o,email:t,mobile:c,updateSessionUserEmail:a,active:s===u.lastThread}}}))((function(e){var t=e.rtl,n=e.email,r=e.mobile,a=e.active,i=e.updateSessionUserEmail,o=Zt.useRef(null),c=Zt.useState(!n),s=c[0],u=c[1],l=Zt.useState(n||""),d=l[0],p=l[1],f=Zt.useCallback((function(e){var t=e.target;p(t.value)}),[]),m=Zt.useCallback((function(e){e.preventDefault(),i(d).then((function(){return u(!1)}))}),[d,i]),h=Zt.useCallback((function(){u(!0),p(n||"")}),[n]),v=Zt.useCallback((function(){n&&u(!1)}),[n]);Object(Xv.a)(o,v);var g=!n||a&&s,b=!d||d===n;return Zt.createElement(ox,null,Zt.createElement(cx,null,n?"As soon as our agents will reply to your message we will send you notification at:":"It seems that this is our first conversation. Leave us your email address so we can get back to you."),Zt.createElement(px,{innerRef:o,onSubmit:m},g?Zt.createElement(Zt.Fragment,null,Zt.createElement(Xy,{autoFocus:!0,role:"input",type:"email",value:d,className:fx(t),onChange:f}),Zt.createElement(ux,{rtl:t,type:"submit",role:"button submit",disabled:b},Zt.createElement(kg,null))):Zt.createElement(Zt.Fragment,null,Zt.createElement(dx,{mobile:r,ellipsis:!0,active:a},n),a&&Zt.createElement(lx,{role:"button edit",onClick:h},Zt.createElement(Dg,null)))))})),hx=Object(Vv.C)("div",{target:"efus62t0"})("margin-bottom:8px;a{color:inherit;}"),vx=Object(Vv.C)("div",{target:"efus62t1"})("width:100%;margin-bottom:2px;font-size:14px;color:#9c9c9f;"),gx=Object(Vv.C)("div",{target:"efus62t2"})("width:100%;font-size:14px;color:#3e3e41;"),bx=function(e){var t=e.fields;return Zt.createElement(Zt.Fragment,null,t.map((function(e,t){var n=e.label,r=e.answer;return Zt.createElement(hx,{key:t},Zt.createElement(vx,{textWrap:!0},Zt.createElement(gc,{preserveLists:!0,template:n,root:{component:Hj.a,props:{component:Jj}}})),Zt.createElement(gx,{textWrap:!0},"string"===typeof r?r:r.join(", ")))})))},yx=function(e){function t(){return e.apply(this,arguments)||this}Object(Fv.a)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){var e=this.props,t=e.form,n=e.name,r=t.getFieldState(n);r&&r.value&&t.change(n,void 0)},n.render=function(){return this.props.children},t}(Zt.Component);var jx=function(e){var t=e.when,n=e.children;return t?Zt.createElement(My.c,{subscription:zj},(function(n){var r=n.form;return n.values[t]?Zt.createElement(yx,Object(C.a)({},e,{form:r})):null})):Zt.createElement(Zt.Fragment,null,n)},Ox=Object(Vv.C)("p",{target:"ecj3oet0"})("margin:0;a{color:inherit;}",(function(e){return e.theme.typography.basic})),xx=function(e){var t=e.children;return Zt.createElement(Ox,null,"string"===typeof t?Zt.createElement(gc,{template:t,root:{component:Hj.a,props:{component:Jj}}}):t)},_x=n(39),Cx=function(e){var t=e.name,n=e.label,r=e.required;return Zt.createElement(Vj,null,Zt.createElement(Kj,{showRequiredMark:r,htmlFor:t},n),Zt.createElement(My.a,Object(C.a)({},Dj,{id:t,autoComplete:"name"===t?t:"off",component:$y,name:t})))},wx=function(e){var t=e.label,n=e.name,r=e.required,a=void 0!==r&&r;return Zt.createElement(Vj,null,t&&Zt.createElement(Kj,{showRequiredMark:a,htmlFor:n},t),Zt.createElement(My.a,Object(C.a)({},Dj,{autoComplete:"email",id:n,name:n,type:"email",component:$y})))},Ex=function(e){var t=e.children,n=e.showRequiredMark,r=void 0!==n&&n;return Zt.createElement(Fy,{isRequired:r},"string"===typeof t?Zt.createElement(gc,{preserveLists:!0,template:t,root:{component:Hj.a,props:{component:Jj}}}):t)},Ix=Object(Vv.C)(Vv.q,{target:"evnlvbu0"})((function(e){var t=e.theme,n=t.spaceBase,r=t.typography;return Object(C.a)({},r.basic,{margin:.5*n+"px 0"})})),Sx=Object(Vv.C)(qy,{target:"evnlvbu1"})((function(e){return{paddingLeft:e.theme.spaceBase+"px"}})),kx=function(e){var t=e.id,n=e.name,r=e.label,a=e.type,i=e.value;return Zt.createElement(Ix,null,Zt.createElement(My.a,{id:t,name:n,type:a,value:i,component:jj}),Zt.createElement(Sx,{htmlFor:t},r))},Tx=Object(Vv.y)("border:none;margin:0;padding:0;max-height:100%;"),Ax=function(e){var t=e.options,n=e.label,r=e.name,a=e.type,i=e.required;return Zt.createElement(Vj,null,Zt.createElement("fieldset",{className:Tx,name:r},n&&Zt.createElement(Ex,{showRequiredMark:i},n),t.map((function(e,t){return Zt.createElement(kx,{key:t,id:r+"_"+t,label:e.label,name:r,type:a,value:e.value})})),Zt.createElement(My.c,{subscription:Pj},(function(e){var t=e.errors,n=e.touched;return t[r]&&n&&n[r]?Zt.createElement(Ly,null,t[r]):null}))))},Px=Object(Vv.C)("option",{target:"e1t56ivc0"})("color:",(function(e){return e.primary?"#090":"inherit"}),";"),Nx=function(e){var t=e.meta,n=e.name,r=e.label,a=e.value,i=e.localize,o=void 0!==t&&void 0!==t.online,c=Boolean(t&&t.online),s=" ("+i(c?"skill_status_online":"skill_status_offline")+")";return Zt.createElement(Px,{name:n,primary:o&&c,value:a},""+r+(o?s:""))},Mx=function(e){var t=e.options,n=e.label,r=e.name,a=e.localize,i=e.required;return Zt.createElement(Vj,null,Zt.createElement(Kj,{showRequiredMark:i,htmlFor:r},n),Zt.createElement(My.a,{id:r,name:r,fullWidth:!0,component:Zy},Zt.createElement("option",{value:""},a("forms_choose")),t.map((function(e,t){return Zt.createElement(Nx,{key:t,meta:e.meta,label:e.label,localize:a,name:r,value:e.value})}))))},zx=function(e){var t=e.label,n=e.name,r=e.required,a=void 0!==r&&r;return Zt.createElement(Vj,null,Zt.createElement(Kj,{showRequiredMark:a,htmlFor:n},t),Zt.createElement(My.a,{id:n,component:Wy,name:n}))},Rx=Object(Vv.C)("div",{target:"e12liu9t0"})("margin:0;a{color:inherit;}ul,ol{margin:8px 0;padding-left:24px;}",(function(e){return e.theme.typography.basic})),Dx={information:function(e){var t=e.value;return Zt.createElement(Vj,null,Zt.createElement(Rx,{preserveLines:!0,textWrap:!0},Zt.createElement(gc,{template:t,root:{component:Hj.a,props:{component:Jj}}})))},text:Cx,textarea:Qj,email:wx,rating:zx,radio:Ax,checkbox:Ax,select:Mx};var Lx=function(e){var t=e.type;return Dx[t]},Bx=function(e,t){switch(t){case"prechat":return e("prechat_submit_label");case"offline":return e("offline_form_submit_label");default:return e("submit")}},qx=Qt((function(e,t){var n=t.chatId,r=t.eventId,a=t.type,i=function(t){if("prechat"===a){var i=t.name,o=t.email,c=Object(x.d)({name:i,email:o});Object(x.B)(c)||e.updateUser(e.getSessionUserId(),c)}return e.requestUpdateEvent(n,r,{properties:{answers:t}})};return function(e){return{localize:e.localize,mobile:e.getApplicationState("mobile"),sendForm:i,sessionUser:e.getSessionUser()}}}))((function(e){var t=e.id,n=e.type,r=e.fields,a=e.mobile,i=e.localize,o=e.sendForm,c=e.sessionUser,s=Zt.useContext(Yv),u=Object(Qv.a)((function(){var e=s.get(t,n),a=function(e,t){var n=e.name,r=e.email;return n===t("client")?{email:r}:{email:r,name:n}}(c,i);return function(e,t,n){return e.map((function(e){var r=n?n[e.name]:null,a=t?t[e.name]:null,i=r||a;return i?Object(C.a)({},e,{defaultValue:i}):e})).filter((function(e){return"defaultValue"in e})).reduce((function(e,t){var n=t.name,r=t.defaultValue;return e[n]=r,e}),{})}(r,a,e)}));return Zt.createElement(Fj,{id:t,mobile:a,initialValues:u,validate:function(e){return r.reduce((function(t,n){var r,a,o,c=n.required,s=n.name;return c&&(a=e[s],Object(x.A)(a)?Object(x.B)(a):!Boolean(a))?Object(C.a)({},t,((r={})[s]=i("survey_fill_in_required_fields"),r)):"maxLength"in n&&"number"===typeof n.maxLength&&e[s]&&e[s].length>n.maxLength?Object(C.a)({},t,((o={})[s]="Cannot be longer than "+n.maxLength+" characters long.",o)):t}),{})},onSubmit:function(e){return o(e).then((function(){s.delete(n)}),(function(e){var t;return e||((t={})[_x.a]="Please check your internet connection and then try again.",t)}))},submitLabel:Bx(i,n)},r.map((function(e,t){var n=Lx(e);return Zt.createElement(Vv.q,{key:t},Zt.createElement(jx,{name:e.name,when:e.dependOn},Zt.createElement(n,Object(C.a)({},e,{localize:i}))))})),Zt.createElement(My.c,{onChange:function(e){var r=e.values;e.dirty&&s.set(t,n,r)},subscription:{values:!0,dirty:!0}}))})),Ux=function(e){var t=e.theme;return Zt.createElement($O,{backgroundColor:t.colors.cta},Zt.createElement(Hg,{color:"#ffffff"}))},Fx=function(e){var t=e.theme;return Zt.createElement($O,{backgroundColor:t.colors.cta},Zt.createElement(Yg,{color:"#ffffff"}))},Vx=function(e){var t=e.answered,n=e.theme;return Zt.createElement($O,{backgroundColor:t?"#2ac874":n.colors.cta},t?Zt.createElement(Qg,{color:"#ffffff"}):Zt.createElement(Fg,{color:"#ffffff"}))},Gx=function(e){var t=e.localize;return Zt.createElement(xx,null,t("offline_message_sent"))},Hx=Object(Rb.b)((function(e){var t=e.theme,n=e.chatId,r=e.id,a=e.setScrollTargetNode,i=e.form.properties,o=i.formId,c=i.formType,s=i.fields,u=i.answered,l=s.filter((function(e){return e.answer&&e.label})),d="offline"!==c&&u&&Object(x.B)(l),p=Zt.useRef(null);if(vg((function(){!u&&p.current&&a&&a(p.current)})),d)return null;var f=function(e){switch(e){case"prechat":return Ux;case"postchat":return Fx;case"offline":return Vx}}(c),m=function(e){switch(e){case"prechat":case"postchat":return bx;case"offline":return Gx}}(c);return Zt.createElement("div",{ref:p},Zt.createElement(rn,null,(function(e){return Zt.createElement(ox,{defaultCollapsed:!0,collapsible:u,icon:Zt.createElement(f,{theme:t,answered:u})},u?Zt.createElement(m,{fields:l,localize:e}):Zt.createElement(qx,{key:c,chatId:n,eventId:r,id:o,type:c,fields:s}))})))})),Wx={enter:600,exit:400},Yx=function(e){return Object(Vv.y)("&-enter{transform:translateY(100%);}&-enter-active{transform:translateY(0);transition:transform ",600*e,"ms ","cubic-bezier(0.14, 0, 0, 1)",";}&-exit{transform:translateY(0);}&-exit-active,&-exit-done{transform:translateY(100%);transition:transform ",400*e,"ms ","cubic-bezier(0.14, 0, 0, 1)",";}")},Jx=function(e){var t=e.show,n=e.durationFactor,r=e.onTransitionStart,a=e.onTransitionEnd,i=e.children;return Zt.createElement(cb.a,{component:null},t&&Zt.createElement(mb.a,{timeout:Wx,onExited:a,onEntered:a,onExiting:r,onEntering:r,classNames:Yx(n)},i))},Kx=function(e){return Object(Vv.y)("position:absolute;z-index:1500;display:flex;flex-direction:column;height:",100*e,"%;min-height:270px;max-height:100%;width:100%;bottom:0;background-color:#fff;border-radius:inherit;color:#424d57;")},Qx=function(e){var t=e.heightPercentage,n=Object(w.a)(e,["heightPercentage"]),r=Zt.useRef(null);return ng("touchmove",r),Zt.createElement("div",Object(C.a)({ref:r,className:Kx(t)},n))},Zx={allowtransparency:"true",scrolling:"yes",style:{position:"absolute",minWidth:"100%",minHeight:"100%",height:"1px",width:"1px",margin:"0",padding:"0",background:"none",border:"0"}},Xx=function(e){if(e){var t=e.scrollTop,n=e.scrollHeight-e.offsetHeight;0===t?e.scrollTop=1:t===n&&(e.scrollTop=n-1)}},$x=function(e){return{moment_url:Object(I.d)(e)+Object(I.e)(e),moment_origin:Object(I.d)(e)||""}},e_=function(e){var t=e.hidden;return Object(Vv.y)("flex-grow:1;position:relative;overflow:auto;-webkit-overflow-scrolling:touch;display:",t?"none":"block",";")},t_=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).sdk=void 0,t.containerRef=Zt.createRef(),t.handleIFrameLoad=function(){t.sdk&&(t.props.onLoadingChanged(!1),t.sdk.frame.removeEventListener("load",t.handleIFrameLoad))},t.handleScroll=function(e){Xx(e.currentTarget)},t}Object(Fv.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.url,n=e.close,r=e.sendMessage,a=e.setAttributes,i=e.onLoadingChanged,o=e.onMomentDataChanged;t&&this.containerRef.current&&(this.sdk=Object(Pa.b)({url:t,container:this.containerRef.current,onConnected:function(e){var t=e.data;i(!1),o(t)}},{close:n,sendMessage:r,setAttributes:a}),Object(Ai.a)(Zx,this.sdk.frame),i(!0),this.sdk.frame.addEventListener("load",this.handleIFrameLoad),o({title:this.sdk.title}),cr("moment_opened",$x(Object(Pa.a)(t))))},n.componentWillUnmount=function(){var e=this.props,t=e.onMomentDataChanged,n=e.onLoadingChanged;this.sdk&&(this.sdk.destroy(),t(null),n(!1));var r=this.props.url;r&&cr("moment_closed",$x(Object(Pa.a)(r)))},n.render=function(){return Zt.createElement("div",{ref:this.containerRef,className:e_(this.props),onScroll:this.handleScroll})},t}(Zt.Component),n_=Object(Vv.C)("div",{target:"ekjkgns0"})("flex-grow:1;flex-basis:100%;font-weight:700;font-size:14px;margin:0 8px;"),r_=Object(Vv.C)(Vv.q,{target:"e11d7cwf0"})("border-bottom:1px solid #dde2e6;padding:0 0.8em;height:48px;display:flex;align-items:center;"),a_=n(219),i_=n.n(a_),o_=Object(Vv.C)("div",{target:"e96px410"})("flex-shrink:0;width:24px;height:24px;border-radius:5px;overflow:hidden;"),c_=Object(Vv.C)("img",{target:"e96px411"})("width:100%;height:100%;"),s_=function(e){var t=e.src;return Zt.createElement(o_,null,Zt.createElement(c_,{src:t||i_.a}))},u_=Object(Vv.C)(r_,{target:"e1xkjcv70"})("border-bottom:0;"),l_=Object(Vv.C)("div",{displayName:"BoosterContainer",target:"e1xkjcv71"})("width:100%;display:flex;max-width:",(function(e){return e.single?"270px":"240px"}),";"),d_=Object(Vv.C)("div",{target:"e1xkjcv72"})("padding:0 0.8em 0.8em 0.8em;"),p_=Object(Vv.C)(KO,{target:"e1xkjcv73"})("flex-grow:1;max-width:100%;flex-basis:100%;"),f_=Object(Vv.C)("div",{target:"e1xkjcv74"})("margin-bottom:1.2em;-webkit-line-clamp:3;-webkit-box-orient:vertical;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;",(function(e){return e.theme.typography.basic})),m_=Object(Vv.C)(kj,{displayName:"BoosterButton",target:"e1xkjcv75"})("background-color:#eaeaea;color:#111;"),h_=function(e){var t=e.id,n=e.icon,r=e.title,a=e.description,i=e.onButtonClick,o=e.action,c=e.single,s=void 0!==c&&c;return Zt.createElement(l_,{single:s},Zt.createElement(p_,null,Zt.createElement(u_,null,Zt.createElement(s_,{src:n}),Zt.createElement(n_,{ellipsis:!0,flexFill:!0},r)),Zt.createElement(d_,null,Zt.createElement(f_,null,Zt.createElement(gc,{preserveLists:!0,template:a,root:{component:Hj.a,props:{component:Jj}}})),Zt.createElement(m_,{ellipsis:!0,onClick:function(){return i(t)}},o.label))))},v_=Object(Vv.C)("div",{target:"e1ndqyd80"})("padding-top:0.8em;width:100%;display:flex;justify-content:center;flex-grow:1;"),g_=Qt((function(e){var t=function(t){return e.emit("on_chat_booster_launched",t)};return function(){return{emitBoosterLaunched:t}}}))((function(e){var t=e.boosters,n=e.setScrollTargetNode,r=e.showMoment,a=e.emitBoosterLaunched,i=Zt.useRef(null);vg((function(){i.current&&n&&n(i.current)}));var o=function(e){var n=t.find((function(t){return t.id===e}));if(n){var i=n.icon,o=n.title,c=n.action,s=c.url,u=c.webviewHeight,l=void 0===u?"full":u;a({id:e,title:o}),r({icon:i,title:o,height:l,url:s+"?moment-title="+encodeURIComponent(o)})}};return Zt.createElement(v_,{innerRef:i},1===t.length?Zt.createElement(h_,Object(C.a)({},t[0],{single:!0,onButtonClick:o})):Zt.createElement(Vv.e,null,t.map((function(e){return Zt.createElement(h_,Object(C.a)({},e,{key:e.id,onButtonClick:o}))}))))})),b_=Object(Rb.b)((function(e){var t,n,r=e.theme,a=Object(w.a)(e,["theme"]);return"modern"===r.name&&(t=150,n=250),Zt.createElement(UO,Object(C.a)({maxWidth:t,maxHeight:n},a))})),y_=function(e){return Zt.createElement("svg",Object(C.a)({viewBox:"0 0 32 32",width:"32",height:"32"},e,{className:Object(Vv.y)("*{animation-duration:2s;animation-iteration-count:infinite;animation-timing-function:cubic-bezier(0,0,1,1);}")}),Zt.createElement("g",{className:Object(Vv.y)("fill:none;transform:translate(16px,16px) rotate(0deg) translate(-16px,-16px);animation-fill-mode:backwards;animation-timing-function:cubic-bezier(0,0,1,1);animation-name:",Object(Vv.B)("75%{transform:translate(16px,16px) rotate(0deg) translate(-16px,-16px);}91.67%{transform:translate(16px,16px) rotate(180deg) translate(-16px,-16px);}0%{transform:translate(16px,16px) rotate(0deg) translate(-16px,-16px);}100%{transform:translate(16px,16px) rotate(180deg) translate(-16px,-16px);}"),";")},Zt.createElement("path",{d:"M22,22 L22,26 L10,26 L10,22 L16,16 L22,22 Z M22,10 L16,16 L10,10 L10,6 L22,6 L22,10 Z",strokeLinejoin:"round",className:Object(Vv.y)("stroke:currentColor;stroke-width:2;")})),Zt.createElement("g",{className:Object(Vv.y)("transform:translate(16px,15px) scale(1,1) translate(-16px,-15px);animation-fill-mode:backwards;animation-name:",Object(Vv.B)("0%{transform:translate(16px,15px) scale(1,1) translate(-16px,-15px);}61.67%{transform:translate(16px,15px) scale(0,0) translate(-16px,-15px);}63.33%{transform:translate(16px,15px) scale(1,1) translate(-16px,-15px);}100%{transform:translate(16px,15px) scale(1,1) translate(-16px,-15px);}"),";animation-timing-function:cubic-bezier(0.42,0,1,1);")},Zt.createElement("polygon",{points:"12 11 20 11 16 15",className:Object(Vv.y)("fill:currentColor;opacity:1;animation-fill-mode:backwards;animation-timing-function:cubic-bezier(0,0,1,1);animation-name:",Object(Vv.B)("58.33%{opacity:1;}60%{opacity:0;}91.67%{opacity:0;}96.67%{opacity:1;}0%{opacity:1;}100%{opacity:1;}"),";")})),Zt.createElement("path",{d:"M16,17 L16,23",className:Object(Vv.y)("stroke:currentColor;stroke-width:2;stroke-dashoffset:12;stroke-dasharray:6,0,6,6;animation-fill-mode:backwards,backwards;animation-timing-function:cubic-bezier(0.42,0,1,1),cubic-bezier(0,0,1,1);animation-name:",Object(Vv.B)("0%{stroke-dashoffset:12;}68.33%{stroke-dashoffset:-6;}100%{stroke-dashoffset:-6;}"),",",Object(Vv.B)("0%{stroke-dasharray:6,0,6,6;}100%{stroke-dasharray:6,0,6,6;}"),";")}),Zt.createElement("g",{className:Object(Vv.y)("transform:translate(16px,24px) translate(-16px,-24px) translate(0px,2px);animation-fill-mode:backwards;animation-timing-function:cubic-bezier(0,0,1,1);animation-name:",Object(Vv.B)("0%{transform:translate(16px,24px) translate(-16px,-24px) translate(0px,2px);}40%{transform:translate(16px,24px) translate(-16px,-24px) translate(0px,0px);}75%{transform:translate(16px,24px) translate(-16px,-24px) translate(0px,0px);}76.67%{transform:translate(16px,24px) translate(-16px,-24px) translate(-2px,0px);}78.33%{transform:translate(16px,24px) translate(-16px,-24px) translate(-4px,-1px);}81.67%{transform:translate(16px,24px) translate(-16px,-24px) translate(-8px,-6px);}83.33%{transform:translate(16px,24px) translate(-16px,-24px) translate(-8px,-8px);}85%{transform:translate(16px,24px) translate(-16px,-24px) translate(-8px,-11px);}88.33%{transform:translate(16px,24px) translate(-16px,-24px) translate(-4px,-13px);}91.67%{transform:translate(16px,24px) translate(-16px,-24px) translate(0px,-13px);}96.67%{transform:translate(16px,24px) translate(-16px,-24px) translate(0px,-11px);}100%{transform:translate(16px,24px) translate(-16px,-24px) translate(0px,-11px);}"),";")},Zt.createElement("g",{className:Object(Vv.y)("transform:translate(16px,24px) rotate(0deg) translate(-16px,-24px);animation-fill-mode:backwards;animation-timing-function:cubic-bezier(0,0,1,1);animation-name:",Object(Vv.B)("75%{transform:translate(16px,24px) rotate(0deg) translate(-16px,-24px);}78.33%{transform:translate(16px,24px) rotate(36deg) translate(-16px,-24px);}83.33%{transform:translate(16px,24px) rotate(90deg) translate(-16px,-24px);}91.67%{transform:translate(16px,24px) rotate(180deg) translate(-16px,-24px);}0%{transform:translate(16px,24px) rotate(0deg) translate(-16px,-24px);}100%{transform:translate(16px,24px) rotate(180deg) translate(-16px,-24px);}"),";")},Zt.createElement("g",{className:Object(Vv.y)("transform:translate(16px,24px) scale(1,1) translate(-16px,-24px);animation-fill-mode:backwards;animation-timing-function:cubic-bezier(0,0,1,1);animation-name:",Object(Vv.B)("0%{transform:translate(16px,24px) scale(1,1) translate(-16px,-24px);}40%{transform:translate(16px,24px) scale(1,1.4) translate(-16px,-24px);}68.33%{transform:translate(16px,24px) scale(1,1.6) translate(-16px,-24px);}86.67%{transform:translate(16px,24px) scale(1,1.6) translate(-16px,-24px);}88.33%{transform:translate(16px,24px) scale(1,1.4) translate(-16px,-24px);}91.67%{transform:translate(16px,24px) scale(0.8,1.3) translate(-16px,-24px);}96.67%{transform:translate(16px,24px) scale(0.45,1.6) translate(-16px,-24px);}100%{transform:translate(16px,24px) scale(0.45,1.6) translate(-16px,-24px);}"),";")},Zt.createElement("rect",{x:"10",y:"23",width:"12",height:"2",className:Object(Vv.y)("fill:currentColor;opacity:1;animation-fill-mode:backwards;animation-timing-function:cubic-bezier(0,0,1,1);animation-name:",Object(Vv.B)("75%{opacity:1;}0%{opacity:1;}100%{opacity:1;}"),";")})))))},j_=Object(Vv.C)("div",{target:"e1v4xcti0"})("font-size:14px;color:#424d57;a{color:inherit;}ul,ol{margin:8px 0;padding-left:24px;}"),O_=Qt((function(e,t){var n=t.chatId;return function(e){var t=e.getEvent(n,"queue_information").properties;return Object(C.a)({},t,{template:Rn(e)})}}))(Object(Rb.b)((function(e){var t=e.theme,n=e.template,r=e.numberInQueue,a=e.waitingTime,i=e.onTemplateLoaded,o=Object(Zv.a)(i);if(Zt.useEffect((function(){n&&o.current()}),[n,o]),!n)return null;var c=n.replace("%number%","**"+r+"**").replace("%minutes%","**"+Math.floor(a/60)+"**");return Zt.createElement(ox,{icon:Zt.createElement($O,{backgroundColor:t.colors.cta},Zt.createElement(y_,{color:"#ffffff"}))},Zt.createElement(j_,{preserveLines:!0},Zt.createElement(gc,{template:c,root:{component:Hj.a,props:{component:Jj}}})))}))),x_=Object(Vv.C)("div",{target:"exztlxx0"})("a{color:inherit;}ul,ol{margin:8px 0;padding-left:24px;}",(function(e){return e.theme.typography.basic})),__=Object(Vv.C)("div",{target:"exztlxx1"})("position:absolute;top:0;right:calc(50% - 21px);width:14px;height:14px;border-radius:50%;border:2px solid white;background-color:#a5a7a9;"),C_=Object(Rb.b)((function(e){var t=e.theme.colors;return Zt.createElement(rn,null,(function(e){return Zt.createElement(ox,{icon:Zt.createElement($O,{backgroundColor:t.visitorMessageBackground},Zt.createElement(__,null),Zt.createElement(Hg,{color:t.visitorMessageText}))},Zt.createElement(x_,null,Zt.createElement(gc,{template:e("agents_not_available"),root:{component:Hj.a,props:{component:Jj}}})))}))})),w_=["message","webview"],E_=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={shouldHandleSeen:!t.props.event.own&&!t.props.event.seen},t.handleSeen=function(){t.setState({shouldHandleSeen:!1}),t.props.listItemHandlers.markAsSeen(t.props.id)},t.getCardDisabledButtons=function(){var e=t.props,n=e.isChatActive,r=e.isPartOfActiveThread;return n&&r?[]:w_},t}return Object(Fv.a)(t,e),t.getDerivedStateFromProps=function(e,t){return t.shouldHandleSeen&&e.event.seen?{shouldHandleSeen:!1}:null},t.prototype.render=function(){var e,t=this,n=this.props,r=n.author,a=n.deliveryStatus,i=n.event,o=n.listItemHandlers,c=n.radiusType,s=n.showMetaOnClick,u=n.chatId,l=n.setScrollTargetNode,d=n.scrollTarget,p=n.localize,f=n.showMoment,m=n.mobile,h=n.scrollToBottomIfNeeded,v="system"===r.type,g=this.state.shouldHandleSeen;if("system_message"===i.type){var b=i.properties,y=b.systemMessageType,j=b.textVariables,O=b.defaultText;return Zt.createElement(WO,null,y?p(y,j):O)}return"email_prompt"===i.type?Zt.createElement(mx,{id:i.id,chatId:u}):"form"===i.type?Zt.createElement(Hx,{id:i.id,chatId:u,form:i,setScrollTargetNode:"form"===d&&l}):"boosters"===i.type?Zt.createElement(g_,{boosters:i.properties.boosters,showMoment:f,setScrollTargetNode:"boosters"===d&&l}):"queue_information"===i.type?Zt.createElement(O_,{chatId:u,onTemplateLoaded:h}):"offline_information"===i.type?Zt.createElement(C_,null):Zt.createElement(Vv.i,{authorName:i.own&&!r.name?p("client"):r.name,date:v?"":(e=i.timestamp,new Date(e).toTimeString().substr(0,5)),deliveryStatus:a,failed:i.failed,isOwn:i.own,onSeen:this.handleSeen,seen:!g,sending:!i.delivered&&!i.failed,showMetaOnClick:!v&&s,system:v},"carousel"===i.type&&Zt.createElement(Vv.e,{mobile:m},i.properties.cards.map((function(e,n){return Zt.createElement(AO,{key:n,card:e,eventId:i.id,disabledButtons:t.getCardDisabledButtons(),onActionButtonClick:o.handleActionButtonClick})}))),"message"===i.type&&Zt.createElement(RO,Object(C.a)({},i.properties,{radiusType:c})),"image_preview"===i.type&&Zt.createElement(b_,i.properties),"emoji"===i.type&&Zt.createElement(JO,{emoji:i,radiusType:c}),"rich_message"===i.type&&Zt.createElement(AO,{eventId:i.id,card:i.properties.card,radiusType:c,disabledButtons:this.getCardDisabledButtons(),onActionButtonClick:o.handleActionButtonClick}),"sticker"===i.type&&Zt.createElement(HO,i.properties),"url_preview"===i.type&&Zt.createElement(FO,{radiusType:c,urlPreview:i}))},t}(Zt.Component),I_=Qt((function(e,t){var n=t.chatId,r=t.id,a=t.showMoment;return function(e,t){var n;return function(r){var a=e(r);if(void 0===a)return n;var i=t(r,a);return n=i,i}}((function(e){return e.getEvent(n,r)}),(function(e,t){var i=e.getChat(n),o=i.properties.lastThread;return{event:t,isChatActive:i.active,isPartOfActiveThread:o===t.thread,deliveryStatus:vn(e,n,r),author:e.getUser(t.author),chatId:n,localize:e.localize,showMoment:a,mobile:e.getApplicationState("mobile")}}))}))(E_),S_=Object(Vv.C)(Vv.p,{target:"e1owdcs60"})("font-family:'Noto Sans';font-size:0.9em;",(function(e){var t=e.theme;return Object(Vv.y)("color:",t.colors.cta,";border-color:",t.colors.cta,";")})),k_=function(e){return e.stopPropagation()},T_=function(e,t,n){return function(r){e({button:n[r],event:t})}},A_=function(e){var t=e.eventId,n=e.replies,r=e.onSelect;return Zt.createElement(Vv.o,{onSelect:T_(r,t,n)},n.map((function(e,t){var n=e.text;return Zt.createElement(S_,{key:t,onClick:k_,value:t},n)})))},P_=Object(Vv.y)("font-family:inherit;"),N_=Object(Vv.y)("padding:0;svg *{transition:fill 100ms ease-in-out;}"),M_=Object(Vv.C)("input",{target:"e10ozmh70"})("display:none;"),z_=Object(Vv.C)("label",{target:"e10ozmh71"})("cursor:pointer;display:flex;align-items:center;color:","#424d57",";");var R_=Qt((function(e,t){var n=t.chatId,r=function(t){return e.sendEvent(n,{type:"file",properties:{name:t.name}},{file:t})},a=function(t){ni(e,n,t)},i=function(t){e.requestUpdateChat(n,{properties:{messageDraft:t}})};return function(e){return{sendFile:r,sendMessage:a,setMessageDraft:i,reconnecting:In(e),allowInput:Zn(e),allowFileUpload:Qn(e),mobile:e.getApplicationState("mobile"),applicationFocused:e.getApplicationState("applicationFocused")}}}))((function(e){var t=e.allowFileUpload,n=e.mobile,r=e.onHeightChange,a=e.onSendMessage,i=e.allowInput,o=e.reconnecting,c=e.sendFile,s=e.sendMessage,u=e.setMessageDraft,l=(e.applicationFocused,e.onFocusChange),d=Object(w.a)(e,["allowFileUpload","mobile","onHeightChange","onSendMessage","allowInput","reconnecting","sendFile","sendMessage","setMessageDraft","applicationFocused","onFocusChange"]),p=Zt.useMemo((function(){return Object(x.mb)(1500,u)}),[u]),f=Zt.useCallback((function(){l&&l(!0)}),[l]),m=Zt.useCallback((function(){l&&l(!1)}),[l]),h=Zt.useCallback((function(e){s(e),a&&a()}),[s,a]),v=Zt.useCallback((function(e){[].forEach.call(e.target.files,c)}),[c]);return Zt.createElement(rn,null,(function(e){return Zt.createElement(Vv.t,Object(C.a)({},d,{active:i,disabled:o,mobile:n,onSend:h,onValueChange:p}),Zt.createElement(Vv.q,{align:"center"},Zt.createElement(Vv.u,{autoFocus:qj(n),className:P_,disabled:o,flexFill:!0,minRows:2,onBlur:m,onFocus:f,onHeightChange:r,placeholder:e("embedded_textarea_placeholder")}),t&&i&&Zt.createElement(z_,{flexFit:!0},Zt.createElement(Tg,{color:"#aaa"}),Zt.createElement(M_,{multiple:!0,onChange:v,type:"file",value:""})),Zt.createElement(Vv.r,{flexFit:!0,className:N_,icon:Zt.createElement(Wg,null)})))}))})),D_={full:.8,tall:.5,compact:.3},L_=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={isAnimating:!1,isMomentLoading:!1,momentData:{}},t.getHeightPercentage=function(){var e=t.state.momentData.height;return e&&e in D_?D_[e]:D_.tall},t.handleSendMessage=function(e){var n=e.text,r=t.props,a=r.sendMessage,i=r.onSendMessage;a(n),i&&i(n)},t.handleTransitionStart=function(){t.setState({isAnimating:!0})},t.handleTransitionEnd=function(){t.setState({isAnimating:!1})},t.handleMomentLoadingChanged=function(e){t.setState({isMomentLoading:e})},t.handleMomentDataChanged=function(e){t.setState((function(t){return{momentData:e?Object(C.a)({},t.momentData,e):{}}}))},t}return Object(Fv.a)(t,e),t.getDerivedStateFromProps=function(e,t){return Object.keys(t.momentData).length>0?t:Object(C.a)({},t,{momentData:Object(C.a)({},e.momentData)})},t.prototype.render=function(){var e=this.state,t=e.momentData,n=e.isAnimating,r=e.isMomentLoading,a=this.props,i=a.show,o=a.closeMoment,c=a.updateSessionUser,s=n||r,u=this.getHeightPercentage();return Zt.createElement(yy,null,Zt.createElement(Cy,{shown:i}),Zt.createElement(Jx,{show:i,onTransitionEnd:this.handleTransitionEnd,onTransitionStart:this.handleTransitionStart,durationFactor:u/.8},Zt.createElement(Qx,{heightPercentage:u},Zt.createElement(r_,{noShrink:!0},Zt.createElement(s_,{src:t.icon}),Zt.createElement(n_,{ellipsis:!0,flexFill:!0},t.title),Zt.createElement(Bg,{flexFit:!0,onClick:o},Zt.createElement(zg,null))),Zt.createElement(t_,{hidden:s,close:o,url:t.url,setAttributes:c,sendMessage:this.handleSendMessage,onMomentDataChanged:this.handleMomentDataChanged,onLoadingChanged:this.handleMomentLoadingChanged}),s&&Zt.createElement(wj,{size:"xlarge",style:{margin:"auto"}}))))},t}(Zt.Component),B_=Qt((function(e,t){var n=t.chatId,r=function(){return gi(e)},a=function(t){return bi(e,{properties:t})},i=function(t){return ni(e,n,t)};return function(e){var t=e.getView("Moment"),n=t.show,o=t.data;return{show:n,closeMoment:r,sendMessage:i,updateSessionUser:a,momentData:o}}}))(L_),q_=!!document.documentElement.currentStyle,U_=Object(Vv.C)("div",{target:"e1oq7ugp0"})("background-color:#dde2e6;width:100%;height:3px;margin-top:-3px;border-radius:1.5px;overflow:hidden;"),F_=Object(Vv.C)("div",{target:"e1oq7ugp1"})("background-color:",(function(e){return e.theme.colors.cta}),";width:",(function(e){return(100*e.progress).toFixed(2)}),"%;height:100%;transition:width 150ms ease;"),V_=Object(Vv.C)("span",{target:"e1oq7ugp2"})((function(e){var t=e.failed,n=e.finished,r=e.theme;return{color:t?r.typography.errorCaption.color:r.typography.basic.color,marginBottom:n?"0":"5px"}}),";transition:margin-bottom 500ms linear ",500,"ms;"),G_=Object(Vv.C)("span",{target:"e1oq7ugp3"})((function(e){return e.theme.typography.errorCaption})),H_=Object(Vv.C)("div",{target:"e1oq7ugp4"})("display:flex;overflow:hidden;flex-direction:column;justify-content:center;transition:all 2s linear;margin:4px 0;"),W_=Object(Vv.y)("justify-content:center;"),Y_=Object(Vv.y)("min-width:24px;flex-shrink:0;"),J_=function(e){var t,n=e.name,r=e.progress,a=void 0===r?0:r,i=e.failed,o=e.finished,c=e.failReason,s=e.onCancel,u=Zt.useState(o),l=u[0],d=u[1],p=Zt.useCallback((function(){d(!0)}),[]),f=q_?Qg:Sg;return Zt.createElement(Vv.q,null,Zt.createElement(Vv.g,{className:Object(Vv.z)(W_,(t=o,Object(Vv.y)("flex-shrink:0;width:",t?"30px":"0",";overflow:hidden;transition:width 200ms linear ",500,"ms;")))},l&&(i?Zt.createElement(Ng,{color:"#eb4736",size:24}):Zt.createElement(f,{color:"#08d710",size:24}))),Zt.createElement(H_,{flexFill:!0},Zt.createElement(V_,{ellipsis:!0,failed:i,finished:o},n),Zt.createElement(cb.a,{component:null},!o&&Zt.createElement(Ob,{transitionDuration:500,onTransitionEnd:p},Zt.createElement(U_,null,Zt.createElement(F_,{progress:a})))),c&&Zt.createElement(G_,{ellipsis:!0},c)),Zt.createElement(Vv.g,{className:Object(Vv.z)(W_,Y_)},i&&Zt.createElement($g,{onClick:s,"aria-label":"Cancel upload"})))},K_=Object(Vv.C)("span",{target:"e1k6tlos0"})("padding:0 6px;align-self:center;",(function(e){var t=e.failed,n=e.theme;return t&&{color:n.typography.errorCaption.color}})),Q_=Object(Vv.C)("div",{target:"e1k6tlos1"})("display:flex;cursor:pointer;"),Z_=Object(Vv.C)("div",{target:"e1k6tlos2"})("overflow:auto;max-height:",105,"px;padding-right:12px;"),X_=Object(Vv.C)("hr",{target:"e1k6tlos3"})("border:0;border-bottom:1px solid rgba(0,0,0,0.1);margin:",8,"px -",8,"px 0;"),$_=Object(Vv.C)(Mg,{target:"e1k6tlos4"})((function(e){return"up"===e.direction&&{transform:"scaleY(-1)"}})),eC=function(e){return Object(Vv.y)("padding:",8,"px;overflow:hidden;",e.typography.basic)},tC=Object(Vv.y)("width:0;opacity:0;transition:width 200ms linear,opacity 200ms ease-out;"),nC=Object(Vv.y)("padding-left:4px;"),rC=Object(Rb.b)((function(e){var t=e.uploadEventList,n=e.cancelUpload,r=e.localize,a=e.theme,i=Zt.useState(!1),o=i[0],c=i[1],s=Zt.useCallback((function(){return c((function(e){return!e}))}),[]),u=Zt.useState(0),l=u[0],d=u[1],p=Zt.useRef(null);Zt.useEffect((function(){null!==p.current&&d(Math.min(p.current.scrollHeight,105))}));var f=t.filter((function(e){return e.finished})).length,m=t.filter((function(e){return e.failed})).length,h=t.length,v=f===h,g=m>1?r("files_failed_to_upload").replace("%files%",m.toString()):r("upload_failed"),b=f-m+"/"+h+" "+r("uploading");return Zt.createElement(eb,{className:eC(a)},Zt.createElement(Q_,{onClick:s},Zt.createElement(wj,{size:"medium",className:Object(Vv.z)(v&&tC)}),Zt.createElement(K_,{flexFill:!0,ellipsis:!0,failed:v&&m>0},v&&m>0?g:b),v&&m>0&&Zt.createElement($g,{buttonSize:24,onClick:function(e){e.stopPropagation(),t.forEach((function(e){return e.failed&&n(e.id)}))}}),Zt.createElement(Bg,{className:nC,"aria-label":"Toggle upload list"},Zt.createElement(qg,{size:24},Zt.createElement($_,{direction:o?"down":"up",size:24})))),o&&Zt.createElement(X_,null),Zt.createElement(cb.a,{component:null},o&&Zt.createElement(_b,{contentHeight:l},Zt.createElement(Z_,{innerRef:p},t.map((function(e){return Zt.createElement(J_,Object(C.a)({key:e.id},e,{failed:!!e.failed,onCancel:function(){n(e.id)}}))}))))))})),aC=function(e){var t=e.properties;return{id:e.id,name:t.name,progress:t.progress,failed:t.failed,failReason:t.failReason,finished:t.failed||t.progress>=1}},iC=Qt((function(e,t){var n=t.chatId,r=[],a=[],i=function(t){var i=Object(x.l)((function(e){return e.id===t}),r);-1!==i&&(a.push(r[i]),r=Object(x.cb)(i,r)),e.updateEvent(n,t,{properties:{canceled:!0}})};return function(t){var o=e.getView("uploadList").ids;return r=o.map((function(e){return t.getEvent(n,e)})).filter(Boolean).map(aC).reduce((function(e,t){if(-1!==Object(x.l)((function(e){return e.id===t.id}),a))return e;var n=Object(x.l)((function(e){return e.id===t.id}),e);return-1!==n?e[n]=t:e.push(t),e}),[].concat(r)),{localize:t.localize,uploadEventList:r,cancelUpload:i}}}))(rC),oC=Object(Vv.C)("div",{target:"ezpiwsd0"})("position:absolute;bottom:0;left:0;right:0;z-index:100;"),cC=Qt((function(e,t){var n=t.markAsSeen,r=function(){hn("liveChatChatId",Date.now(),e).forEach((function(e){return n(e.id)}))};return function(e){var t=e.getView("uploadList").ids,n=e.getApplicationState("mobile"),a=function(e,t){return Object(x.n)((function(e){return!e.own&&Object(x.z)(e.type,["message","rich_message","url_preview","emoji"])}),e.getEvents(t))}(e,"liveChatChatId"),i=e.getUnseenCount("liveChatChatId"),o=a&&a.properties?a.properties.text:null;return{isUploadingFiles:t.length>0,previewText:o,unseenCount:i,mobile:n,markAllEventsAsSeen:r}}}))((function(e){var t=e.isUploadingFiles,n=e.previewText,r=e.unseenCount,a=e.chatId,i=e.mobile,o=e.scrollToBottom,c=e.markAllEventsAsSeen,s=e.isOnBottomSource,u=e.isScrollable,l=ug(s),d=r>0&&!l&&u,p=Zt.useState(d),f=p[0],m=p[1];return!d&&f&&m(!1),Zt.useEffect((function(){if(d){var e=setTimeout((function(){return m(!0)}),300);return function(){return clearTimeout(e)}}}),[d]),Zt.createElement(rn,null,(function(e){return Zt.createElement(oC,null,Zt.createElement(cb.a,{appear:!0,component:null},t&&Zt.createElement(gb,{key:"upload"},Zt.createElement(iC,{chatId:a})),f&&Zt.createElement(gb,{key:"unseen"},Zt.createElement(ib,{text:n||e(r>1?"new_messages":"new_message"),stickToEdge:i,unseenCount:r,onClick:o,onClose:c}))))}))})),sC=Object(Rb.b)((function(e){var t=e.theme,n=Object(w.a)(e,["theme"]),r=t.Maximized.css.background;return Zt.createElement(wj,Object(C.a)({},n,{adjustToColor:r}))})),uC=Object(Vv.C)("div",{target:"e19q3r3b0"})("padding:1em;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:0.9em;"),lC=function(e){return Zt.createElement(uC,null,Zt.createElement(kj,e))},dC=Qt((function(e){var t=function(){var t;(t=e).updateChat("liveChatChatId",{properties:{startChatAgainPending:!0}}),Fn(t)&&Ii(t)};return function(e){return{isPending:e.getChat("liveChatChatId").properties.startChatAgainPending,startChatAgain:t,localize:e.localize}}}))((function(e){var t=e.onClick,n=void 0===t?x.P:t,r=e.localize,a=e.isPending,i=e.startChatAgain;return Zt.createElement(lC,{disabled:a,pending:a,onClick:function(e){i(),n(e)}},r("embedded_start_chat_again"))})),pC=Object(Vv.C)("div",{target:"e1onopp20"})("position:absolute;top:0;left:0;right:0;background:#f5a623;z-index:2;color:#fff;text-align:center;font-size:0.9em;line-height:2.8em;"),fC=Object(Vv.C)("div",{target:"e1onopp21"})("flex-grow:1;height:100%;position:relative;min-height:0;-webkit-overflow-scrolling:touch;"),mC=Object(Vv.y)("background:transparent;overscroll-behavior:contain;position:absolute;top:0;bottom:0;left:0;right:0;"),hC=Object(Vv.y)("position:absolute;bottom:0;left:50%;z-index:3;transform:translate(-50%,50%);"),vC=function(e){return e.events[0].id},gC=function(e){return 0!==e.length?vC(e[0]):null},bC=function(e){var t=Object(x.G)(e);if(!t)return null;var n=Object(x.G)(t.events);return n?n.id:null},yC=function(e){var t=Zt.useRef(e);return Zt.useEffect((function(){t.current=e})),Zt.useMemo((function(){return{handleActionButtonClick:function(e){var n=e.button,r=e.event,a=t.current,i=a.active,o=a.showMoment,c=a.sendPostback,s=a.sendMessage;if(i)switch(n.type){case"webview":return c(r,n.postback),void o({url:n.value,height:n.webviewHeight});case"message":return void s(n.text,{type:"action_button",event:r,button:n});default:return void c(r,n.postback)}},markAsSeen:function(e){return t.current.markAsSeen(e)}}}),[])},jC=function(e,t,n,r){return t?"newMessageDivider":r||n||!e.some((function(e){return e.events.some((function(e){return"boosters"===e.type}))}))?"form":"boosters"};var OC=Object($.a)([function(e,t){return e.getTimeline(t)},x.y],(function(e,t){var n=pn(t);return e.map((function(e,r){var a=0===r,i=e.showDate&&!a&&n;return Object(C.a)({},e,{isThreadBoundary:i,authorData:t.getUser(e.author)})}))}))((function(e,t){return t})),xC=Qt((function(e,t){var n=t.id,r=function(){ai(e)},a=e.localize,i=function(){return e.updateChat(n,{properties:{loadingHistory:!0}})},o=function(t){return e.requestUpdateEvent(n,t,{seen:!0}).catch(x.P)},c=function(t,r){ni(e,n,t,r)},s=function(t,r){e.sendEvent(n,{type:"rich_message_postback",properties:{eventId:t,id:r,toggled:!0}})},u=function(t){return hi(e,t)},l=function(t){return bi(e,{properties:t})};return function(e){var t=e.getChat(n),d=t.active,p=t.properties,f=p.agentIsTyping,m=p.loadingHistory,h=p.queued,v=p.ended,g=un(n,e),b=yn(e,n),y=e.getUnseenCount(n),j=pn(e)&&function(e){return!!e.getView("Chat").liveChatChatId.hasDividers}(e);return{agent:g,active:d,ended:v,loadHistory:i,isThreadStickerEnabled:j,hasMoreHistory:b,markAsSeen:o,sendMessage:c,queued:h,sendPostback:s,showPrechat:r,localize:a,updateSessionUser:l,showMoment:u,unseenCount:y,timeline:OC(e,n,e.getState()),activeQuickReply:Sn(n,e),agentIsTyping:f&&!!g,shouldLoadHistory:b&&!m,showAvatar:ln("agentAvatar",e).showWithMessage,pageFocused:e.getApplicationState("pageFocused"),inputMode:Tn(e,n),reconnecting:In(e),displayOfflineInformation:Fn(e),lastSeenEvent:y>0&&e.getLastSeenAgentEvent(n)}}}))((function(e){var t=e.displayOfflineInformation,n=e.active,r=e.ended,a=e.activeQuickReply,i=e.agent,o=e.isThreadStickerEnabled,c=e.hasMoreHistory,s=e.pageFocused,u=e.id,l=e.inputMode,d=e.loadHistory,p=e.localize,f=e.queued,m=e.reconnecting,h=e.shouldLoadHistory,v=e.showAvatar,g=e.showPrechat,b=e.timeline,y=e.agentIsTyping,j=e.mobile,O=e.unseenCount,_=e.lastSeenEvent,C=e.scrollingDeltaSource,w=e.sendMessage,E=e.showMoment,I=Zt.useRef(),S=sg(!0),k=sg(!1),T=yC(e),A=Zt.useRef(!1),P=Zt.useState(O),N=P[0],M=P[1],z=Zt.useState(_)[0],R=Object(Qv.a)((function(){return jC(b,N,n,r)})),D=Zt.useCallback((function(e){e&&h&&d()}),[h,d]),L=hg(I,{firstItemKey:gC(b),lastItemKey:bC(b),onIsScrolledToTopChanged:D,onIsScrolledToBottomChanged:S.next,onIsUserScrollingChanged:k.next,onScrollDeltaChanged:C.next}),B=L.scrollToBottom,q=L.getIsOnBottom,U=L.onWheel,F=L.onTouchStart,V=L.getIsScrollable,G=L.setScrollTargetNode,H=Zt.useCallback((function(e){q()&&B(e)}),[q,B]),W=Zt.useCallback((function(){H({duration:0})}),[H]),Y=function(e){return void 0===e&&(e=x.P),function(){B({duration:0}),e()}},J=lg((function(){q()?B():B({duration:0}),M(0)})),K=Zt.useCallback((function(e){A.current=e}),[]),Q=!!(y||f||a||t);return Zt.useEffect((function(){Q&&H()}),[Q,H]),Zt.useEffect((function(){if(j){var e=function(){A.current&&B({duration:0})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}}),[j,B]),Zt.createElement(ry,{beginingOfTime:b.length>0?b[0].timestamp:null,rootRef:I},Zt.createElement(Vv.g,{noShrink:!0},Zt.createElement(IO,{chatId:u,isUserScrollingSource:k,scrollingDeltaSource:C,isOnBottomSource:S}),o&&Zt.createElement(uy,{className:hC,isUserScrollingSource:k})),Zt.createElement(cb.a,{appear:!0,component:null},Zt.createElement(yb,null,Zt.createElement(fC,null,m&&Zt.createElement(pC,null,p("reconnecting")+"\u2026"),Zt.createElement(cC,{chatId:u,isScrollable:V(),isOnBottomSource:S,scrollToBottom:B,markAsSeen:T.markAsSeen}),Zt.createElement(Vv.k,{usePinnedScroll:!1,active:s,className:mC,onWheel:U,onTouchStart:F,innerRef:function(e){return I.current=e}},c&&Zt.createElement(Vv.q,null,Zt.createElement(sC,{size:"medium",style:{margin:"auto"}})),b.map((function(e,t){return Zt.createElement(Zt.Fragment,{key:vC(e)},e.isThreadBoundary&&Zt.createElement(py,{timestamp:e.timestamp}),z&&N>0&&e.events.some((function(e){return e.id===z.id}))&&Zt.createElement(hy,{unseenCount:N,setScrollTargetNode:G}),Zt.createElement(Vv.j,{isOwn:e.own,onlyFirstWithMeta:!0,avatar:v&&"carousel"!==e.type&&e.authorData.avatar?e.authorData.avatar:void 0},e.events.map((function(t,n){return Zt.createElement(I_,{chatId:u,id:t.id,key:t.id,showMetaOnClick:0!==n,radiusType:e.radiusType,listItemHandlers:T,scrollTarget:R,setScrollTargetNode:!N&&G,scrollToBottomIfNeeded:H,showMoment:E})}))))})),a&&Zt.createElement(A_,{eventId:a.id,onSelect:function(e){var t=e.button,n=e.event;w(t.text,{type:"quick_reply",event:n,button:t})},replies:a.properties.quickReplies}),Zt.createElement(cb.a,{appear:!0,component:null},y&&Zt.createElement(gb,{exit:!1},Zt.createElement(Lb,{avatar:v?i.avatar:null}))))))),"requestPrechat"===l?Zt.createElement(lC,{onClick:Y(g)},p("embedded_greeting_accept")):"startChatAgain"===l?Zt.createElement(dC,{onClick:Y()}):"text"===l?Zt.createElement(R_,{chatId:u,onSendMessage:J,onHeightChange:W,onFocusChange:K}):null,Zt.createElement(B_,{chatId:u,onSendMessage:J}))})),_C=Object(Vv.C)("div",{displayName:"View",section:!0,target:"e1u2umur0"})("flex-grow:1;display:flex;height:100%;min-height:0;padding-bottom:1em;"),CC=Object(Vv.C)("div",{displayType:"ViewContent",target:"e1u2umur1"})("overflow-y:auto;height:100%;flex-grow:1;padding:",(function(e){return e.full?"0 !important":"1em 1em 0 1em"}),";"),wC=Object(Vv.y)("&-enter,&-appear{opacity:0;}&-enter&-enter-active,&-appear&-appear-active{opacity:1;transition:opacity ",200,"ms ","cubic-bezier(0.33, 0, 0, 1)",";}&-exit{opacity:1;}&-exit&-exit-active{opacity:0;transition:opacity ",200,"ms ","cubic-bezier(0.335, 0.520, 0.000, 1.000)",";}"),EC=Object(Vv.y)("width:100%;"),IC=function(e){var t=e.children,n=e.full,r=void 0!==n&&n;return Zt.createElement(_C,null,Zt.createElement(cb.a,{className:EC},Zt.createElement(mb.a,{appear:!0,classNames:wC,timeout:200},Zt.createElement(CC,{full:r},t))))},SC=function(){return Zt.createElement(rn,null,(function(e){return Zt.createElement(IC,null,Zt.createElement(Vv.c,null,Zt.createElement(Vv.m,null,e("lost_connection"))))}))},kC=Object(Vv.B)("50%{opacity:0.0;}"),TC=Object(Vv.y)("background:currentColor;opacity:0.3;animation:",kC," 1.5s linear 0s infinite;"),AC=Object(Vv.y)(TC,";"),PC=Object(Vv.C)("div",{target:"e1uut4cd0"})("width:",(function(e){return e.width||"10em"}),";height:1em;margin:0.3em;border-radius:3px;",TC,";"),NC=Object(Vv.C)("div",{target:"e1uut4cd1"})("width:100%;"),MC=Object(Vv.C)("div",{target:"e1uut4cd2"})("padding:1em;"),zC=Object(Vv.C)("div",{target:"e1uut4cd3"})("width:100%;margin-top:0.5em;"),RC=Object(Vv.C)("div",{displayName:"Message",section:!0,target:"e1uut4cd4"})(),DC=function(){return Zt.createElement(IC,{full:!0},Zt.createElement(NC,null,Zt.createElement(Vv.a,null,Zt.createElement(Vv.b,{className:AC,letter:" "})),Zt.createElement(MC,null,Zt.createElement(zC,null,Zt.createElement(Vv.q,null,Zt.createElement(RC,null,Zt.createElement(Vv.c,null,Zt.createElement(Vv.m,null,Zt.createElement(PC,null),Zt.createElement(PC,{width:"7em"})))))),Zt.createElement(zC,null,Zt.createElement(Vv.q,{reverse:!0},Zt.createElement(RC,null,Zt.createElement(Vv.c,null,Zt.createElement(Vv.m,null,Zt.createElement(PC,null)))))),Zt.createElement(zC,null,Zt.createElement(Vv.q,null,Zt.createElement(RC,null,Zt.createElement(Vv.c,null,Zt.createElement(Vv.m,null,Zt.createElement(PC,null)))))))))},LC=Qt((function(e){return{destroyed:e.getApplicationState().destroyed,showLoader:Gn("liveChatChatId",e)}}))((function(e){var t=e.destroyed,n=e.showLoader,r=e.scrollingDeltaSource;return t?Zt.createElement(SC,null):n?Zt.createElement(DC,null):Zt.createElement(xC,{id:"liveChatChatId",scrollingDeltaSource:r})})),BC=Object(Vv.C)("div",{target:"e5cxvfk0"})("display:flex;justify-content:center;font-size:0.9em;"),qC=Object(Vv.C)("p",{target:"errpamd0"})("text-align:center;"),UC=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={opened:!1,submitting:!1},t.showModal=function(){t.setState({opened:!0})},t.closeModal=function(){t.setState({opened:!1})},t.handleCloseClick=function(){t.setState({submitting:!0}),t.props.closeChat().then((function(){t.setState({submitting:!1}),t.closeModal()})).catch((function(){t.setState({submitting:!1})}))},t}return Object(Fv.a)(t,e),t.prototype.render=function(){var e=this.props.localize,t=this.state.submitting;return Zt.createElement(Zt.Fragment,null,Zt.createElement(dO,{label:e("close_chat")},Zt.createElement(Bg,{onClick:this.showModal},Zt.createElement(zg,null))),Zt.createElement(Ny,{shown:this.state.opened,onClose:this.closeModal},Zt.createElement($j,null,Zt.createElement(Lg,null)),Zt.createElement(qC,null,e("leave_chat_confirm")),Zt.createElement(BC,null,Zt.createElement(Tj,{destructive:!0,label:e("close_chat"),submitting:t,onClick:this.handleCloseClick}))))},t}(Zt.Component),FC=27,VC=Object(Vv.C)("div",{target:"e1ixnb8m0"})("position:absolute;z-index:100;background:#fff;box-shadow:0 0.2em 0.8em rgba(0,0,0,0.2);border-radius:8px;margin-top:2.2em;margin-left:0.8em;overflow:hidden;min-width:180px;");var GC=function(e){var t=e.children,n=e.onClose,r=void 0===n?x.P:n,a=e.triggerRef,i=Zt.useRef(null);return Object(Xv.a)(i,(function(e){a.current.contains(e.target)||r()})),function(e,t){var n=Zt.useRef(t);Zt.useEffect((function(){n.current=t}));var r=!!t;Zt.useEffect((function(){if(r){var t=function(t){t.keyCode===e&&n.current&&n.current(t)};return document.addEventListener("keydown",t),function(){return document.removeEventListener("keydown",t)}}}),[e,r])}(FC,r),Zt.createElement(yy,null,Zt.createElement(VC,{innerRef:i},t))},HC=Object(Vv.C)("p",{target:"e6vnhqa0"})("text-align:center;");function WC(e){var t=e.email,n=e.localize,r=e.sent,a=e.opened,i=e.onClose,o=e.onSubmit,c=e.mobile;return Zt.createElement(Ny,{shown:a,onClose:i},a&&(r?Zt.createElement(Zt.Fragment,null,Zt.createElement($j,null,Zt.createElement(Fg,null)),Zt.createElement(HC,{textWrap:!0},n("chat_transcript_sent").replace(/%s/g,t)),Zt.createElement(BC,null,Zt.createElement(kj,{capitalize:!0,onClick:i},n("hide")))):Zt.createElement(Zt.Fragment,null,Zt.createElement($j,null,Zt.createElement(Fg,null)),Zt.createElement(HC,null,n("send_transcript_to_email")),Zt.createElement(Fj,{id:"email_transcript",initialValues:{email:t},mobile:c,onSubmit:function(e){return o(e.email).catch((function(){var e;return(e={})[_x.a]=n("lost_connection"),e}))},submitLabel:n("send"),validate:function(e){if(!e.email)return{email:n("survey_fill_in_required_fields")}}},Zt.createElement(Vv.q,null,Zt.createElement(wx,{name:"email",required:!0,mobile:c}))))))}var YC,JC,KC=Object(Vv.C)("button",{target:"ejny03d0"})("background:transparent;font-family:inherit;font-size:14px;border:0;display:flex;align-items:center;padding:1.3em;width:100%;&:hover{cursor:pointer;}&:active,&:focus{outline:black solid 0px;}"),QC=Object(Vv.C)("ul",{target:"e1qbuf310"})("list-style-type:none;margin:0;padding:0;& >:last-child{border-bottom:0;}"),ZC=Object(Vv.C)("li",{target:"e1qbuf311"})("display:flex;border-bottom:1px solid #e9eef4;pointer-events:",(function(e){return e.disabled?"none":"auto"}),";&:hover{color:#fff;background-color:",(function(e){return e.theme.colors.cta}),";cursor:pointer;& > *{color:#fff;}}"),XC=Object(Vv.y)("margin-right:8px;"),$C=Object(Vv.y)("&-enter{opacity:0;",QC,"{transform:translate3d(0,20%,0);}}&-enter-active{opacity:1;transition:opacity 100ms ease-in-out;",QC,"{transform:translate3d(0,0%,0);transition:transform 200ms;}}&-exit{opacity:1;",QC,"{transform:translate3d(0,0%,0);}}&-exit-active{opacity:0;transition:opacity 200ms ease-in-out;",QC,"{transform:translate3d(0,20%,0);transition:transform 200ms;}}"),ew=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={opened:!1,emailTranscriptModalOpened:!1},t.triggerRef=Zt.createRef(),t.toggleMenu=function(){t.setState((function(e){return{opened:!e.opened}}))},t.closeMenu=function(){t.setState({opened:!1})},t.handleTranscriptEmail=function(e){return t.props.sendTranscript(e)},t.closeEmailTranscriptModal=function(){t.setState({emailTranscriptModalOpened:!1})},t.showEmailTranscriptModal=function(){t.closeMenu(),t.setState({emailTranscriptModalOpened:!0})},t}return Object(Fv.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.muted,n=e.transcriptSentTo,r=e.enableTranscript,a=e.localize,i=e.showTranscript,o=e.toggleSounds,c=e.customerEmail,s=this.state.emailTranscriptModalOpened,u=!!n;return Zt.createElement(Zt.Fragment,null,Zt.createElement(dO,{disabled:this.state.opened,label:a("theme_options")},Zt.createElement(Vv.h,{innerRef:this.triggerRef,onClick:this.toggleMenu,style:{padding:0}},Zt.createElement(Rg,null))),Zt.createElement(cb.a,{component:null},this.state.opened&&Zt.createElement(mb.a,{classNames:$C,timeout:200},Zt.createElement(GC,{triggerRef:this.triggerRef,onClose:this.closeMenu},Zt.createElement(QC,null,i&&Zt.createElement(ZC,{disabled:!r},Zt.createElement(KC,{disabled:!r,onClick:this.showEmailTranscriptModal},Zt.createElement(Fg,{className:XC}),a("send_transcript"))),Zt.createElement(ZC,null,Zt.createElement(KC,{onClick:o},t?Zt.createElement(Zg,{className:XC}):Zt.createElement(Gg,{className:XC}),a(t?"unmute":"mute"))))))),Zt.createElement(WC,{email:u?n:c,localize:a,onClose:this.closeEmailTranscriptModal,onSubmit:this.handleTranscriptEmail,sent:u,opened:s}))},t}(Zt.Component),tw=Qt((function(e){var t=function(t){return e.requestUpdateChat("liveChatChatId",{properties:{transcriptSentTo:t}})},n=function(){e.setApplicationState({muted:!e.getApplicationState("muted")})};return function(e){var r=e.getChat("liveChatChatId"),a=r.active,i=r.properties,o=i.transcriptSentTo;return{muted:e.getApplicationState("muted"),sendTranscript:t,transcriptSentTo:o,enableTranscript:a||i.ended,showTranscript:ln("emailTranscript",e).enabled,toggleSounds:n,customerEmail:e.getSessionUser().email}}}))(ew),nw=window.matchMedia("(max-height: 330px)"),rw=Object(Vv.y)("overflow:hidden;flex-grow:0;text-align:left;padding:0 0.8em;font-weight:700;display:flex;align-items:center;transition:0.3s background-color;"),aw=Object(Vv.C)("div",{displayName:"IconPlaceholder",target:"e7bf83j0"})("width:25px;flex-shrink:0;"),iw=Object(Vv.C)("div",{target:"e7bf83j1"})("height:19px;line-height:19px;"),ow=Object(Vv.C)("div",{target:"e7bf83j2"})(),cw=function(e){return Object(x.ab)(e-1).map((function(e){return Zt.createElement(aw,{key:"placeholder_"+e})}))},sw=Qt((function(e){var t=function(){return e.requestUpdateChat("liveChatChatId",{active:!1})},n=e.getApplicationState("embedded");return function(e){var r=un("liveChatChatId",e);return{embedded:n,closeChat:t,title:e.localize("welcome_title"),alternateTitle:r?e.localize("embedded_chat_with",{operator:r.name}):"",showCloseButton:e.getChat("liveChatChatId").active,localize:e.localize,showAgentBar:Vn(e)}}}))((function(e){var t=e.showCloseButton,n=e.closeChat,r=e.localize,a=e.showMinimizedButton,i=e.title,o=e.alternateTitle,c=e.onMinimize,s=e.showAgentBar,u=e.scrollingDeltaSource,l=Zt.useRef(),d=Zt.useRef(),p=Zt.useRef(),f=Zt.useRef(nw.matches),m=Zt.useCallback((function(){l.current&&(l.current.style.opacity=1),d.current&&(d.current.style.opacity=0),p.current&&(p.current.style.transform="translateY(30px)")}),[]);vg(m),jg(u,(function(e){var t=e.y;s&&!f.current&&(l.current&&(l.current.style.opacity=1-2*t),d.current&&(d.current.style.opacity=t),p.current&&(p.current.style.transform="translateY("+(30-60*t)+"px)"))})),Zt.useEffect((function(){s||m()}),[s,m]),Zt.useEffect((function(){var e=function(e){var t=e.matches;return f.current=t};return nw.addListener(e),function(){return nw.removeListener(e)}}),[]);var h=function(e,t){var n=e.filter(Boolean),r=t.filter(Boolean);return n.length===r.length?{leftIcons:n,rightIcons:r}:n.length>r.length?{leftIcons:n,rightIcons:cw(n.length-r.length).concat(r)}:{leftIcons:n.concat(cw(r.length-n.length)),rightIcons:r}}([Zt.createElement(tw,{key:"menu",localize:r})],[a&&Zt.createElement(dO,{key:"minimize",label:r("embedded_minimize_window")},Zt.createElement(Bg,{onClick:c},Zt.createElement(Vg,null))),t&&Zt.createElement(UC,{closeChat:n,key:"close",localize:r})]),v=h.leftIcons,g=h.rightIcons;return Zt.createElement(Vv.x,{className:rw,leftIcons:v,noShrink:!0,rightIcons:g,title:Zt.createElement(ow,{innerRef:p},Zt.createElement(iw,{ellipsis:!0,innerRef:l,style:{marginBottom:40}},i),Zt.createElement(iw,{ellipsis:!0,innerRef:d},o))})})),uw=Object(Vv.y)("color:#d46d39;"),lw=Object(Vv.C)("div",{displayName:"Footer",section:!0,target:"egii5nj0"})(),dw=Object(Vv.C)("a",{displayName:"FooterLink",target:"egii5nj1"})(),pw=Qt((function(e){var t=e.getApplicationState(),n=t.license,r=t.mobile,a=document.referrer?Object(I.j)(Object(I.d)(document.referrer)):"lc"+n,i=function(e){return e.getApplicationState("config").nonProfitLicense}(e);return{url:"https://www.livechatinc.com/powered-by-livechat/?"+Object(I.a)(Object(C.a)({partner:a,utm_campaign:a,utm_source:"chat_window",utm_medium:"referral"},i&&{utm_term:"nonprofit"})),hidden:ln("hideTrademark",e).enabled||r}}),{shouldHandleStateChanges:!1})((function(e){var t=e.hidden,n=e.url;return t?null:Zt.createElement(lw,null,Zt.createElement(dw,{href:n,rel:"noreferrer",target:"_blank"},Zt.createElement("span",null,"Powered by "),Zt.createElement("strong",null,"Live"),Zt.createElement("strong",{className:uw},"Chat")))})),fw=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.forEach((function(e){e.apply(void 0,n)}))}},mw=Object(Vv.C)("div",{displayName:"Maximized",target:"e903lsu0"})("position:relative;display:flex;flex-direction:column;min-width:0;height:100%;box-shadow:0 4px 16px rgba(0,0,0,0.25);overflow:hidden;background:#fff;",(function(e){return{borderRadius:e.expandToEdge?"0 !important":"10px"}}),";"),hw=Object(Vv.C)("div",{target:"e903lsu1"})("flex-grow:1;"),vw=Object(Vv.y)("&-enter{opacity:0;transform:translate3d(0,100%,0);}&-enter&-enter-active{opacity:1;transform:translate3d(0,0%,0);transition:opacity 140ms ease 200ms,transform 140ms ease 200ms;}&-exit{opacity:1;transform:translate3d(0,0%,0);}&-exit&-exit-active{opacity:0;transform:translate3d(0,100%,0);transition:opacity 140ms ease,transform 140ms ease;}"),gw=function(e){return Object(Vv.y)("&-enter{transform:translate3d(","right"===e?"":"-","40%,40%,0) scale(0.1);",mw," > *{opacity:0;transform:translate3d(0,20%,0);}}&-enter&-enter-active{transform:translate3d(0%,0%,0) scale(1);transition:transform ",430,"ms ","cubic-bezier(0.33, 0, 0, 1)",";",mw," > *{opacity:1;transform:translate3d(0,0%,0);transition:opacity 160ms ","cubic-bezier(0.33, 0, 0, 1)"," 270ms,transform 160ms ","cubic-bezier(0.33, 0, 0, 1)"," 270ms;}}&-exit{transform:translate3d(0%,0%,0) scale(1);opacity:1;",mw," > *{opacity:1;transform:translate3d(0,0%,0);}}&-exit&-exit-active{opacity:0;transform:translate3d(","right"===e?"":"-","40%,40%,0) scale(0.1);transition:transform ",430,"ms ","cubic-bezier(0.335, 0.520, 0.000, 1.000)",",opacity 300ms ease;",mw," > *{opacity:0;transform:translate3d(0,10%,0);transition:opacity 160ms ","cubic-bezier(0.335, 0.520, 0.000, 1.000)",",transform 160ms ","cubic-bezier(0.335, 0.520, 0.000, 1.000)",";}}")},bw=Object(Vv.C)("div",{displayName:"ApplicationWrapper",target:"e903lsu2"})("position:absolute;top:0;left:auto;right:0;bottom:0;width:100%;height:100%;will-change:tranform,opacity;backface-visibility:hidden;"),yw=Object(Vv.C)("div",{target:"e903lsu3"})("z-index:101;border-radius:inherit;"),jw=Object(Vv.C)("div",{target:"e903lsu4"})("z-index:101;position:relative;"),Ow=function(e){var t=e.dir,n=e.enhancedToggle,r=e.showMinimizedButton,a=e.isMainViewVisible,i=e.expandToEdge,o=sg({x:0,y:0});return Zt.createElement(bw,{dir:t,expandToEdge:i},Zt.createElement(mw,{expandToEdge:i},Zt.createElement(yw,{id:"app-portal"}),Zt.createElement(jw,{id:"tooltip-portal"}),Zt.createElement(sw,{onMinimize:n,showMinimizedButton:r,scrollingDeltaSource:o}),a?Zt.createElement(LC,{scrollingDeltaSource:o}):Zt.createElement(hw,null),Zt.createElement(pw,null)))},xw=Qt((function(e){var t=function(t){e.setApplicationState({maximized:t})};return function(e){var n=e.getApplicationState(),r=n.mobile,a=n.embedded,i=n.actingAsDirectLink,o=n.isInCustomContainer,c=n.maximized,s=n.rtl,u=ln(r?"mobileMinimized":"minimized",e).enabled;return{mobile:r,expandToEdge:r||!a||o,setMaximizedState:t,embedded:a,maximized:c,showMinimized:!i&&u,screenPosition:bn(e),rtl:s,testGroup:Nn(e),shouldPerformTest:Mn(e),showMinimizedButton:Wn(e)}}}))((JC=YC=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={isMainViewVisible:t.props.maximized},t.enhanceToggle=function(e){return fw(t.props.embedded?e:x.P,t.props.onClick)},t.handleAnimationEnd=function(){t.props.onAnimationEnd()},t.showMainView=function(){t.setState({isMainViewVisible:!0})},t.hideMainView=function(){t.setState({isMainViewVisible:!1})},t}Object(Fv.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){},n.render=function(){var e=this,t=this.props,n=t.expandToEdge,r=t.maximized,a=t.setMaximizedState,i=t.screenPosition,o=t.showMinimizedButton,s=t.showMinimized,u=t.onMinimizedRef,l=t.onMinimizedResize,d=this.state.isMainViewVisible,p=this.props.rtl?"rtl":"ltr";return Zt.createElement(Zt.Fragment,null,Zt.createElement(Bv.LogOnMount,{eventType:c.INIT}),Zt.createElement(Kv.a,{on:r,onToggle:a},(function(t){var r=t.on,a=t.toggle,c=e.enhanceToggle(a);return Zt.createElement(cb.a,{appear:!0},r&&Zt.createElement(mb.a,{classNames:gw(i),onExited:e.handleAnimationEnd,onEntered:e.showMainView,onExit:e.hideMainView,timeout:430},Zt.createElement(Ow,{dir:p,enhancedToggle:c,isMainViewVisible:d,showMinimizedButton:o,expandToEdge:n})),!r&&s&&Zt.createElement(mb.a,{classNames:vw,onExited:e.handleAnimationEnd,timeout:430},Zt.createElement(Qb,{dir:p,onMaximize:c,innerRef:u,onResize:l})))})))},t}(Zt.Component),YC.propTypes={maximized:Jv.bool.isRequired,onAnimationEnd:Jv.func,onClick:Jv.func,setMaximizedState:Jv.func.isRequired},YC.defaultProps={onAnimationEnd:x.P,onClick:x.P},JC)),_w=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={crashed:!1},t}Object(Fv.a)(t,e);var n=t.prototype;return n.componentDidCatch=function(e,t){this.setState({crashed:!0}),this.props.onError(e,t)},n.render=function(){return this.state.crashed?null:this.props.children},t}(Zt.Component);_w.defaultProps={onError:x.P};var Cw=Og(16),ww=Og(14),Ew=Og(12),Iw={fontSize:Cw,fontWeight:"bold",color:"#3e3e41"},Sw={fontSize:ww,fontWeight:"bold",color:"#3e3e41"},kw={fontSize:ww,fontWeight:"normal",color:"#3e3e41"},Tw={fontSize:ww,fontWeight:"normal",color:"#9c9c9f"},Aw={fontSize:Ew,fontWeight:"normal",color:"#3e3e41"},Pw={fontSize:ww,fontWeight:"normal",color:"#3e3e41"},Nw={fontSize:ww,fontWeight:"normal",color:"#ffffff"},Mw={fontSize:Ew,fontWeight:"normal",color:"#d64546"},zw={spaceBase:8,typography:s},Rw=Object(Vv.B)("100%{opacity:0.3;}"),Dw=Object(C.a)({},zw,{borderRadius:"6px",vars:{"primary-color":"#2200ff","secondary-color":"#ffffff","tertiary-color":"#e9eef4"},ApplicationWrapper:{css:{padding:{default:"1em 1em 1em 1em",expandToEdge:"0"}}},AgentBar:{Avatar:{size:"40px"},IconButton:{css:{width:"40px",height:"40px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"6px",fontSize:Og(32),opacity:{default:"1",disabled:"0.15"},color:{active:"#fff"}}},Title:{css:{fontSize:".9em",fontWeight:"bold"}},SubTitle:{css:{fontSize:"0.9em",opacity:"1"}},css:{backgroundColor:"#fff",zIndex:"1",color:"#424d57",padding:"1rem"}},Avatar:{size:"20px",css:{border:0}},Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",border:"0"}},ImagePreview:{css:{maxWidth:"200px",maxHeight:"300px",borderRadius:"6px"}},IconButton:{css:{padding:"0 .5em"}},Footer:{css:{fontSize:"0.65em",padding:"0.5em 0",width:"100%",textAlign:"center",backgroundColor:"#f5f5f5"},FooterLink:{css:{textDecoration:"none",color:"#7d7d7d",padding:"0.2em",borderRadius:"6px"}}},Form:{IconButton:{css:{color:{default:"#8f8f8f",active:"#fff"}}}},MessageButtons:{css:{color:"#3e7ce4"}},MessageText:{css:{fontSize:"14px"}},Message:{css:{animation:{default:"none",sending:Rw+" 2s 2s forwards"},opacity:{default:"1",failed:"0.7"},color:"#424d57",justifyContent:{default:"flex-start",system:"center"}},Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",border:"0"}},system:{Bubble:{css:{background:"transparent",textAlign:"center",border:"0",width:"100%",boxShadow:"none"}},MessageText:{css:{padding:"0 1em"}}},fullWidth:{Content:{css:{width:"100%"}}}},MinimizedBar:{Icon:{color:"var(--primary-color)"},css:{position:"relative"}},MinimizedBubble:{Icon:{color:"#fff"},css:{position:"relative",background:{default:"var(--primary-color)",hasAvatar:"transparent"}}},Minimized:{Avatar:{css:{border:"0",backgroundColor:"transparent"}}},Invitation:{IconButton:{css:{visibility:{mobile:"visible"}}},Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{border:"0"}}},TitleBar:{css:{backgroundColor:"#fff",color:"#424d57",fontWeight:"700!important",fontSize:"1em",textAlign:"center",height:"50px"},TitleBarTitle:{css:{fontSize:Og(14)}}},TextComposer:{css:{fontSize:{default:"14px",mobile:"16px"},padding:"1em",boxShadow:"0 -1em 1em rgba(0, 0, 0, 0.03)",zIndex:"1",background:{disabled:"#fdedd3"}},TextInput:{css:{background:{disabled:"#fdedd3"}}},IconButton:{css:{opacity:{active:1,default:.4}}}},TopBar:{css:{height:72}},View:{css:{color:"#424d57"},Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",border:"0"}}},SystemCard:{css:{border:"0",boxShadow:"0px 1px 2px rgba(0, 0, 0, 0.1)",left:{default:"50%",rtl:"auto"},right:{default:"auto",rtl:"50%"},transform:{default:"translateX(-50%)",rtl:"translateX(50%)"}}}}),Lw=Object(C.a)({},zw,{borderRadius:"4px",TitleBar:{css:{fontWeight:"700!important",fontSize:"1.1em",textAlign:"center!important",height:"46px",justifyContent:"flex-start"},TitleBarTitle:{css:{fontSize:Og(14)}}},IconButton:{css:{padding:"0 .5em"}},MessageList:{css:{backgroundColor:"#fff"}},Maximized:{css:{borderRadius:"3px 3px 0 0"}},Footer:{css:{position:"relative",right:0,bottom:0,fontSize:"0.6em",color:"#b4b4b4",backgroundColor:"#f5f5f5",textAlign:"center",padding:"1em"},FooterLink:{css:{textDecoration:"none",color:"inherit",fontWeight:"bold"}}},ApplicationWrapper:{css:{padding:{default:"1em 1em 0 1em",expandToEdge:"0"}}},AgentBar:{css:{padding:"0.6em"},Avatar:{size:"60px",css:{borderRadius:"0"}},SubTitle:{css:{fontSize:".8em"}},Title:{css:{fontSize:"1em",fontWeight:"bold"}},IconButton:{css:{fontSize:Og(24),backgroundColor:"transparent !important",color:{default:"inherit"},opacity:{default:"0.3",disabled:"0.15",active:"0.6"}}}},Button:{css:{boxShadow:"0 2px 0 rgba(0, 0, 0, .1), inset 0 -3px 0 rgba(0, 0, 0, .05)"}},Message:{own:{Content:{css:{alignItems:"flex-start"}}},system:{MessageText:{css:{fontSize:".9em",opacity:"0.6"}}},css:{flexDirection:"row"},Status:{css:{opacity:"0.6"}},Bubble:{sharpBorderRadius:"0px",ovalBorderRadius:"0px",css:{border:"0",padding:"0",background:"transparent",boxShadow:"none"}},ImagePreview:{css:{maxWidth:"150px",maxHeight:"250px",borderRadius:"0px"}},MessageButtons:{css:{borderRadius:"6px !important",overflow:"hidden",border:"1px solid rgba(0, 0, 0, 0.2)"}},Button:{css:{borderTop:"0!important"}}},MessageText:{css:{padding:"0",fontSize:"14px"}},MessageGroup:{css:{marginBottom:".5em"}},MinimizedBar:{css:{borderRadius:"3px 3px 0 0",height:"40px"},Icon:{css:{transform:"scale(0.8)"}}},MinimizedBubble:{css:{position:"relative"}},TopBar:{css:{height:92}},View:{Bubble:{css:{border:"0",padding:"0",background:"transparent",boxShadow:"none"}},ViewContent:{css:{paddingTop:".5em"}},css:{paddingBottom:"0"}},TextInput:{css:{lineHeight:"1.1em"}},MessageMeta:{css:{opacity:"0.6"}},Form:{css:{fontSize:"0.9em"},IconButton:{css:{color:{default:"#8f8f8f",active:"#fff"}}}},Tooltip:{css:{padding:"0.5em 0.8em",fontSize:".7em"}},TooltipArrow:{css:{marginTop:"-1em"}},Invitation:{Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{padding:".5em"}}},InformationField:{css:{fontSize:"1.1em"}},SystemCard:{css:{maxWidth:"368px",width:"calc(100% - 0.6em)",margin:"0.3em",boxShadow:"none",border:"1px solid rgb(221, 221, 230)"}},TextComposer:{IconButton:{css:{opacity:{active:1,default:.4}}}},NewMessageHorizontalDivider:{css:{margin:"8px -0.5em"}},BoosterContainer:{css:{border:"1px solid rgb(221, 221, 230)",maxWidth:"368px",width:"calc(100% - 0.6em)",margin:"0.3em",boxShadow:"none",borderRadius:"6px"}},BoosterButton:{css:{boxShadow:"none"}}}),Bw=function(e){function t(t){var n;(n=e.call(this,t)||this).id="widget-global-"+Object(x.s)(),Object(Vv.A)("#",n.id," *{font-family:'Noto Sans',sans-serif;box-sizing:border-box;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:transparent;}");var r="https://fonts.googleapis.com/css?family=Noto+Sans:400,700&subset=latin-ext&display=swap",a=document.querySelector("head"),i=a.querySelectorAll("link");if(Object(x.k)((function(e){return e.href===r}),i))return Object(Uv.a)(n);var o=document.createElement("link");return o.setAttribute("href",r),o.setAttribute("rel","stylesheet"),a.appendChild(o),n}return Object(Fv.a)(t,e),t.prototype.render=function(){return Zt.createElement("div",{id:this.id},this.props.children)},t}(Zt.Component),qw=Qt((function(e){return{mobile:e.getApplicationState("mobile"),theme:e.getApplicationState("config").theme}}),{shouldHandleStateChanges:Boolean("")})((function(e){var t=e.mobile,n=e.theme,r=e.children,a=Object(x.N)("modern"===n.name?Lw:Dw,n);return Zt.createElement(Vv.v,{theme:t?Object(x.N)(a,{typography:{input:{fontSize:"16px"},placeholder:{fontSize:"16px"}}}):a},r)})),Uw=function(e,t){var n=t.store,r=t.onError,a=t.amplitudeKey,i=Object(w.a)(t,["store","onError","amplitudeKey"]);Ui.render(Zt.createElement(_w,{onError:r},Zt.createElement(an,{store:n},Zt.createElement(qv,{amplitudeKey:a},Zt.createElement(Wv,null,Zt.createElement(Bw,null,Zt.createElement(qw,null,Zt.createElement(xw,i))))))),e)};function Fw(e,t,n,r){var a=t.data,i=t.props,o=i.onError,c=void 0===o?x.P:o,s=Object(w.a)(i,["onError"]),u=t.onBootstrap,l=void 0===u?x.P:u;return new Promise((function(t){("3"===n.license_properties.lc_version?pv:Df)(a,e,n);var i="3"===n.license_properties.lc_version?"lc3":"lc2";e.setApplicationState({protocol:i});e.on("set_application_state",(function n(a){if(a.ready){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_sdk_ready"),e.off("set_application_state",n),e.getApplicationState("embedded")||(Nv(e),hv(e)),sa(e),la(e),mv(e,r);var i=document.getElementById("root");Uw(i,Object(C.a)({},s,{onError:function(e,t){var n=t.componentStack;or("react_error",e,{componentStack:n}),Ui.render(null,i),c()},amplitudeKey:!1,store:e})),window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_bootstrap_end"),l(),t()}}))}))}var Vw=function(e,t,n){return!!n||!t&&e.getApplicationState("maximized")};var Gw={},Hw=function(e,t){var n=void 0===t?{}:t,r=n.query,a=void 0===r?{}:r,i=n.jsonpParam,o=void 0===i?"jsonp":i;return new Promise((function(t,n){Object(Ai.c)().then((function(r){var i,c=document.createElement("script"),s=Object(x.t)(Gw);Gw[s]=!0;var u="__"+s;window[u]=function(e){delete Gw[s],delete window[u],Object(Ai.f)(c),t(e)},c.src=e+"?"+Object(I.a)(Object(M.a)({},a,((i={})[o]=u,i))),c.addEventListener("error",(function(){return n(new Error("JSONP request failed."))})),r.appendChild(c)}))}))},Ww=function e(t,n){var r=n.license,a=n.uniqueGroups,i=n.group,o=n.region,c=n.query,s=function(e,t){if(1520===e)return"https://secure-lc.livechatinc.com";return t?function(e,t){var n=e.match(/secure(-(labs|lc))/i);return"https://secure-"+t+(null!==n&&n.length>0?n[1]:"")+".livechatinc.com"}("https://secure.livechatinc.com",t):"https://secure.livechatinc.com"}(r,o);return Hw(s+"/"+function(e){var t=e.uniqueGroups,n=e.license,r=e.group;return"licence/"+(t?"g"+n+"_"+(r||0):n)}({uniqueGroups:a,license:r,group:i})+"/v2/"+t+".js",{query:Object(C.a)({referrer:document.referrer,url:String(document.location)},c)}).then((function(n){if(n.error&&"incorrect region"===n.error)return e(t,{license:r,uniqueGroups:a,group:i,region:n.region,query:c});if(n.error)throw new Error(n.error);return Object(C.a)({},n,{region:o})}))},Yw=function(e){var t=e.license,n=e.group,r=e.uniqueGroups,a=void 0!==r&&r,i=e.skipCodeInstallationTracking,o=void 0!==i&&i,c=e.channel,s=Object(C.a)({t:Date.now()},"number"===typeof n&&{groups:n},c&&{channel_type:c},o&&{test:1});return Ww("get_dynamic_config",{license:t,group:n,uniqueGroups:a,query:s}).then((function(e){var r=e.visitor.groups;return Promise.all([a&&n!==r?Ww("get_dynamic_config",{license:t,group:r,uniqueGroups:a}):e,Ww("get_static_config."+r+"."+e.static_config_version,{license:t,group:r,uniqueGroups:a})])})).then((function(e){var t=e[0],n=e[1];return Object(C.a)({},t,n)}))},Jw=function(e,t){var n=e.license,r=e.group,a=Aa({application:{license:n,group:r,rtl:Li(t),language:t.lang,embedded:!1,mobileWrapper:ra(),page:{title:document.title,url:String(document.location),referrer:document.referrer}}},{persistKey:Di(e)});return a.setApplicationState({maximized:!0}),a.on("protocol_upgraded",(function(){window.location.reload()})),a.updateUser(a.getSessionUserId(),function(){var e=Object(I.h)(window.location.search),t=Object(x.Z)(["name","email"],e);return e.params&&(t.properties=Object(I.b)(e.params)),t}()),a};var Kw,Qw=Object(I.h)(window.location.search),Zw=Xn(),Xw="group"in(Kw=Qw)?$n(Kw.group):"groups"in Kw?$n(Kw.groups):null,$w=er();if(!Zw)throw new Error("No license found in the URL.");!function(){var e={license:Zw,group:Xw,uniqueGroups:$w};Qw.embedded?function(e){var t=e.license,n=e.group,r=e.uniqueGroups,a=Aa({application:{license:t,group:n}},{persistKey:Di(e)}),i=Si(a);new va.Model(i).then((function(e){return Promise.all([e,a.syncing()])})).then((function(e){var i=e[0];window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_postmate_ready");var o=i.model,c=o.clientLimitExceeded,s=o.customer,u=o.hidden,l=o.integrationName,d=o.isInCustomContainer,p=o.page,f=o.region,m=o.serverConfig,h="actingAsDirectLink"in i.model?i.model.actingAsDirectLink:i.model.directLink,v=a.getApplicationState("mobile"),g=h||d;Bi(m),a.updateUser(a.getSessionUserId(),s),a.setApplicationState({clientLimitExceeded:!a.getApplicationState("clientLimitExceededLifted")&&c,actingAsDirectLink:h,embedded:!0,isInCustomContainer:d,mobileWrapper:null,hidden:u,page:p,maximized:Vw(a,v,g),rtl:Li(m),language:m.lang,integrationName:l});var b={onAnimationEnd:function(){return a.emit("animation_end")},onError:function(){i.call("kill")},onMinimizedRef:function(e){i.minimizedRef=e},onMinimizedResize:function(){return zi(i,a)}};Fw(a,{data:{license:t,group:n,region:f,uniqueGroups:r,mobile:v},props:b,onBootstrap:function(){g?i.call("show"):(Ri(i,a),qi(a.getState())||i.call("show"))}},m,i)}))}(e):function(e){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_config_request"),Yw(Object(C.a)({},e,{channel:"direct_link"})).then((function(t){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_server_config");var n=t.visitor.groups,r=t.region;Bi(t);var a=Jw(Object(C.a)({},e,{group:n}),t),i=a.getApplicationState("mobile"),o={data:Object(C.a)({},e,{group:n,region:r,mobile:i}),props:{}};ca()&&(o.props.onClick=function(){return a.emit("mobile_wrapper_minimize_intent")}),Fw(a,o,t)}))}(e)}()},80:function(e,t,n){"use strict";t.a=function(e){return new Promise((function(t){t(e())}))}}},[[315,1,2]]]);