(window.webpackJsonpRecentlyViewed=window.webpackJsonpRecentlyViewed||[]).push([[4],{38:function(e,t,r){"use strict";t.a=function(e){var t=e.className,r=void 0===t?"":t,n=e.prefix,o=void 0===n?"rec-popup":n,i=e.base,c=void 0===i?12:i,a=e.sm,s=void 0===a?12:a,p=e.md,d=void 0===p?12:p,l=e.lg,m=void 0===l?12:l;return"".concat(r," ").concat(o,"-ikea-col-").concat(c," ").concat(o,"-ikea-col-sm-").concat(s," ").concat(o,"-ikea-col-md-").concat(d," ").concat(o,"-ikea-col-lg-").concat(m)}},39:function(e,t,r){"use strict";t.a=function(e,t){return"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype?(function(e,r){new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&(r(),t.unobserve(e.target),t.disconnect())})},{root:null,rootMargin:"0px 0px 300px 0px",threshold:0}).observe(e)}(e,t),!0):(t(),!1)}},75:function(e,t,r){},86:function(e,t,r){"use strict";r.r(t);function n(t){var e=JSON.parse(localStorage.getItem("ikeaBrowserHistory"));!function(e){localStorage.setItem("ikeaBrowserHistory",JSON.stringify(e))}({plp:e.plp,pip:e.pip.map(function(e){return t===e.id?Object.assign({},e,{missing:Date.now()}):e})})}var c=r(6),o=r(10),i=r.n(o),a=r(11),s=r.n(a),p=r(22),d=r.n(p),l=r(23),m=r.n(l),u=r(24),h=r.n(u),f=(r(75),r(8)),v=Object({baseUrl:"https://www.ikea.com",locale:"fr-CA",siteFolder:"ca/fr",categoriesAPIUrl:"https://retail.api.ikea.com/recommendations/v1/ca-prod/categories/%category_id%/fr",addToCartAPIUrl:"https://rec.ingka.com/recommendations/v1/ca-prod/items/addtocart",popularAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items/popular/",styleAPIUrl:"https://rec.ingka.com/recommendations/v1/dk-dev/items/style",easyPickersAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items/easypick/",newProductsAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items/new/",btiProductsAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items/bti/",similarAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items",cartPageUrl:"https://secure.ikea.com/ca/en/mcommerce/shoppingcart",enableContextualImages:!1,enableCategoryRecommendations:!1,siteKey:"cafr-production",enableCartRecommendations:!0,enablePopularRecommendations:!1,enableRevampComponents:!1,enableRecentlyViewedSPALink:!0}),g=v.baseUrl,y=v.siteFolder,w=function(t){var e=t.substr(t.length-3),r="".concat(g,"/").concat(y,"/products/").concat(e,"/").concat(t,".json");return fetch(r,{method:"GET",mode:"cors"}).then(function(e){if(e.ok)return e;throw new Error("Network response error.")}).then(function(e){return e.json()}).then(function(e){if(Object.keys(e).length)return e;throw new Error("Empty response object.")}).catch(function(e){throw n(t),new Error(e)})},k=r(38);function b(e,t){var r=JSON.parse(localStorage.getItem("ikeaBrowserHistory")||"{}");if(!r[e])return[];var n=r[e];return n.reverse(),n.filter(function(e){return!(e.missing&&!function(e){return e+6048e5<Date.now()}(e.missing))}).map(function(e){return e.id}).filter(function(e){return e!==t}).slice(0,12)}var I=r(39),P=r(76),O=r.n(P),_=Object({baseUrl:"https://www.ikea.com",locale:"fr-CA",siteFolder:"ca/fr",categoriesAPIUrl:"https://retail.api.ikea.com/recommendations/v1/ca-prod/categories/%category_id%/fr",addToCartAPIUrl:"https://rec.ingka.com/recommendations/v1/ca-prod/items/addtocart",popularAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items/popular/",styleAPIUrl:"https://rec.ingka.com/recommendations/v1/dk-dev/items/style",easyPickersAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items/easypick/",newProductsAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items/new/",btiProductsAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items/bti/",similarAPIUrl:"https://rec.ingka.com/recommendations/v1/fr-prod/items",cartPageUrl:"https://secure.ikea.com/ca/en/mcommerce/shoppingcart",enableContextualImages:!1,enableCategoryRecommendations:!1,siteKey:"cafr-production",enableCartRecommendations:!0,enablePopularRecommendations:!1,enableRevampComponents:!1,enableRecentlyViewedSPALink:!0}),A=_.baseUrl,x=_.siteFolder,U=function(e){function r(e){var t;return i()(this,r),(t=d()(this,m()(r).call(this,e))).state={history:[],hasObserverSupport:!0,hasHistory:!0},t}return h()(r,e),s()(r,[{key:"handleClick",value:function(){f.a.recentlyViewedProductClick({event_category:{start:"start_page_actions",plp:"plp_page_actions",pip:"pip_page_actions"}[this.props.pageType]})}},{key:"getGrid",value:function(e){var t=0<arguments.length&&void 0!==e&&e?2:1;return Object(k.a)({prefix:"recently-viewed",className:"recently-viewed-item",base:3*t,sm:2*t,md:1*t,lg:1*t})}},{key:"renderItem",value:function(e,t){var r=function(e,t){var r="https://www.ikea.com/PIAimages/".concat(e,"_S5.JPG"),n="".concat(r,"?f=xs 500w,").concat(r,"?f=xxs 400w,").concat(r,"?f=xxxs 300w");return Object(c.h)("img",{src:r+"?f=xxs",class:"product-image",alt:t,sizes:"(min-width: 1440px) 105px, (min-width: 768px) 12vw, (min-width: 480px) 23vw, 33vw",srcset:n})}(e.mainImage.id,e.mainImage.alt);return Object(c.h)("li",{"data-recommendations-type":"recently_viewed","data-list-position":t+1,class:this.getGrid()},Object(c.h)("a",{href:e.pipUrl,onClick:this.handleClick.bind(this)},r))}},{key:"getHistory",value:function(){var e=this,t=b("pip",this.props.productId),r=[],n=t.map(function(e,t){return w(e).then(function(e){return r[t]=e})});if(0!==n.length)return Promise.all(n.map(function(e){return e.catch(function(e){return e})})).then(function(){return e.setState({history:r.filter(function(e){return e})})});this.setState({hasHistory:!1})}},{key:"componentDidMount",value:function(){this.setState({hasObserverSupport:Object(I.a)(this.ref,this.getHistory.bind(this))})}},{key:"getSPALink",value:function(){return Object(c.h)("li",{class:"recently-viewed-item__spa "+this.getGrid(!0)},Object(c.h)(O.a,{text:"Afficher tout lâ€™historique",url:A+"/"+x+"/browse-history/"}))}},{key:"render",value:function(){var r=this;if(this.state.hasHistory){var e="recently-viewed ".concat(this.state.hasObserverSupport&&0===this.state.history.length?"recently-viewed__lazy":""," ").concat(0!==this.state.history.length?"recently-viewed__visible":"");return Object(c.h)("section",{class:e,"data-namespace":"recently-viewed",ref:function(e){r.ref=e}},"",Object(c.h)("div",{class:"recently-viewed__container"},Object(c.h)("ul",{class:"recently-viewed__list"},this.state.history.map(function(e,t){if(!(10<=t))return r.renderItem(e,t)}),this.getSPALink())))}}}]),r}(c.Component),j=function(){if("undefined"!=typeof utag_data&&void 0!==utag_data.page_type&&"home page"===utag_data.page_type)return"start";var e=new RegExp("^/".concat("ca/fr","/(cat|p)/")).exec(window.location.pathname);return null===e||void 0===e[1]?"":"cat"===e[1]?"plp":"p"===e[1]?"pip":""};r.d(t,"run",function(){return S});var C=document.querySelector("[data-recently-viewed]"),S=function(){var e="undefined"!=typeof ikea&&void 0!==ikea.cookieConsent,t=e&&ikea.cookieConsent.hasConsent(3);if(!e||t){var r=j(),n=document.querySelector("#section-recently-viewed"),o=document.querySelector(".js-product-pip[data-product-id]"),i=(o?o.dataset:{productId:0}).productId;C&&""!==r&&null===n&&Object(c.render)(Object(c.h)(U,{pageType:r,productId:i}),C)}}}}]);
//# sourceMappingURL=recently-viewed.a6d0d969.js.map